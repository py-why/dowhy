
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-B139P18WHM');
    </script>
    
    <title>dowhy.gcm package &#8212; DoWhy  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dowhy.gcm.independence_test package" href="dowhy.gcm.independence_test.html" />
    <link rel="prev" title="dowhy.do_samplers package" href="dowhy.do_samplers.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">
  
  
  
  
    <img src="_static/dowhy-logo-small.png" class="logo__image only-light" alt="Logo image">
    <img src="_static/dowhy-logo-small.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="getting_started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="example_notebooks/nb_index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="dowhy.html">
  dowhy package
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="code_repo.html">
  Release notes
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="cite.html">
  Citing this package
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        v0.10
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <dd><a href="/dowhy/v0.9.1/index.html">v0.9.1</a></dd>
            <dd><a href="/dowhy/v0.9/index.html">v0.9</a></dd>
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
        </dl>        
        <dl>
            <dt>Branches</dt>
            <dd><a href="">main</a></dd>
        </dl>        
    </div>
</div>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.api.html">
   dowhy.api package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_estimators.html">
   dowhy.causal_estimators package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_identifier.html">
   dowhy.causal_identifier package
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dowhy.causal_prediction.html">
   dowhy.causal_prediction package
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.causal_prediction.algorithms.html">
     dowhy.causal_prediction.algorithms package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.causal_prediction.dataloaders.html">
     dowhy.causal_prediction.dataloaders package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.causal_prediction.datasets.html">
     dowhy.causal_prediction.datasets package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.causal_prediction.models.html">
     dowhy.causal_prediction.models package
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dowhy.causal_refuters.html">
   dowhy.causal_refuters package
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="dowhy.causal_refuters.overrule.html">
     dowhy.causal_refuters.overrule package
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="dowhy.causal_refuters.overrule.BCS.html">
       dowhy.causal_refuters.overrule.BCS package
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.data_transformers.html">
   dowhy.data_transformers package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.do_samplers.html">
   dowhy.do_samplers package
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   dowhy.gcm package
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.independence_test.html">
     dowhy.gcm.independence_test package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.ml.html">
     dowhy.gcm.ml package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.util.html">
     dowhy.gcm.util package
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.graph_learners.html">
   dowhy.graph_learners package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.interpreters.html">
   dowhy.interpreters package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.utils.html">
   dowhy.utils package
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subpackages">
   Subpackages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.anomaly">
   dowhy.gcm.anomaly module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly.anomaly_scores">
     <code class="docutils literal notranslate">
      <span class="pre">
       anomaly_scores()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly.attribute_anomalies">
     <code class="docutils literal notranslate">
      <span class="pre">
       attribute_anomalies()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly.attribute_anomaly_scores">
     <code class="docutils literal notranslate">
      <span class="pre">
       attribute_anomaly_scores()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly.conditional_anomaly_scores">
     <code class="docutils literal notranslate">
      <span class="pre">
       conditional_anomaly_scores()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.anomaly_scorer">
   dowhy.gcm.anomaly_scorer module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer">
     <code class="docutils literal notranslate">
      <span class="pre">
       AnomalyScorer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         AnomalyScorer.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer.score">
       <code class="docutils literal notranslate">
        <span class="pre">
         AnomalyScorer.score()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.anomaly_scorers">
   dowhy.gcm.anomaly_scorers module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer">
     <code class="docutils literal notranslate">
      <span class="pre">
       ITAnomalyScorer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         ITAnomalyScorer.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer.score">
       <code class="docutils literal notranslate">
        <span class="pre">
         ITAnomalyScorer.score()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer">
     <code class="docutils literal notranslate">
      <span class="pre">
       InverseDensityScorer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         InverseDensityScorer.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer.score">
       <code class="docutils literal notranslate">
        <span class="pre">
         InverseDensityScorer.score()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer">
     <code class="docutils literal notranslate">
      <span class="pre">
       MeanDeviationScorer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         MeanDeviationScorer.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer.score">
       <code class="docutils literal notranslate">
        <span class="pre">
         MeanDeviationScorer.score()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer">
     <code class="docutils literal notranslate">
      <span class="pre">
       MedianCDFQuantileScorer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         MedianCDFQuantileScorer.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.score">
       <code class="docutils literal notranslate">
        <span class="pre">
         MedianCDFQuantileScorer.score()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer">
     <code class="docutils literal notranslate">
      <span class="pre">
       MedianDeviationScorer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         MedianDeviationScorer.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer.score">
       <code class="docutils literal notranslate">
        <span class="pre">
         MedianDeviationScorer.score()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer">
     <code class="docutils literal notranslate">
      <span class="pre">
       RescaledMedianCDFQuantileScorer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         RescaledMedianCDFQuantileScorer.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.score">
       <code class="docutils literal notranslate">
        <span class="pre">
         RescaledMedianCDFQuantileScorer.score()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.auto">
   dowhy.gcm.auto module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.auto.AssignmentQuality">
     <code class="docutils literal notranslate">
      <span class="pre">
       AssignmentQuality
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.auto.AssignmentQuality.BEST">
       <code class="docutils literal notranslate">
        <span class="pre">
         AssignmentQuality.BEST
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.auto.AssignmentQuality.BETTER">
       <code class="docutils literal notranslate">
        <span class="pre">
         AssignmentQuality.BETTER
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.auto.AssignmentQuality.GOOD">
       <code class="docutils literal notranslate">
        <span class="pre">
         AssignmentQuality.GOOD
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.auto.assign_causal_mechanisms">
     <code class="docutils literal notranslate">
      <span class="pre">
       assign_causal_mechanisms()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.auto.find_best_model">
     <code class="docutils literal notranslate">
      <span class="pre">
       find_best_model()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.auto.has_linear_relationship">
     <code class="docutils literal notranslate">
      <span class="pre">
       has_linear_relationship()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.auto.select_model">
     <code class="docutils literal notranslate">
      <span class="pre">
       select_model()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.causal_mechanisms">
   dowhy.gcm.causal_mechanisms module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.AdditiveNoiseModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       AdditiveNoiseModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.AdditiveNoiseModel.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         AdditiveNoiseModel.clone()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM">
     <code class="docutils literal notranslate">
      <span class="pre">
       ClassifierFCM
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.classifier_model">
       <code class="docutils literal notranslate">
        <span class="pre">
         ClassifierFCM.classifier_model
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         ClassifierFCM.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.draw_noise_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         ClassifierFCM.draw_noise_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.estimate_probabilities">
       <code class="docutils literal notranslate">
        <span class="pre">
         ClassifierFCM.estimate_probabilities()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.evaluate">
       <code class="docutils literal notranslate">
        <span class="pre">
         ClassifierFCM.evaluate()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         ClassifierFCM.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.get_class_names">
       <code class="docutils literal notranslate">
        <span class="pre">
         ClassifierFCM.get_class_names()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       ConditionalStochasticModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         ConditionalStochasticModel.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.draw_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         ConditionalStochasticModel.draw_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         ConditionalStochasticModel.fit()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       FunctionalCausalModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel.draw_noise_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         FunctionalCausalModel.draw_noise_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel.draw_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         FunctionalCausalModel.draw_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel.evaluate">
       <code class="docutils literal notranslate">
        <span class="pre">
         FunctionalCausalModel.evaluate()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       InvertibleFunctionalCausalModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel.estimate_noise">
       <code class="docutils literal notranslate">
        <span class="pre">
         InvertibleFunctionalCausalModel.estimate_noise()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       PostNonlinearModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.draw_noise_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.draw_noise_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.estimate_noise">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.estimate_noise()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.evaluate">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.evaluate()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.invertible_function">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.invertible_function
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.noise_model">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.noise_model
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.prediction_model">
       <code class="docutils literal notranslate">
        <span class="pre">
         PostNonlinearModel.prediction_model
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       ProbabilityEstimatorModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel.estimate_probabilities">
       <code class="docutils literal notranslate">
        <span class="pre">
         ProbabilityEstimatorModel.estimate_probabilities()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.StochasticModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       StochasticModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.StochasticModel.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         StochasticModel.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.StochasticModel.draw_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         StochasticModel.draw_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_mechanisms.StochasticModel.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         StochasticModel.fit()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.causal_models">
   dowhy.gcm.causal_models module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       InvertibleStructuralCausalModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel.causal_mechanism">
       <code class="docutils literal notranslate">
        <span class="pre">
         InvertibleStructuralCausalModel.causal_mechanism()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel.set_causal_mechanism">
       <code class="docutils literal notranslate">
        <span class="pre">
         InvertibleStructuralCausalModel.set_causal_mechanism()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       ProbabilisticCausalModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel.causal_mechanism">
       <code class="docutils literal notranslate">
        <span class="pre">
         ProbabilisticCausalModel.causal_mechanism()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         ProbabilisticCausalModel.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel.set_causal_mechanism">
       <code class="docutils literal notranslate">
        <span class="pre">
         ProbabilisticCausalModel.set_causal_mechanism()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.StructuralCausalModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       StructuralCausalModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.StructuralCausalModel.causal_mechanism">
       <code class="docutils literal notranslate">
        <span class="pre">
         StructuralCausalModel.causal_mechanism()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.StructuralCausalModel.set_causal_mechanism">
       <code class="docutils literal notranslate">
        <span class="pre">
         StructuralCausalModel.set_causal_mechanism()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.clone_causal_models">
     <code class="docutils literal notranslate">
      <span class="pre">
       clone_causal_models()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.validate_causal_dag">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_causal_dag()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.validate_causal_graph">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_causal_graph()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.validate_causal_model_assignment">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_causal_model_assignment()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.validate_local_structure">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_local_structure()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.validate_node">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_node()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.causal_models.validate_node_has_causal_model">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_node_has_causal_model()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.confidence_intervals">
   dowhy.gcm.confidence_intervals module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.confidence_intervals.confidence_intervals">
     <code class="docutils literal notranslate">
      <span class="pre">
       confidence_intervals()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.confidence_intervals.estimate_geometric_median">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_geometric_median()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.confidence_intervals_cms">
   dowhy.gcm.confidence_intervals_cms module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.confidence_intervals_cms.fit_and_compute">
     <code class="docutils literal notranslate">
      <span class="pre">
       fit_and_compute()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.config">
   dowhy.gcm.config module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.config.disable_progress_bars">
     <code class="docutils literal notranslate">
      <span class="pre">
       disable_progress_bars()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.config.enable_progress_bars">
     <code class="docutils literal notranslate">
      <span class="pre">
       enable_progress_bars()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.config.set_default_n_jobs">
     <code class="docutils literal notranslate">
      <span class="pre">
       set_default_n_jobs()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.constant">
   dowhy.gcm.constant module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.density_estimator">
   dowhy.gcm.density_estimator module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.density_estimator.DensityEstimator">
     <code class="docutils literal notranslate">
      <span class="pre">
       DensityEstimator
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.density_estimator.DensityEstimator.density">
       <code class="docutils literal notranslate">
        <span class="pre">
         DensityEstimator.density()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.density_estimator.DensityEstimator.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         DensityEstimator.fit()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.density_estimators">
   dowhy.gcm.density_estimators module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator">
     <code class="docutils literal notranslate">
      <span class="pre">
       GaussianMixtureDensityEstimator
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.density">
       <code class="docutils literal notranslate">
        <span class="pre">
         GaussianMixtureDensityEstimator.density()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         GaussianMixtureDensityEstimator.fit()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D">
     <code class="docutils literal notranslate">
      <span class="pre">
       KernelDensityEstimator1D
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D.density">
       <code class="docutils literal notranslate">
        <span class="pre">
         KernelDensityEstimator1D.density()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         KernelDensityEstimator1D.fit()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.distribution_change">
   dowhy.gcm.distribution_change module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.distribution_change.distribution_change">
     <code class="docutils literal notranslate">
      <span class="pre">
       distribution_change()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.distribution_change.distribution_change_of_graphs">
     <code class="docutils literal notranslate">
      <span class="pre">
       distribution_change_of_graphs()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.distribution_change.estimate_distribution_change_scores">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_distribution_change_scores()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.distribution_change.mechanism_change_test">
     <code class="docutils literal notranslate">
      <span class="pre">
       mechanism_change_test()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.divergence">
   dowhy.gcm.divergence module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.divergence.auto_estimate_kl_divergence">
     <code class="docutils literal notranslate">
      <span class="pre">
       auto_estimate_kl_divergence()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.divergence.estimate_kl_divergence_categorical">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_kl_divergence_categorical()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.divergence.estimate_kl_divergence_continuous">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_kl_divergence_continuous()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.divergence.estimate_kl_divergence_of_probabilities">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_kl_divergence_of_probabilities()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.divergence.is_probability_matrix">
     <code class="docutils literal notranslate">
      <span class="pre">
       is_probability_matrix()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.falsify">
   dowhy.gcm.falsify module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.EvaluationResult">
     <code class="docutils literal notranslate">
      <span class="pre">
       EvaluationResult
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.EvaluationResult.significance_level">
       <code class="docutils literal notranslate">
        <span class="pre">
         EvaluationResult.significance_level
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.EvaluationResult.suggestions">
       <code class="docutils literal notranslate">
        <span class="pre">
         EvaluationResult.suggestions
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.EvaluationResult.summary">
       <code class="docutils literal notranslate">
        <span class="pre">
         EvaluationResult.summary
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.EvaluationResult.update_significance_level">
       <code class="docutils literal notranslate">
        <span class="pre">
         EvaluationResult.update_significance_level()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst">
     <code class="docutils literal notranslate">
      <span class="pre">
       FalsifyConst
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.F_GIVEN_VIOLATIONS">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.F_GIVEN_VIOLATIONS
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.F_PERM_VIOLATIONS">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.F_PERM_VIOLATIONS
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.GIVEN_VIOLATIONS">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.GIVEN_VIOLATIONS
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.LOCAL_VIOLATION_INSIGHT">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.LOCAL_VIOLATION_INSIGHT
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.MEC">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.MEC
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.METHOD">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.METHOD
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.N_TESTS">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.N_TESTS
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.N_VIOLATIONS">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.N_VIOLATIONS
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.PERM_GRAPHS">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.PERM_GRAPHS
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.PERM_VIOLATIONS">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.PERM_VIOLATIONS
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.P_VALUE">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.P_VALUE
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.P_VALUES">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.P_VALUES
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_CM">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.VALIDATE_CM
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_LMC">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.VALIDATE_LMC
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_PD">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.VALIDATE_PD
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_TPA">
       <code class="docutils literal notranslate">
        <span class="pre">
         FalsifyConst.VALIDATE_TPA
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.apply_suggestions">
     <code class="docutils literal notranslate">
      <span class="pre">
       apply_suggestions()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.falsify_graph">
     <code class="docutils literal notranslate">
      <span class="pre">
       falsify_graph()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.plot_evaluation_results">
     <code class="docutils literal notranslate">
      <span class="pre">
       plot_evaluation_results()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.plot_local_insights">
     <code class="docutils literal notranslate">
      <span class="pre">
       plot_local_insights()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.run_validations">
     <code class="docutils literal notranslate">
      <span class="pre">
       run_validations()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.validate_cm">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_cm()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.validate_lmc">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_lmc()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.validate_pd">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_pd()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.falsify.validate_tpa">
     <code class="docutils literal notranslate">
      <span class="pre">
       validate_tpa()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.feature">
   dowhy.gcm.feature module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.feature.feature_relevance_distribution">
     <code class="docutils literal notranslate">
      <span class="pre">
       feature_relevance_distribution()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.feature.feature_relevance_sample">
     <code class="docutils literal notranslate">
      <span class="pre">
       feature_relevance_sample()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.feature.parent_relevance">
     <code class="docutils literal notranslate">
      <span class="pre">
       parent_relevance()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.feature_relevance">
   dowhy.gcm.feature_relevance module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.feature_relevance.feature_relevance_distribution">
     <code class="docutils literal notranslate">
      <span class="pre">
       feature_relevance_distribution()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.feature_relevance.feature_relevance_sample">
     <code class="docutils literal notranslate">
      <span class="pre">
       feature_relevance_sample()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.feature_relevance.parent_relevance">
     <code class="docutils literal notranslate">
      <span class="pre">
       parent_relevance()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.fitting_sampling">
   dowhy.gcm.fitting_sampling module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.fitting_sampling.draw_samples">
     <code class="docutils literal notranslate">
      <span class="pre">
       draw_samples()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.fitting_sampling.fit">
     <code class="docutils literal notranslate">
      <span class="pre">
       fit()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.fitting_sampling.fit_causal_model_of_target">
     <code class="docutils literal notranslate">
      <span class="pre">
       fit_causal_model_of_target()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.influence">
   dowhy.gcm.influence module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.influence.arrow_strength">
     <code class="docutils literal notranslate">
      <span class="pre">
       arrow_strength()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.influence.arrow_strength_of_model">
     <code class="docutils literal notranslate">
      <span class="pre">
       arrow_strength_of_model()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.influence.intrinsic_causal_influence">
     <code class="docutils literal notranslate">
      <span class="pre">
       intrinsic_causal_influence()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.influence.intrinsic_causal_influence_sample">
     <code class="docutils literal notranslate">
      <span class="pre">
       intrinsic_causal_influence_sample()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.shapley">
   dowhy.gcm.shapley module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyApproximationMethods">
     <code class="docutils literal notranslate">
      <span class="pre">
       ShapleyApproximationMethods
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.AUTO">
       <code class="docutils literal notranslate">
        <span class="pre">
         ShapleyApproximationMethods.AUTO
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EARLY_STOPPING">
       <code class="docutils literal notranslate">
        <span class="pre">
         ShapleyApproximationMethods.EARLY_STOPPING
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT">
       <code class="docutils literal notranslate">
        <span class="pre">
         ShapleyApproximationMethods.EXACT
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT_FAST">
       <code class="docutils literal notranslate">
        <span class="pre">
         ShapleyApproximationMethods.EXACT_FAST
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.PERMUTATION">
       <code class="docutils literal notranslate">
        <span class="pre">
         ShapleyApproximationMethods.PERMUTATION
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.SUBSET_SAMPLING">
       <code class="docutils literal notranslate">
        <span class="pre">
         ShapleyApproximationMethods.SUBSET_SAMPLING
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.shapley.ShapleyConfig">
     <code class="docutils literal notranslate">
      <span class="pre">
       ShapleyConfig
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.shapley.estimate_shapley_values">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_shapley_values()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.stats">
   dowhy.gcm.stats module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.stats.estimate_ftest_pvalue">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_ftest_pvalue()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.stats.marginal_expectation">
     <code class="docutils literal notranslate">
      <span class="pre">
       marginal_expectation()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.stats.permute_features">
     <code class="docutils literal notranslate">
      <span class="pre">
       permute_features()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.stats.quantile_based_fwer">
     <code class="docutils literal notranslate">
      <span class="pre">
       quantile_based_fwer()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.stochastic_models">
   dowhy.gcm.stochastic_models module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution">
     <code class="docutils literal notranslate">
      <span class="pre">
       BayesianGaussianMixtureDistribution
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         BayesianGaussianMixtureDistribution.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.draw_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         BayesianGaussianMixtureDistribution.draw_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         BayesianGaussianMixtureDistribution.fit()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution">
     <code class="docutils literal notranslate">
      <span class="pre">
       EmpiricalDistribution
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         EmpiricalDistribution.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.data">
       <code class="docutils literal notranslate">
        <span class="pre">
         EmpiricalDistribution.data
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.draw_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         EmpiricalDistribution.draw_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         EmpiricalDistribution.fit()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution">
     <code class="docutils literal notranslate">
      <span class="pre">
       ScipyDistribution
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution.clone">
       <code class="docutils literal notranslate">
        <span class="pre">
         ScipyDistribution.clone()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution.draw_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         ScipyDistribution.draw_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution.find_suitable_continuous_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         ScipyDistribution.find_suitable_continuous_distribution()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution.fit">
       <code class="docutils literal notranslate">
        <span class="pre">
         ScipyDistribution.fit()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution.map_scipy_distribution_parameters_to_names">
       <code class="docutils literal notranslate">
        <span class="pre">
         ScipyDistribution.map_scipy_distribution_parameters_to_names()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution.parameters">
       <code class="docutils literal notranslate">
        <span class="pre">
         ScipyDistribution.parameters
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.stochastic_models.ScipyDistribution.scipy_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         ScipyDistribution.scipy_distribution
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.uncertainty">
   dowhy.gcm.uncertainty module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.uncertainty.estimate_entropy_discrete">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_entropy_discrete()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.uncertainty.estimate_entropy_kmeans">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_entropy_kmeans()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.uncertainty.estimate_entropy_of_probabilities">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_entropy_of_probabilities()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.uncertainty.estimate_entropy_using_discretization">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_entropy_using_discretization()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.uncertainty.estimate_gaussian_entropy">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_gaussian_entropy()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.uncertainty.estimate_variance">
     <code class="docutils literal notranslate">
      <span class="pre">
       estimate_variance()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.unit_change">
   dowhy.gcm.unit_change module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.LinearPredictionModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       LinearPredictionModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.LinearPredictionModel.coefficients">
       <code class="docutils literal notranslate">
        <span class="pre">
         LinearPredictionModel.coefficients
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.SklearnLinearRegressionModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       SklearnLinearRegressionModel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.SklearnLinearRegressionModel.coefficients">
       <code class="docutils literal notranslate">
        <span class="pre">
         SklearnLinearRegressionModel.coefficients
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.unit_change">
     <code class="docutils literal notranslate">
      <span class="pre">
       unit_change()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.unit_change_linear">
     <code class="docutils literal notranslate">
      <span class="pre">
       unit_change_linear()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.unit_change_linear_input_only">
     <code class="docutils literal notranslate">
      <span class="pre">
       unit_change_linear_input_only()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.unit_change_nonlinear">
     <code class="docutils literal notranslate">
      <span class="pre">
       unit_change_nonlinear()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.unit_change.unit_change_nonlinear_input_only">
     <code class="docutils literal notranslate">
      <span class="pre">
       unit_change_nonlinear_input_only()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.validation">
   dowhy.gcm.validation module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.validation.RejectionResult">
     <code class="docutils literal notranslate">
      <span class="pre">
       RejectionResult
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.validation.RejectionResult.NOT_REJECTED">
       <code class="docutils literal notranslate">
        <span class="pre">
         RejectionResult.NOT_REJECTED
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dowhy.gcm.validation.RejectionResult.REJECTED">
       <code class="docutils literal notranslate">
        <span class="pre">
         RejectionResult.REJECTED
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.validation.refute_causal_structure">
     <code class="docutils literal notranslate">
      <span class="pre">
       refute_causal_structure()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.validation.refute_invertible_model">
     <code class="docutils literal notranslate">
      <span class="pre">
       refute_invertible_model()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.whatif">
   dowhy.gcm.whatif module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.whatif.average_causal_effect">
     <code class="docutils literal notranslate">
      <span class="pre">
       average_causal_effect()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.whatif.counterfactual_samples">
     <code class="docutils literal notranslate">
      <span class="pre">
       counterfactual_samples()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dowhy.gcm.whatif.interventional_samples">
     <code class="docutils literal notranslate">
      <span class="pre">
       interventional_samples()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm">
   Module contents
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="dowhy-gcm-package">
<h1>dowhy.gcm package<a class="headerlink" href="#dowhy-gcm-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.independence_test.html">dowhy.gcm.independence_test package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.generalised_cov_measure">dowhy.gcm.independence_test.generalised_cov_measure module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.generalised_cov_measure.generalised_cov_based"><code class="docutils literal notranslate"><span class="pre">generalised_cov_based()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.kernel">dowhy.gcm.independence_test.kernel module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.kernel.approx_kernel_based"><code class="docutils literal notranslate"><span class="pre">approx_kernel_based()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.kernel.kernel_based"><code class="docutils literal notranslate"><span class="pre">kernel_based()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.kernel_operation">dowhy.gcm.independence_test.kernel_operation module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.kernel_operation.apply_delta_kernel"><code class="docutils literal notranslate"><span class="pre">apply_delta_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel"><code class="docutils literal notranslate"><span class="pre">apply_rbf_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel_with_adaptive_precision"><code class="docutils literal notranslate"><span class="pre">apply_rbf_kernel_with_adaptive_precision()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.kernel_operation.approximate_delta_kernel_features"><code class="docutils literal notranslate"><span class="pre">approximate_delta_kernel_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.kernel_operation.approximate_rbf_kernel_features"><code class="docutils literal notranslate"><span class="pre">approximate_rbf_kernel_features()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.regression">dowhy.gcm.independence_test.regression module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.regression.regression_based"><code class="docutils literal notranslate"><span class="pre">regression_based()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.independence_test.html#dowhy.gcm.independence_test.independence_test"><code class="docutils literal notranslate"><span class="pre">independence_test()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.ml.html">dowhy.gcm.ml package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy-gcm-ml-autogluon-module">dowhy.gcm.ml.autogluon module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml.classification">dowhy.gcm.ml.classification module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.ClassificationModel"><code class="docutils literal notranslate"><span class="pre">ClassificationModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.ClassificationModel.classes"><code class="docutils literal notranslate"><span class="pre">ClassificationModel.classes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.ClassificationModel.predict_probabilities"><code class="docutils literal notranslate"><span class="pre">ClassificationModel.predict_probabilities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.SklearnClassificationModel"><code class="docutils literal notranslate"><span class="pre">SklearnClassificationModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.SklearnClassificationModel.classes"><code class="docutils literal notranslate"><span class="pre">SklearnClassificationModel.classes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.SklearnClassificationModel.clone"><code class="docutils literal notranslate"><span class="pre">SklearnClassificationModel.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.SklearnClassificationModel.predict_probabilities"><code class="docutils literal notranslate"><span class="pre">SklearnClassificationModel.predict_probabilities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_ada_boost_classifier"><code class="docutils literal notranslate"><span class="pre">create_ada_boost_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_extra_trees_classifier"><code class="docutils literal notranslate"><span class="pre">create_extra_trees_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_gaussian_nb_classifier"><code class="docutils literal notranslate"><span class="pre">create_gaussian_nb_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_gaussian_process_classifier"><code class="docutils literal notranslate"><span class="pre">create_gaussian_process_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_hist_gradient_boost_classifier"><code class="docutils literal notranslate"><span class="pre">create_hist_gradient_boost_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_knn_classifier"><code class="docutils literal notranslate"><span class="pre">create_knn_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_logistic_regression_classifier"><code class="docutils literal notranslate"><span class="pre">create_logistic_regression_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_polynom_logistic_regression_classifier"><code class="docutils literal notranslate"><span class="pre">create_polynom_logistic_regression_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_random_forest_classifier"><code class="docutils literal notranslate"><span class="pre">create_random_forest_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.create_support_vector_classifier"><code class="docutils literal notranslate"><span class="pre">create_support_vector_classifier()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml.prediction_model">dowhy.gcm.ml.prediction_model module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel"><code class="docutils literal notranslate"><span class="pre">PredictionModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel.clone"><code class="docutils literal notranslate"><span class="pre">PredictionModel.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel.fit"><code class="docutils literal notranslate"><span class="pre">PredictionModel.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel.predict"><code class="docutils literal notranslate"><span class="pre">PredictionModel.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml.regression">dowhy.gcm.ml.regression module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleExponentialFunction"><code class="docutils literal notranslate"><span class="pre">InvertibleExponentialFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleExponentialFunction.evaluate"><code class="docutils literal notranslate"><span class="pre">InvertibleExponentialFunction.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleExponentialFunction.evaluate_inverse"><code class="docutils literal notranslate"><span class="pre">InvertibleExponentialFunction.evaluate_inverse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleFunction"><code class="docutils literal notranslate"><span class="pre">InvertibleFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleFunction.evaluate"><code class="docutils literal notranslate"><span class="pre">InvertibleFunction.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleFunction.evaluate_inverse"><code class="docutils literal notranslate"><span class="pre">InvertibleFunction.evaluate_inverse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleIdentityFunction"><code class="docutils literal notranslate"><span class="pre">InvertibleIdentityFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleIdentityFunction.evaluate"><code class="docutils literal notranslate"><span class="pre">InvertibleIdentityFunction.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleIdentityFunction.evaluate_inverse"><code class="docutils literal notranslate"><span class="pre">InvertibleIdentityFunction.evaluate_inverse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleLogarithmicFunction"><code class="docutils literal notranslate"><span class="pre">InvertibleLogarithmicFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleLogarithmicFunction.evaluate"><code class="docutils literal notranslate"><span class="pre">InvertibleLogarithmicFunction.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleLogarithmicFunction.evaluate_inverse"><code class="docutils literal notranslate"><span class="pre">InvertibleLogarithmicFunction.evaluate_inverse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.SklearnRegressionModel"><code class="docutils literal notranslate"><span class="pre">SklearnRegressionModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.SklearnRegressionModel.clone"><code class="docutils literal notranslate"><span class="pre">SklearnRegressionModel.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.SklearnRegressionModel.fit"><code class="docutils literal notranslate"><span class="pre">SklearnRegressionModel.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.SklearnRegressionModel.predict"><code class="docutils literal notranslate"><span class="pre">SklearnRegressionModel.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.SklearnRegressionModel.sklearn_model"><code class="docutils literal notranslate"><span class="pre">SklearnRegressionModel.sklearn_model</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_ada_boost_regressor"><code class="docutils literal notranslate"><span class="pre">create_ada_boost_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_elastic_net_regressor"><code class="docutils literal notranslate"><span class="pre">create_elastic_net_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_extra_trees_regressor"><code class="docutils literal notranslate"><span class="pre">create_extra_trees_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_gaussian_process_regressor"><code class="docutils literal notranslate"><span class="pre">create_gaussian_process_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_hist_gradient_boost_regressor"><code class="docutils literal notranslate"><span class="pre">create_hist_gradient_boost_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_knn_regressor"><code class="docutils literal notranslate"><span class="pre">create_knn_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_lasso_lars_ic_regressor"><code class="docutils literal notranslate"><span class="pre">create_lasso_lars_ic_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_lasso_regressor"><code class="docutils literal notranslate"><span class="pre">create_lasso_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_linear_regressor"><code class="docutils literal notranslate"><span class="pre">create_linear_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_linear_regressor_with_given_parameters"><code class="docutils literal notranslate"><span class="pre">create_linear_regressor_with_given_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_polynom_regressor"><code class="docutils literal notranslate"><span class="pre">create_polynom_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_random_forest_regressor"><code class="docutils literal notranslate"><span class="pre">create_random_forest_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_ridge_regressor"><code class="docutils literal notranslate"><span class="pre">create_ridge_regressor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.create_support_vector_regressor"><code class="docutils literal notranslate"><span class="pre">create_support_vector_regressor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.util.html">dowhy.gcm.util package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util.catboost_encoder">dowhy.gcm.util.catboost_encoder module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.catboost_encoder.CatBoostEncoder"><code class="docutils literal notranslate"><span class="pre">CatBoostEncoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.catboost_encoder.CatBoostEncoder.fit"><code class="docutils literal notranslate"><span class="pre">CatBoostEncoder.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.catboost_encoder.CatBoostEncoder.fit_transform"><code class="docutils literal notranslate"><span class="pre">CatBoostEncoder.fit_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.catboost_encoder.CatBoostEncoder.transform"><code class="docutils literal notranslate"><span class="pre">CatBoostEncoder.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util.general">dowhy.gcm.util.general module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.apply_catboost_encoding"><code class="docutils literal notranslate"><span class="pre">apply_catboost_encoding()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.apply_one_hot_encoding"><code class="docutils literal notranslate"><span class="pre">apply_one_hot_encoding()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.auto_apply_encoders"><code class="docutils literal notranslate"><span class="pre">auto_apply_encoders()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.auto_fit_encoders"><code class="docutils literal notranslate"><span class="pre">auto_fit_encoders()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.fit_catboost_encoders"><code class="docutils literal notranslate"><span class="pre">fit_catboost_encoders()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.fit_one_hot_encoders"><code class="docutils literal notranslate"><span class="pre">fit_one_hot_encoders()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.geometric_median"><code class="docutils literal notranslate"><span class="pre">geometric_median()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.has_categorical"><code class="docutils literal notranslate"><span class="pre">has_categorical()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.is_categorical"><code class="docutils literal notranslate"><span class="pre">is_categorical()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.means_difference"><code class="docutils literal notranslate"><span class="pre">means_difference()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.set_random_seed"><code class="docutils literal notranslate"><span class="pre">set_random_seed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.setdiff2d"><code class="docutils literal notranslate"><span class="pre">setdiff2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.shape_into_2d"><code class="docutils literal notranslate"><span class="pre">shape_into_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.variance_of_deviations"><code class="docutils literal notranslate"><span class="pre">variance_of_deviations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.general.variance_of_matching_values"><code class="docutils literal notranslate"><span class="pre">variance_of_matching_values()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util.plotting">dowhy.gcm.util.plotting module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.plotting.bar_plot"><code class="docutils literal notranslate"><span class="pre">bar_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.plotting.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.gcm.util.html#dowhy.gcm.util.plotting.plot_adjacency_matrix"><code class="docutils literal notranslate"><span class="pre">plot_adjacency_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-dowhy.gcm.anomaly">
<span id="dowhy-gcm-anomaly-module"></span><h2>dowhy.gcm.anomaly module<a class="headerlink" href="#module-dowhy.gcm.anomaly" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.anomaly_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">anomaly_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.causal_models.ProbabilisticCausalModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_data:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_conditional:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_unconditional:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scorer_factory:</span> <span class="pre">~typing.Callable[[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~dowhy.gcm.anomaly_scorer.AnomalyScorer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#anomaly_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.anomaly_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.attribute_anomalies">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">attribute_anomalies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel" title="dowhy.gcm.causal_models.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><span class="pre">AnomalyScorer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute_mean_deviation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_distribution_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#attribute_anomalies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.attribute_anomalies" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the contributions of upstream nodes to the anomaly score of the target_node for each sample in
anomaly_samples. By default, the anomaly score is based on the information theoretic (IT) score
-log(P(g(X) &gt;= g(x))), where g is the anomaly_scorer, X samples from the marginal
distribution of the target_node and x an observation of the target_node in anomaly_samples. If
attribute_mean_deviation is set to True, the contribution to g(x) - E[g(X)] is estimated instead, i.e. the feature
relevance for the given scoring function. The underlying algorithm utilizes the reconstructed noise of upstream
nodes (including the target_node itself) for the given anomaly_samples. By this, it is possible to estimate how
much of the anomaly score can be explained by upstream anomalies with respect to anomalous noise values.</p>
<p>Note: This function requires that the noise can be recovered from samples, i.e. the causal models of non-root nodes
need to be an InvertibleNoiseModel (e.g. AdditiveNoiseModel).</p>
<p>Related paper:
Janzing, D., Budhathoki, K., Minorics, L., &amp; Bloebaum, P. (2019).
Causal structure based root cause analysis of outliers
<a class="reference external" href="https://arxiv.org/abs/1912.02724">https://arxiv.org/abs/1912.02724</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The fitted InvertibleStructuralCausalModel.</p></li>
<li><p><strong>target_node</strong>  Target node for which the contributions are estimated.</p></li>
<li><p><strong>anomaly_samples</strong>  Anomalous observations for which the contributions are estimated.</p></li>
<li><p><strong>anomaly_scorer</strong>  Anomaly scorer g. If None is given, a MedianCDFQuantileScorer is used.</p></li>
<li><p><strong>attribute_mean_deviation</strong>  If set to False, the contribution is estimated based on the IT score and if it is
set to True, the contribution is based on the feature relevance with respect to the given scoring function.</p></li>
<li><p><strong>num_distribution_samples</strong>  Number of samples from X, the marginal distribution of the target. These are used
for evaluating the tail probability in case of the IT score
(attribute_mean_deviation is False) or as samples for randomization in case of
feature relevance (attribute_mean_deviation is True).</p></li>
<li><p><strong>shapley_config</strong>  <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that assigns a numpy array to each upstream node including the target_node itself. The
i-th entry of an array indicates the contribution of the corresponding node to the anomaly score of the target
for the i-th observation in anomaly_samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.attribute_anomaly_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">attribute_anomaly_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anomaly_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute_mean_deviation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#attribute_anomaly_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.attribute_anomaly_scores" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the contributions of the features for each sample in anomaly_samples to the anomaly score obtained
by the anomaly_scoring_func. If attribute_mean_deviation is set to False, the anomaly score is based on the
information theoretic (IT) score -log(P(g(X) &gt;= g(x))), where g is the anomaly_scoring_func, X samples from the
marginal distribution of the target_node and x an observation of the target_node in anomaly_samples. If
attribute_mean_deviation is set to True, the contribution to g(x) - E[g(X)] is estimated instead, i.e. the
feature relevance for the given scorer.</p>
<p>Note that the anomaly scoring function needs to handle the dimension and modality of the data. An example for a
function for multidimensional continues data would be:</p>
<blockquote>
<div><p>density_estimator = GaussianMixtureDensityEstimator()
density_estimator.fit(original_observations)
anomaly_scoring_func = lambda x, y: estimate_inverse_density_score(x, y, density_estimator)</p>
</div></blockquote>
<p>Related paper:
Janzing, D., Budhathoki, K., Minorics, L., &amp; Bloebaum, P. (2022).
Causal structure based root cause analysis of outliers
<a class="reference external" href="https://arxiv.org/abs/1912.02724">https://arxiv.org/abs/1912.02724</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anomaly_samples</strong>  Samples x for which the contributions are estimated. The dimensionality of these samples
doesnt matter as long as the anomaly_scoring_func supports it.</p></li>
<li><p><strong>distribution_samples</strong>  Samples from the (non-anomalous) distribution X.</p></li>
<li><p><strong>anomaly_scoring_func</strong>  A function g that takes a sample from X as input and returns an anomaly score.</p></li>
<li><p><strong>attribute_mean_deviation</strong>  If set to False, the contribution is estimated based on the IT score and if it is
set to True, the contribution is based on the feature relevance with respect to the
given scoring function.</p></li>
<li><p><strong>shapley_config</strong>  <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array with the feature contributions to the anomaly score for each sample in anomaly_samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.conditional_anomaly_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">conditional_anomaly_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_samples:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal_mechanism:</span> <span class="pre">~dowhy.gcm.causal_mechanisms.ConditionalStochasticModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scorer_factory:</span> <span class="pre">~typing.Callable[[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~dowhy.gcm.anomaly_scorer.AnomalyScorer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_conditional:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#conditional_anomaly_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.conditional_anomaly_scores" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the conditional anomaly scores based on the expected outcomes of the causal model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong>  Samples from all parents of the target node.</p></li>
<li><p><strong>target_samples</strong>  Samples from the target node.</p></li>
<li><p><strong>causal_mechanism</strong>  Causal mechanism of the target node.</p></li>
<li><p><strong>anomaly_scorer_factory</strong>  A callable that returns an anomaly scorer.</p></li>
<li><p><strong>num_samples_conditional</strong>  Number of samples drawn from the conditional distribution based on the given
parent samples. The more samples, the more accurate the results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The conditional anomaly score for each sample in target_samples.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.anomaly_scorer">
<span id="dowhy-gcm-anomaly-scorer-module"></span><h2>dowhy.gcm.anomaly_scorer module<a class="headerlink" href="#module-dowhy.gcm.anomaly_scorer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorer.AnomalyScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorer.</span></span><span class="sig-name descname"><span class="pre">AnomalyScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorer.html#AnomalyScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorer.AnomalyScorer.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorer.html#AnomalyScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorer.AnomalyScorer.score">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorer.html#AnomalyScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.anomaly_scorers">
<span id="dowhy-gcm-anomaly-scorers-module"></span><h2>dowhy.gcm.anomaly_scorers module<a class="headerlink" href="#module-dowhy.gcm.anomaly_scorers" title="Permalink to this heading"></a></h2>
<p>This module contains implementations of different anomaly scorers.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.ITAnomalyScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">ITAnomalyScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anomaly_scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><span class="pre">AnomalyScorer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#ITAnomalyScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<p>Transforms any anomaly scorer into an information theoretic (IT) score. This means, given a scorer S(x), an
anomalous observation x and samples from the distribution of X, this scorer class represents:</p>
<blockquote>
<div><p>score(x) = -log(P(S(X) &gt;= S(x)))</p>
</div></blockquote>
<p>This is, the negative logarithm of the probability to get the same or a higher score with (random) samples from X
compared to the score obtained based on the anomalous observation x. By this, the score of arbitrarily different
anomaly scorers become comparable information theoretic quantities. The new score -log(P(S(X) &gt;= S(x))) can also
be seen as The higher the score, the rarer the anomaly event. For instance, if we have S(x) = c, but observe
the same or higher scores in 50% or even 100% of all samples in X, then this is not really a rare event, and thus,
not an anomaly. As mentioned above, transforming it into an IT score makes arbitrarily different anomaly scorer
with potentially completely different scaling comparable. For example, one could compare the IT score of
isolation forests with z-scores.</p>
<dl class="simple">
<dt>For more details about IT scores, see:</dt><dd><p>Causal structure based root cause analysis of outliers
Kailash Budhathoki, Patrick Bloebaum, Lenon Minorics, Dominik Janzing (2022)</p>
</dd>
</dl>
<p>The higher the score, the higher the likelihood that the observations is an anomaly.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.ITAnomalyScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#ITAnomalyScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.ITAnomalyScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#ITAnomalyScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.InverseDensityScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">InverseDensityScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density_estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.density_estimator.DensityEstimator" title="dowhy.gcm.density_estimator.DensityEstimator"><span class="pre">DensityEstimator</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#InverseDensityScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<p>Estimates an anomaly score based on 1 / p(x), where x is the data to score. The density value p(x) is estimated
using the given density estimator. If None is given, a Gaussian mixture model is used by default.</p>
<p>Note: The given density estimator needs to support the data types, i.e. if the data has categorical values, the
density estimator needs to be able to handle that. The default Gaussian model can only handle numeric data.</p>
<p>Note: If the density p(x) is 0, a nan or inf could be returned.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.InverseDensityScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#InverseDensityScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.InverseDensityScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#InverseDensityScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MeanDeviationScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">MeanDeviationScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MeanDeviationScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = <a href="#id5"><span class="problematic" id="id6">|x - E[X]|</span></a> / std[X]</p>
</dd>
</dl>
<p>This scores the given sample based on its distance to the mean of X and scaled by the standard deviation of X. This
is also equivalent to the Z-score in Gaussian variables.</p>
<p>The higher the score, the higher the deviation of the observation from the mean of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MeanDeviationScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MeanDeviationScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MeanDeviationScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MeanDeviationScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">MedianCDFQuantileScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianCDFQuantileScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = 1 - 2 * min[P(X &gt;= x), P(X &lt;= x)]</p>
</dd>
</dl>
<p>It scores the observation based on the quantile of x with respect to the distribution of X. Here, if the
sample x lies in the tail of the distribution, we want to have a large score. Since we apriori dont know
whether the sample falls on the left or right side of the median of X, we estimate the quantile on both
sides and take the minimum. Here, these probabilities are estimated by counting and since half of the samples are
on one side from the median, we need to multiply this by a factor of two to obtain the two-sided quantile.
For example:</p>
<blockquote>
<div><p>X = [-3, -2, -1, 0, 1, 2, 3]
x = 2.5</p>
</div></blockquote>
<dl class="simple">
<dt>Then, x falls in the right sided-quantile and only one sample in X is larger than x. Therefore, we get</dt><dd><p>p(X &gt;= x) = 1 / 7
P(X &lt;= x) = 6 / 7</p>
</dd>
<dt>With the end score of:</dt><dd><p>1 - 2 * min[P(X &gt;= x), P(X &lt;= x)] = 1 - 2 / 7 = 0.71</p>
</dd>
</dl>
<p>Note: For equal samples, we contribute half of the count to the left and half of the count the right side.</p>
<p>The higher the score, the less likely the sample comes from the distribution of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianCDFQuantileScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianCDFQuantileScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianDeviationScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">MedianDeviationScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianDeviationScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = <a href="#id7"><span class="problematic" id="id8">|x - med[X]|</span></a> / mad[X]</p>
</dd>
</dl>
<p>This scores the given sample based on its distance to the median of X and scaled by the median absolute deviation
of X.</p>
<p>The higher the score, the higher the deviation of the observation from the median of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianDeviationScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianDeviationScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianDeviationScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianDeviationScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">RescaledMedianCDFQuantileScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#RescaledMedianCDFQuantileScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = -log(2 * min[P(X &gt;= x), P(X &lt;= x)])</p>
</dd>
</dl>
<p>This is a rescaled version of the score s obtained by the <a class="reference internal" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer" title="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MedianCDFQuantileScorer</span></code></a>
by calculating the negative log-probability -log(1 - s). This has the advantage that small differences in the
probabilities are amplified, especially when they are close to 0. For instance, the difference between
probabilities 0.02 and 0.01 seems to be small and insignificant, but the rescaled difference would be significantly
larger: -log(0.02) - log(0.01) = 8.5</p>
<p>The higher the score, the less likely the sample comes from the distribution of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#RescaledMedianCDFQuantileScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#RescaledMedianCDFQuantileScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.auto">
<span id="dowhy-gcm-auto-module"></span><h2>dowhy.gcm.auto module<a class="headerlink" href="#module-dowhy.gcm.auto" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.auto.AssignmentQuality">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">AssignmentQuality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#AssignmentQuality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.AssignmentQuality" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.auto.AssignmentQuality.BEST">
<span class="sig-name descname"><span class="pre">BEST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#dowhy.gcm.auto.AssignmentQuality.BEST" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.auto.AssignmentQuality.BETTER">
<span class="sig-name descname"><span class="pre">BETTER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#dowhy.gcm.auto.AssignmentQuality.BETTER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.auto.AssignmentQuality.GOOD">
<span class="sig-name descname"><span class="pre">GOOD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#dowhy.gcm.auto.AssignmentQuality.GOOD" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.assign_causal_mechanisms">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">assign_causal_mechanisms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">based_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AssignmentQuality.GOOD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#assign_causal_mechanisms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.assign_causal_mechanisms" title="Permalink to this definition"></a></dt>
<dd><p>Automatically assigns appropriate causal models. If causal models are already assigned to nodes and
override_models is set to False, this function only validates the assignments with respect to the graph structure.
Here, the validation checks whether root nodes have StochasticModels and non-root ConditionalStochasticModels
assigned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The causal model to whose nodes to assign causal models.</p></li>
<li><p><strong>based_on</strong>  Jointly sampled data corresponding to the nodes of the given graph.</p></li>
<li><p><strong>quality</strong>  AssignmentQuality for the automatic model selection and model accuracy. This changes the type of</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>prediction model and time spent on the selection. Options are:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>AssignmentQuality.GOOD: Compares a linear, polynomial and gradient boost model on small test-training split</dt><dd><p>of the data. The best performing model is then selected.
Model selection speed: Fast
Model training speed: Fast
Model inference speed: Fast
Model accuracy: Medium</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>AssignmentQuality.BETTER: Compares multiple model types and uses the one with the best performance</dt><dd><p>averaged over multiple splits of the training data. By default, the model with the smallest root mean
squared error is selected for regression problems and the model with the highest F1 score is selected for
classification problems. For a list of possible models, see _LIST_OF_POTENTIAL_REGRESSORS_BETTER and
_LIST_OF_POTENTIAL_CLASSIFIERS_BETTER, respectively.
Model selection speed: Medium
Model training speed: Fast
Model inference speed: Fast
Model accuracy: Good</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>AssignmentQuality.BEST: Uses an AutoGluon (auto ML) model with default settings defined by the AutoGluon</dt><dd><p>wrapper. While the model selection itself is fast, the training and inference speed can be significantly
slower than in the other options. NOTE: This requires the optional autogluon.tabular dependency.
Model selection speed: Instant
Model training speed: Slow
Model inference speed: Slow-Medium
Model accuracy: Best</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">param override_models<span class="colon">:</span></dt>
<dd class="field-odd"><p>If set to True, existing model assignments are replaced with automatically selected</p>
</dd>
</dl>
<p>ones. If set to False, the assigned models are only validated with respect to the graph structure.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.find_best_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">find_best_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model_factories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_samples_per_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_selection_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#find_best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.find_best_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.has_linear_relationship">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">has_linear_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#has_linear_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.has_linear_relationship" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.select_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">select_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_selection_quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.ClassificationModel" title="dowhy.gcm.ml.classification.ClassificationModel"><span class="pre">ClassificationModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#select_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.select_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.causal_mechanisms">
<span id="dowhy-gcm-causal-mechanisms-module"></span><h2>dowhy.gcm.causal_mechanisms module<a class="headerlink" href="#module-dowhy.gcm.causal_mechanisms" title="Permalink to this heading"></a></h2>
<p>This module implements different causal mechanisms.</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.AdditiveNoiseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">AdditiveNoiseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#AdditiveNoiseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.AdditiveNoiseModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel" title="dowhy.gcm.causal_mechanisms.PostNonlinearModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code></a></p>
<dl class="simple">
<dt>Represents the continuous functional causal model of the form</dt><dd><p>Y = f(X) + N,</p>
</dd>
</dl>
<p>where X is the input (typically, direct causal parents of Y) and the noise N is assumed to be independent of X. This
is a special instance of a <code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code> where the function g is the
identity function.</p>
<p>Given joint samples from (X, Y), this model can be fitted by first training a model f (e.g. using least squares
regression) and then reconstruct N by N = Y - f(X), i.e. using the residual.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_model</strong>  The prediction model f.</p></li>
<li><p><strong>invertible_function</strong>  The invertible function g.</p></li>
<li><p><strong>noise_model</strong>  The StochasticModel to describe the distribution of the noise N.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.AdditiveNoiseModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#AdditiveNoiseModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.AdditiveNoiseModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">ClassifierFCM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.ClassificationModel" title="dowhy.gcm.ml.classification.ClassificationModel"><span class="pre">ClassificationModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ClassifierFCM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel" title="dowhy.gcm.causal_mechanisms.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>, <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel" title="dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilityEstimatorModel</span></code></a></p>
<dl class="simple">
<dt>Represents the categorical functional causal model of the form</dt><dd><p>Y = f(X, N),</p>
</dd>
</dl>
<p>where X is the input (typically, direct causal parents of Y) and the noise N here is uniform on [0, 1]. The model
is mostly based on a standard classification model that outputs probabilities. In order to generate a new random
sample given an input x, the return value y is uniformly sampled based on the class probabilities p(y | x). Here,
the noise is used to make this sampling process deterministic by using the cumulative distribution functions defined
by the given inputs.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM.classifier_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classifier_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.ClassificationModel" title="dowhy.gcm.ml.classification.ClassificationModel"><span class="pre">ClassificationModel</span></a></em><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.classifier_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ClassifierFCM.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM.draw_noise_samples">
<span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ClassifierFCM.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd><p>Returns uniformly sampled values on [0, 1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong>  Number of noise samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Noise samples on [0, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM.estimate_probabilities">
<span class="sig-name descname"><span class="pre">estimate_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ClassifierFCM.estimate_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.estimate_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Returns the class probabilities for the given parent_samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parent_samples</strong>  Samples from inputs X.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A nxd numpy matrix with class probabilities for each sample, where n is the number of samples and d
the number of classes. Here, array entry A[i][j] corresponds to the i-th sample indicating the
probability of the j-th class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ClassifierFCM.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the model Y = f(X, N), where X are the parent_samples and N the noise_samples. Here, the
cumulative distribution functions are defined by the parent_samples. For instance, lets say we have 2
classes, n = 0.7 and an input x with p(y = 0| x) = 0.6 and p(y = 1| x) = 0.4, then we get y = 1 as a return
value. This is because p(y = 0| x) &lt; n &lt;= 1.0, i.e. n falls into the bucket that is spanned by p(y = 1| x).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong>  Samples from the inputs X.</p></li>
<li><p><strong>noise_samples</strong>  Samples from the noise on [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Class labels Y based on the inputs and noise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ClassifierFCM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the underlying classification model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong>  Input samples.</p></li>
<li><p><strong>Y</strong>  Target labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ClassifierFCM.get_class_names">
<span class="sig-name descname"><span class="pre">get_class_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ClassifierFCM.get_class_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ClassifierFCM.get_class_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">ConditionalStochasticModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ConditionalStochasticModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A conditional stochastic model represents a model used for causal mechanisms for non-root nodes in a graphical
causal model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ConditionalStochasticModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.draw_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ConditionalStochasticModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ConditionalStochasticModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.FunctionalCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">FunctionalCausalModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#FunctionalCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel" title="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a></p>
<p>Represents a Functional Causal Model (FCM), a specific type of conditional stochastic model, that is defined
as:</p>
<blockquote>
<div><p>Y := f(X, N), N: Noise</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.FunctionalCausalModel.draw_noise_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#FunctionalCausalModel.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.FunctionalCausalModel.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#FunctionalCausalModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.FunctionalCausalModel.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#FunctionalCausalModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">InvertibleFunctionalCausalModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#InvertibleFunctionalCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel" title="dowhy.gcm.causal_mechanisms.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel.estimate_noise">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#InvertibleFunctionalCausalModel.estimate_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel.estimate_noise" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">PostNonlinearModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">invertible_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleFunction" title="dowhy.gcm.ml.regression.InvertibleFunction"><span class="pre">InvertibleFunction</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#PostNonlinearModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel" title="dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvertibleFunctionalCausalModel</span></code></a></p>
<dl class="simple">
<dt>Represents an post nonlinear FCM, i.e. models of the form:</dt><dd><p>Y = g(f(X) + N),</p>
</dd>
</dl>
<p>where X are parent nodes of the target node Y, f an arbitrary prediction model expecting inputs from the
parents X, N a noise variable and g an invertible function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_model</strong>  The prediction model f.</p></li>
<li><p><strong>invertible_function</strong>  The invertible function g.</p></li>
<li><p><strong>noise_model</strong>  The StochasticModel to describe the distribution of the noise N.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#PostNonlinearModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.draw_noise_samples">
<span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#PostNonlinearModel.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples from the noise distribution N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong>  Number of noise samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array containing num_samples samples from the noise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.estimate_noise">
<span class="sig-name descname"><span class="pre">estimate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#PostNonlinearModel.estimate_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.estimate_noise" title="Permalink to this definition"></a></dt>
<dd><p>Reconstruct the noise given samples from (X, Y). This is done by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Transform Y via the inverse of g: g^-1(Y) = f(X) + N</p></li>
<li><p>Return the residual g^-1(Y) - f(X)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_samples</strong>  Samples from the input X.</p></li>
<li><p><strong>parent_samples</strong>  Samples from the target Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reconstructed noise based on the given samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#PostNonlinearModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the post non-linear model given samples (X, N). This is done by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Evaluate f(X)</p></li>
<li><p>Evaluate f(X) + N</p></li>
<li><p>Return g(f(X) + N)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong>  Samples from the inputs X.</p></li>
<li><p><strong>noise_samples</strong>  Samples from the noise N.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Y values based on the given samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#PostNonlinearModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the post non-linear model of the form Y = g(f(X) + N). Here, this consists of three steps given
samples from (X, Y):</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Transform Y via the inverse of g: g^-1(Y) = f(X) + N</p></li>
<li><p>Fit the model for f on (X, g^-1(Y))</p></li>
<li><p>Reconstruct N based on the residual N = g^-1(Y) - f(X)</p></li>
</ol>
</div></blockquote>
<p>Note that the noise here can be inferred uniquely if the model assumption holds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong>  Samples from the input X.</p></li>
<li><p><strong>Y</strong>  Samples from the target Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.invertible_function">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">invertible_function</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.InvertibleFunction" title="dowhy.gcm.ml.regression.InvertibleFunction"><span class="pre">InvertibleFunction</span></a></em><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.invertible_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.noise_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">noise_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a></em><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.noise_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.PostNonlinearModel.prediction_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prediction_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a></em><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel.prediction_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">ProbabilityEstimatorModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ProbabilityEstimatorModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel.estimate_probabilities">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#ProbabilityEstimatorModel.estimate_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.ProbabilityEstimatorModel.estimate_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.StochasticModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_mechanisms.</span></span><span class="sig-name descname"><span class="pre">StochasticModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#StochasticModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A stochastic model represents a model used for causal mechanisms for root nodes in a graphical causal model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.StochasticModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#StochasticModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.StochasticModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.StochasticModel.draw_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#StochasticModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.StochasticModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_mechanisms.StochasticModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_mechanisms.html#StochasticModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_mechanisms.StochasticModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.causal_models">
<span id="dowhy-gcm-causal-models-module"></span><h2>dowhy.gcm.causal_models module<a class="headerlink" href="#module-dowhy.gcm.causal_models" title="Permalink to this heading"></a></h2>
<p>This module defines the fundamental classes for graphical causal models (GCMs).</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.InvertibleStructuralCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">InvertibleStructuralCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.graph.DirectedGraph],</span> <span class="pre">~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#InvertibleStructuralCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="dowhy.gcm.causal_models.StructuralCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralCausalModel</span></code></a></p>
<p>Represents an invertible structural graphical causal model, as required e.g. by
<a class="reference internal" href="#dowhy.gcm.whatif.counterfactual_samples" title="dowhy.gcm.whatif.counterfactual_samples"><code class="xref py py-func docutils literal notranslate"><span class="pre">counterfactual_samples()</span></code></a>. This is a subclass of
<code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralCausalModel</span></code> and has further restrictions on the class of causal mechanisms.
Here, the mechanisms of non-root nodes need to be invertible with respect to the noise,
such as <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.PostNonlinearModel" title="dowhy.gcm.causal_mechanisms.PostNonlinearModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong>  Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong>  Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.InvertibleStructuralCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel" title="dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel"><span class="pre">InvertibleFunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#InvertibleStructuralCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong>  Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>, whereas a non-root node is of type
<code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.InvertibleStructuralCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel" title="dowhy.gcm.causal_mechanisms.InvertibleFunctionalCausalModel"><span class="pre">InvertibleFunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#InvertibleStructuralCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong>  Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong>  Causal mechanism to be assigned. A root node must be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>, whereas a non-root node must be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.ProbabilisticCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">ProbabilisticCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.graph.DirectedGraph],</span> <span class="pre">~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#ProbabilisticCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a probabilistic graphical causal model, i.e. it combines a graphical representation of causal
causal relationships and corresponding causal mechanism for each node describing the data generation process. The
causal mechanisms can be any general stochastic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong>  Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong>  Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.ProbabilisticCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel" title="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#ProbabilisticCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong>  Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>, whereas a non-root node is of type
<code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.ProbabilisticCausalModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#ProbabilisticCausalModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel.clone" title="Permalink to this definition"></a></dt>
<dd><p>Clones the causal model, but keeps causal mechanisms untrained.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.ProbabilisticCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel" title="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#ProbabilisticCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong>  Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong>  Causal mechanism to be assigned. A root node must be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>, whereas a non-root node must be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.StructuralCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">StructuralCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.graph.DirectedGraph],</span> <span class="pre">~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#StructuralCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticCausalModel</span></code></a></p>
<p>Represents a structural causal model (SCM), as required e.g. by
<a class="reference internal" href="#dowhy.gcm.whatif.counterfactual_samples" title="dowhy.gcm.whatif.counterfactual_samples"><code class="xref py py-func docutils literal notranslate"><span class="pre">counterfactual_samples()</span></code></a>. As compared to a <code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticCausalModel</span></code>,
an SCM describes the data generation process in non-root nodes by functional causal models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong>  Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong>  Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.StructuralCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel" title="dowhy.gcm.causal_mechanisms.FunctionalCausalModel"><span class="pre">FunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#StructuralCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.StructuralCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong>  Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>, whereas a non-root node is of type
<code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.StructuralCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.FunctionalCausalModel" title="dowhy.gcm.causal_mechanisms.FunctionalCausalModel"><span class="pre">FunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#StructuralCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.StructuralCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong>  Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong>  Causal mechanism to be assigned. A root node must be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>, whereas a non-root node must be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.clone_causal_models">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">clone_causal_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.HasNodes" title="dowhy.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.HasNodes" title="dowhy.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#clone_causal_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.clone_causal_models" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.validate_causal_dag">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">validate_causal_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#validate_causal_dag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.validate_causal_dag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.validate_causal_graph">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">validate_causal_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#validate_causal_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.validate_causal_graph" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.validate_causal_model_assignment">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">validate_causal_model_assignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#validate_causal_model_assignment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.validate_causal_model_assignment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.validate_local_structure">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">validate_local_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#validate_local_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.validate_local_structure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.validate_node">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">validate_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#validate_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.validate_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.causal_models.validate_node_has_causal_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.causal_models.</span></span><span class="sig-name descname"><span class="pre">validate_node_has_causal_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.HasNodes" title="dowhy.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/causal_models.html#validate_node_has_causal_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.causal_models.validate_node_has_causal_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.confidence_intervals">
<span id="dowhy-gcm-confidence-intervals-module"></span><h2>dowhy.gcm.confidence_intervals module<a class="headerlink" href="#module-dowhy.gcm.confidence_intervals" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to estimate confidence intervals via bootstrapping.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.confidence_intervals.confidence_intervals">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.confidence_intervals.</span></span><span class="sig-name descname"><span class="pre">confidence_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">estimation_func:</span> <span class="pre">~typing.Union[~typing.Callable[[],</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">~typing.Callable[[],</span> <span class="pre">~typing.Dict[~typing.Any,</span> <span class="pre">float]]],</span> <span class="pre">confidence_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.95,</span> <span class="pre">num_bootstrap_resamples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20,</span> <span class="pre">bootstrap_results_summary_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray],</span> <span class="pre">~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">estimate_geometric_median&gt;,</span> <span class="pre">n_jobs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/confidence_intervals.html#confidence_intervals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.confidence_intervals.confidence_intervals" title="Permalink to this definition"></a></dt>
<dd><p>Estimates confidence intervals based on the outputs generated by calling the given estimation_func. Since one result
for each repetition is produced, all results can be summarized by the method defined in
summary_method_of_bootstrap_results.
For instance, summary_method_of_bootstrap_results = lambda x: numpy.mean(x, axis=0) to get the mean over all runs.
By default, the geometric median is returned.</p>
<p>Currently, the confidence intervals are empirically estimated based on the n-th estimated quantiles (without bias
correction) of the results, where the quantiles are determined by the given confidence_level.</p>
<p>NOTE: The outputs of estimation_func are assumed to be pairwise independent. For multidimensional outputs of
estimation_func, this could be violated and should be kept in mind. For instance, when evaluating the outcome of
interventions in a graph like X -&gt; Y -&gt; Z, the confidence intervals are estimate independently for X, Y and Z
although they have a strong dependency. If estimation_func returns one dimensional results, as for instance when
estimating the direct arrow strength, then there should be no problem.</p>
<p><strong>Example usage with numpy array output:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">estimation_func</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">direct_arrow_strength_of_model</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">parent_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrow_strengths</span><span class="p">,</span> <span class="n">confidence_intervals</span> <span class="o">=</span> <span class="n">confidence_intervals</span><span class="p">(</span><span class="n">estimation_func</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example usage with dictionary output:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">estimation_func</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">distribution_change</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">causal_dag</span><span class="p">,</span> <span class="n">original_observations</span><span class="p">,</span> <span class="n">outlier_observations</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_contributions</span><span class="p">,</span> <span class="n">confidence_intervals</span> <span class="o">=</span> <span class="n">confidence_intervals</span><span class="p">(</span><span class="n">estimation_func</span><span class="p">)</span>
</pre></div>
</div>
<p>More details about the estimation of confidence intervals via bootstrapping can be found <a class="reference external" href="https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading24.pdf">here</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimation_func</strong>  Function that generates a non-deterministic output for which the confidence interval(s) are
estimated.</p></li>
<li><p><strong>confidence_level</strong>  Confidence level of the interval.</p></li>
<li><p><strong>num_bootstrap_resamples</strong>  Number of samples generated by estimation_func, i.e. number of times
is called. The higher the number, the more accurate the results and intervals,
but the slower the runtime.</p></li>
<li><p><strong>bootstrap_results_summary_func</strong>  Function that takes a numpy array with all results as an input and returns
a single (potentially multidimensional) value/vector. For instance, the mean or median
over all results.</p></li>
<li><p><strong>n_jobs</strong>  Number of parallel jobs. Each repetition can be estimated in parallel.
However, since many other functions of the library are already running in parallel (
such as distribution change), this is set to 1 by default. Only if it is certain that
the estimation_func is not running in parallel internally (e.g. when performing
interventions), this should be set to a different value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (summarized result over all repetitions based on
summary_method_of_bootstrap_results, confidence interval for each dimension/variable)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.confidence_intervals.estimate_geometric_median">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.confidence_intervals.</span></span><span class="sig-name descname"><span class="pre">estimate_geometric_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/confidence_intervals.html#estimate_geometric_median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.confidence_intervals.estimate_geometric_median" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.confidence_intervals_cms">
<span id="dowhy-gcm-confidence-intervals-cms-module"></span><h2>dowhy.gcm.confidence_intervals_cms module<a class="headerlink" href="#module-dowhy.gcm.confidence_intervals_cms" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to estimate confidence intervals via bootstrapping the fitting and sampling.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.confidence_intervals_cms.fit_and_compute">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.confidence_intervals_cms.</span></span><span class="sig-name descname"><span class="pre">fit_and_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="dowhy.gcm.causal_models.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel" title="dowhy.gcm.causal_models.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="dowhy.gcm.causal_models.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel" title="dowhy.gcm.causal_models.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_training_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_data_subset_size_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_assign_quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/confidence_intervals_cms.html#fit_and_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.confidence_intervals_cms.fit_and_compute" title="Permalink to this definition"></a></dt>
<dd><p>A convenience function when computing confidence intervals specifically for causal queries. This function
specifically bootstraps training <em>and</em> sampling.</p>
<p><strong>Example usage:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scores_median</span><span class="p">,</span> <span class="n">scores_intervals</span> <span class="o">=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">confidence_intervals</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">gcm</span><span class="o">.</span><span class="n">fit_and_compute</span><span class="p">(</span><span class="n">gcm</span><span class="o">.</span><span class="n">arrow_strength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="n">causal_model</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="n">bootstrap_training_data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="n">target_node</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong>  The causal query to perform. A causal query is a function taking a graphical causal model as first
parameter and an arbitrary number of remaining parameters. It must return a dictionary with
attribution-like data.</p></li>
<li><p><strong>causal_model</strong>  A graphical causal model to perform the causal query on. It need not be fitted.</p></li>
<li><p><strong>bootstrap_training_data</strong>  The training data to use when fitting. A random subset from this data set is used
in every iteration when calling fit.</p></li>
<li><p><strong>bootstrap_data_subset_size_fraction</strong>  The fraction defines the fractional size of the subset compared to
the total training data.</p></li>
<li><p><strong>auto_assign_quality</strong>  If a quality is provided, then the existing causal mechanisms in the given causal_model
are overridden by new automatically inferred mechanisms based on the provided
AssignmentQuality. If None is given, the existing assigned mechanisms are used.</p></li>
<li><p><strong>args</strong>  Args passed through verbatim to the causal queries.</p></li>
<li><p><strong>kwargs</strong>  Keyword args passed through verbatim to the causal queries.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing (1) the median of causal query results and (2) the confidence intervals.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.config">
<span id="dowhy-gcm-config-module"></span><h2>dowhy.gcm.config module<a class="headerlink" href="#module-dowhy.gcm.config" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.disable_progress_bars">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">disable_progress_bars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/config.html#disable_progress_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.disable_progress_bars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.enable_progress_bars">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">enable_progress_bars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/config.html#enable_progress_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.enable_progress_bars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.set_default_n_jobs">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">set_default_n_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/config.html#set_default_n_jobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.set_default_n_jobs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.constant">
<span id="dowhy-gcm-constant-module"></span><h2>dowhy.gcm.constant module<a class="headerlink" href="#module-dowhy.gcm.constant" title="Permalink to this heading"></a></h2>
</section>
<section id="module-dowhy.gcm.density_estimator">
<span id="dowhy-gcm-density-estimator-module"></span><h2>dowhy.gcm.density_estimator module<a class="headerlink" href="#module-dowhy.gcm.density_estimator" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimator.DensityEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.density_estimator.</span></span><span class="sig-name descname"><span class="pre">DensityEstimator</span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimator.html#DensityEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimator.DensityEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimator.DensityEstimator.density">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimator.html#DensityEstimator.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimator.DensityEstimator.density" title="Permalink to this definition"></a></dt>
<dd><p>Returns the density of each input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimator.DensityEstimator.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimator.html#DensityEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimator.DensityEstimator.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.density_estimators">
<span id="dowhy-gcm-density-estimators-module"></span><h2>dowhy.gcm.density_estimators module<a class="headerlink" href="#module-dowhy.gcm.density_estimators" title="Permalink to this heading"></a></h2>
<p>This module contains implementations of different density estimators.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.density_estimators.</span></span><span class="sig-name descname"><span class="pre">GaussianMixtureDensityEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#GaussianMixtureDensityEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.density_estimator.DensityEstimator" title="dowhy.gcm.density_estimator.DensityEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DensityEstimator</span></code></a></p>
<p>Represents a density estimator based on a Gaussian mixture model. The estimator uses the sklearn
BayesianGaussianMixture model internally.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#GaussianMixtureDensityEstimator.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.density" title="Permalink to this definition"></a></dt>
<dd><p>Returns the density of each input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#GaussianMixtureDensityEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.KernelDensityEstimator1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.density_estimators.</span></span><span class="sig-name descname"><span class="pre">KernelDensityEstimator1D</span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#KernelDensityEstimator1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.density_estimator.DensityEstimator" title="dowhy.gcm.density_estimator.DensityEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DensityEstimator</span></code></a></p>
<p>Represents a kernel based density estimator. The estimator uses the sklearn KernelDensity class internally.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.KernelDensityEstimator1D.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#KernelDensityEstimator1D.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D.density" title="Permalink to this definition"></a></dt>
<dd><p>Returns the density of each input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.KernelDensityEstimator1D.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#KernelDensityEstimator1D.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.distribution_change">
<span id="dowhy-gcm-distribution-change-module"></span><h2>dowhy.gcm.distribution_change module<a class="headerlink" href="#module-dowhy.gcm.distribution_change" title="Permalink to this heading"></a></h2>
<p>This module defines functions to attribute distribution changes.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.distribution_change">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">distribution_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.causal_models.ProbabilisticCausalModel,</span> <span class="pre">old_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">new_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">target_node:</span> <span class="pre">~typing.Any,</span> <span class="pre">num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">mechanism_change_test_significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">mechanism_change_test_fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh',</span> <span class="pre">auto_assignment_quality:</span> <span class="pre">~typing.Optional[~dowhy.gcm.auto.AssignmentQuality]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">return_additional_info:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">shapley_config:</span> <span class="pre">~typing.Optional[~dowhy.gcm.shapley.ShapleyConfig]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_factory:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#distribution_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.distribution_change" title="Permalink to this definition"></a></dt>
<dd><p>Attributes the change in the marginal distribution of the target_node to nodes upstream in the causal DAG.</p>
<p>Note that this method creates two copies of the causal DAG. The causal models of one causal DAG are learned from
old data and those of another DAG are learned from new data.</p>
<p><strong>Research Paper</strong>:
Kailash Budhathoki, Dominik Janzing, Patrick Bloebaum, Hoiyi Ng. <em>Why did the distribution change?</em>. Proceedings
of The 24th International Conference on Artificial Intelligence and Statistics, PMLR 130:1666-1674, 2021.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  Reference causal model.</p></li>
<li><p><strong>old_data</strong>  Joint samples from the old distribution.</p></li>
<li><p><strong>new_data</strong>  Joint samples from the new distribution.</p></li>
<li><p><strong>target_node</strong>  Target node of interest for attributing the marginal distribution change.</p></li>
<li><p><strong>num_samples</strong>  Number of samples used for estimating Shapley values. This can have a significant influence
on runtime and accuracy.</p></li>
<li><p><strong>difference_estimation_func</strong>  Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions,
e.g. difference in average values.</p></li>
<li><p><strong>independence_test</strong>  Unconditional independence test. This is used to identify mechanism changes in root nodes.</p></li>
<li><p><strong>conditional_independence_test</strong>  Conditional independence test. This is used to identify mechanism changes in
non-root nodes.</p></li>
<li><p><strong>mechanism_change_test_significance_level</strong>  A significance level for rejecting the null hypothesis that the
causal mechanism of a node has not changed.</p></li>
<li><p><strong>mechanism_change_test_fdr_control_method</strong>  The false discovery rate control method for mechanism change
tests. For more options, checkout <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">statsmodels manual</a>.</p></li>
<li><p><strong>auto_assignment_quality</strong>  If set to None, the assigned models from the given causal models are used for the
old and new graph. However, they are re-fitted on the given data.
If set to a valid assignment quality, new models are automatically assigned to the
old and new graph based on the respective data.</p></li>
<li><p><strong>return_additional_info</strong>  If set to True, three additional items are returned: a dictionary indicating
whether each nodes mechanism changed, the causal DAG whose causal models are
learned from old data, and the causal DAG whose causal models are learned from new
data.</p></li>
<li><p><strong>shapley_config</strong>  Configuration for the Shapley estimator.</p></li>
<li><p><strong>graph_factory</strong>  Allows customization in case a graph class different than networkx.DiGraph should be used.
This function <em>must</em> copy nodes and edges. Attributes of nodes will be overridden in the copy,
so the algorithm is independent of the attribute copy behavior of this factory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>By default, if <cite>return_additional_info</cite> is set to False, only the dictionary containing contribution of
each upstream node is returned. If <cite>return_additional_info</cite> is set to True, three additional items are
returned: a dictionary indicating whether each nodes mechanism changed, the causal DAG whose causal models
learned from old data, and the causal DAG whose causal models are learned from new data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.distribution_change_of_graphs">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">distribution_change_of_graphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model_old:</span> <span class="pre">~dowhy.gcm.causal_models.ProbabilisticCausalModel,</span> <span class="pre">causal_model_new:</span> <span class="pre">~dowhy.gcm.causal_models.ProbabilisticCausalModel,</span> <span class="pre">target_node:</span> <span class="pre">~typing.Any,</span> <span class="pre">num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">shapley_config:</span> <span class="pre">~typing.Optional[~dowhy.gcm.shapley.ShapleyConfig]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_factory:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~dowhy.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#distribution_change_of_graphs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.distribution_change_of_graphs" title="Permalink to this definition"></a></dt>
<dd><p>Attributes the change of the marginal distribution of target_node to upstream nodes based on the distributions
generated by the old and new causal graphs. These graphs are assumed to represent the same causal structure and
to be fitted on the respective data.</p>
<p>Note: This method creates a copy of the given causal models, i.e. the original objects will not be modified.</p>
<p>Related paper:
Budhathoki, K., Janzing, D., Bloebaum, P., &amp; Ng, H. (2021). Why did the distribution change?
arXiv preprint arXiv:2102.13384.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model_old</strong>  The ProbabilisticCausalModel fitted on the old data.</p></li>
<li><p><strong>causal_model_new</strong>  The ProbabilisticCausalModel fitted on the new data.</p></li>
<li><p><strong>target_node</strong>  Node of interest for attributing the marginal distribution change.</p></li>
<li><p><strong>num_samples</strong>  Number of samples used for the estimation. This can have a significant influence on the runtime
and accuracy.</p></li>
<li><p><strong>difference_estimation_func</strong>  Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions. An example
could be the KL divergence.</p></li>
<li><p><strong>shapley_config</strong>  Config for the Shapley estimator.</p></li>
<li><p><strong>graph_factory</strong>  Allows customization in case a graph class different than networkx.DiGraph should be used.
This function <em>must</em> copy nodes and edges. Attributes of nodes will be overridden in the copy,
so the algorithm is independent of the attribute copy behavior of this factory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the contributions of upstream nodes to the marginal distribution change in the
target node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.estimate_distribution_change_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">estimate_distribution_change_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.causal_models.ProbabilisticCausalModel,</span> <span class="pre">original_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">new_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">~typing.Union[~numpy.ndarray,</span> <span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">max_num_evaluation_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000,</span> <span class="pre">num_joint_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">500,</span> <span class="pre">early_stopping_percentage:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.01,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">mechanism_change_test_significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">mechanism_change_test_fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh'</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#estimate_distribution_change_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.estimate_distribution_change_scores" title="Permalink to this definition"></a></dt>
<dd><p>Given newly observed and original samples from the joint distribution of the given causal graphical model, this
method estimates a score for each node that quantifies how much the distribution of the node has changed. For this,
it first checks whether the underlying causal mechanism has changed at all and, if this is the case, it estimates
the difference between the new and original distributions. The score is based on the quantity measured by the
provided difference_estimation_func or 0 if no mechanism change has been detected.</p>
<p>Note that for each parent sample, num_joint_samples conditional samples are generated based on the original and new
causal mechanism and evaluated by the given difference_estimation_func function. These results are then averaged
over multiple different parent samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The underlying causal model based on the original data.</p></li>
<li><p><strong>original_data</strong>  Samples from the original data.</p></li>
<li><p><strong>new_data</strong>  Samples from the new data.</p></li>
<li><p><strong>difference_estimation_func</strong>  Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions. An example
could be the KL divergence.</p></li>
<li><p><strong>max_num_evaluation_samples</strong>  Maximum number of (parent) samples for evaluating the difference in
distributions.</p></li>
<li><p><strong>num_joint_samples</strong>  Number of samples generated in a node per parent sample.</p></li>
<li><p><strong>early_stopping_percentage</strong>  If the change in percentage between multiple consecutive runs is below this
threshold, the evaluation stops before evaluating all max_num_evaluation_samples.</p></li>
<li><p><strong>independence_test</strong>  Unconditional independence test. This is used to identify mechanism changes in root nodes.</p></li>
<li><p><strong>conditional_independence_test</strong>  Conditional independence test. This is used to identify mechanism changes in
non-root nodes.</p></li>
<li><p><strong>mechanism_change_test_significance_level</strong>  A significance level for rejecting the null hypothesis that the
causal mechanism of a node has not changed.</p></li>
<li><p><strong>mechanism_change_test_fdr_control_method</strong>  <p>The false discovery rate control method for mechanism change
tests. For more options, checkout <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">statsmodels manual</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary assining a score to each node in the causal graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.mechanism_change_test">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">mechanism_change_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">target_original_data:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">target_new_data:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">parents_original_data:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">parents_new_data:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#mechanism_change_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.mechanism_change_test" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a p-value for the null hypothesis that the original and new data were generated by the same mechanism.
Here, we check the dependency between binary labels indicating whether a sample is from the original or a new
data set. If the labels do not provide information to determine if a sample is coming from the original/new
distribution, then it is likely that the mechanism has not changed.</p>
<p>For non-root nodes, samples from parent variables are needed as conditioning variables. This is, testing the
null hypothesis that the data were generated by the same mechanism given the parent samples. By this, we incorporate
upstream changes that might have impacted the parents, but not the target node itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_original_data</strong>  Samples of the node from the original data set.</p></li>
<li><p><strong>target_new_data</strong>  Samples of the node from the new data set.</p></li>
<li><p><strong>parents_original_data</strong>  Samples from parents of the node from the original data set.</p></li>
<li><p><strong>parents_new_data</strong>  Samples from parents of the node from the new data set.</p></li>
<li><p><strong>independence_test</strong>  Unconditional independence test. This is used to identify mechanism changes in nodes
without parents.</p></li>
<li><p><strong>conditional_independence_test</strong>  Conditional independence test. This is used to identify mechanism changes in
nodes with parents.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A p-value for the null hypothesis that the mechanism has not changed.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.divergence">
<span id="dowhy-gcm-divergence-module"></span><h2>dowhy.gcm.divergence module<a class="headerlink" href="#module-dowhy.gcm.divergence" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.auto_estimate_kl_divergence">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">auto_estimate_kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#auto_estimate_kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.auto_estimate_kl_divergence" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_categorical">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_categorical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_categorical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_categorical" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_continuous">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_common_elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_continuous" title="Permalink to this definition"></a></dt>
<dd><p>Estimates KL-Divergence using k-nearest neighbours (Wang et al., 2009).</p>
<p>Q. Wang, S. R. Kulkarni, and S. Verd,
Divergence estimation for multidimensional densities via k-nearest-neighbor distances,
IEEE Transactions on Information Theory, vol. 55, no. 5, pp. 2392-2405, May 2009.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong>  (N_1,D) Sample drawn from distribution P_X</p></li>
<li><p><strong>Y</strong>  (N_2,D) Sample drawn from distribution P_Y</p></li>
<li><p><strong>k</strong>  Number of neighbors to consider.</p></li>
<li><p><strong>remove_common_elements</strong>  If true, common values in X and Y are removed. This would otherwise lead to
a KNN distance of zero for these values if k is set to 1, which would cause a
division by zero error.</p></li>
</ul>
</dd>
</dl>
<p>return: Estimated value of D(P_X||P_Y).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_of_probabilities">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_of_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_of_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_of_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the Kullback-Leibler divergence between each pair of probability vectors (row wise) in X and Y
separately and returns the mean over all results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.is_probability_matrix">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">is_probability_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#is_probability_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.is_probability_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.falsify">
<span id="dowhy-gcm-falsify-module"></span><h2>dowhy.gcm.falsify module<a class="headerlink" href="#module-dowhy.gcm.falsify" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to falsify a user-given DAG given observed data.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.EvaluationResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">EvaluationResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suggestions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#EvaluationResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.EvaluationResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataset class containing the evaluation result of falsifying a graph using a node-permutation test.</p>
<p></p>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>summary<span class="classifier">dict</span></dt><dd><p>Dictionary containing the summary of the evaluation.</p>
</dd>
<dt>significance_level<span class="classifier">float</span></dt><dd><p>Significance level based on which we falsify the given DAG</p>
</dd>
<dt>falsifiable<span class="classifier">bool</span></dt><dd><p>Whether the given DAG is falsifiable.</p>
</dd>
<dt>falsified<span class="classifier">bool</span></dt><dd><p>Whether the given DAG is falsified.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.EvaluationResult.significance_level">
<span class="sig-name descname"><span class="pre">significance_level</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#dowhy.gcm.falsify.EvaluationResult.significance_level" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.EvaluationResult.suggestions">
<span class="sig-name descname"><span class="pre">suggestions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dowhy.gcm.falsify.EvaluationResult.suggestions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.EvaluationResult.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#dowhy.gcm.falsify.EvaluationResult.summary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.EvaluationResult.update_significance_level">
<span class="sig-name descname"><span class="pre">update_significance_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#EvaluationResult.update_significance_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.EvaluationResult.update_significance_level" title="Permalink to this definition"></a></dt>
<dd><p>Update the significance level to decide if we falsify a given DAG.</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">FalsifyConst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#FalsifyConst"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.F_GIVEN_VIOLATIONS">
<span class="sig-name descname"><span class="pre">F_GIVEN_VIOLATIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">7</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.F_GIVEN_VIOLATIONS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.F_PERM_VIOLATIONS">
<span class="sig-name descname"><span class="pre">F_PERM_VIOLATIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.F_PERM_VIOLATIONS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.GIVEN_VIOLATIONS">
<span class="sig-name descname"><span class="pre">GIVEN_VIOLATIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.GIVEN_VIOLATIONS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.LOCAL_VIOLATION_INSIGHT">
<span class="sig-name descname"><span class="pre">LOCAL_VIOLATION_INSIGHT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">9</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.LOCAL_VIOLATION_INSIGHT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.MEC">
<span class="sig-name descname"><span class="pre">MEC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.MEC" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.METHOD">
<span class="sig-name descname"><span class="pre">METHOD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.METHOD" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.N_TESTS">
<span class="sig-name descname"><span class="pre">N_TESTS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.N_TESTS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.N_VIOLATIONS">
<span class="sig-name descname"><span class="pre">N_VIOLATIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.N_VIOLATIONS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.PERM_GRAPHS">
<span class="sig-name descname"><span class="pre">PERM_GRAPHS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">15</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.PERM_GRAPHS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.PERM_VIOLATIONS">
<span class="sig-name descname"><span class="pre">PERM_VIOLATIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.PERM_VIOLATIONS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.P_VALUE">
<span class="sig-name descname"><span class="pre">P_VALUE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.P_VALUE" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.P_VALUES">
<span class="sig-name descname"><span class="pre">P_VALUES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.P_VALUES" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.VALIDATE_CM">
<span class="sig-name descname"><span class="pre">VALIDATE_CM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">14</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_CM" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.VALIDATE_LMC">
<span class="sig-name descname"><span class="pre">VALIDATE_LMC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">11</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_LMC" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.VALIDATE_PD">
<span class="sig-name descname"><span class="pre">VALIDATE_PD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">13</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_PD" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.FalsifyConst.VALIDATE_TPA">
<span class="sig-name descname"><span class="pre">VALIDATE_TPA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">12</span></em><a class="headerlink" href="#dowhy.gcm.falsify.FalsifyConst.VALIDATE_TPA" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.apply_suggestions">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">apply_suggestions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.falsify.EvaluationResult" title="dowhy.gcm.falsify.EvaluationResult"><span class="pre">EvaluationResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges_to_keep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#apply_suggestions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.apply_suggestions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.falsify_graph">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">falsify_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_graph:</span> <span class="pre">~dowhy.graph.DirectedGraph,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">suggestions:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">significance_ci:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">n_permutations:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">show_progress_bar:</span> <span class="pre">~typing.Optional[bool]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">n_jobs:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">plot_histogram:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">plot_kwargs:</span> <span class="pre">~typing.Optional[~typing.Dict]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dowhy.gcm.falsify.EvaluationResult" title="dowhy.gcm.falsify.EvaluationResult"><span class="pre">EvaluationResult</span></a></span></span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#falsify_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.falsify_graph" title="Permalink to this definition"></a></dt>
<dd><p>Falsify a given DAG using observational data.</p>
<p>This method returns the result of a permutation-test to falsify a user-given DAG using observational data. To this
end we construct the test statistics by testing the violations of local Markov conditions (LMC) implied by
the graph using conditional independence (CI) tests. The null is the number of LMC violations of a random
node-permutation of the given graph. Our test can be interpreted as whether the given graph is significantly better
than random in terms of the CIs it entails.
To determine whether a given graph is falsifiable by our metric, we implement a second test, which reports whether
given graph is characteristic enough in terms of the CIs it entails. For this, we compute how many of the random
node permutations lie in the same Markov equivalence class (MEC) as the given graph and conclude that the given
graph is falsifiable only if the fraction of permuted DAGs in the same MEC as the given graph is reasonably small.</p>
<dl>
<dt>The returned EvaluationResult object has two attributes: <cite>falsified</cite> and <cite>falsifiable</cite>:</dt><dd><p><cite>falsifiable</cite>: The given graph lies in a different MEC than &gt;= 1-<cite>significance_level</cite> of the permuted DAGs
<cite>falsified</cite>: The given graph is falsifiable and violates fewer LMCs than &gt;= 1-<cite>significance_level</cite> of the</p>
<blockquote>
<div><p>permuted DAGs</p>
</div></blockquote>
</dd>
</dl>
<p>By default, we only run 1 / <cite>significance_level</cite> permutations as those are enough to falsify a graph with type I
error probability <cite>significance_level</cite> at some given <cite>significance_level</cite>. If you are interested in a more exact
estimate of the p-value or wish to plot a histogram to see how the given DAG compares to random node permutations,
you should set <cite>n_permutations</cite> to some larger value (e.g. 100 or 1000). If <cite>n_permutations=-1</cite> we test on all
n_nodes! permutations (the default if plot_histogram=True).</p>
<p>Additionally, this method allows to return suggestions to the user (suggestions=True). This is done by testing for
violations of causal minimality via <cite>validate_cm</cite>.</p>
<dl class="simple">
<dt>Related paper:</dt><dd><p>Eulig, E., Mastakouri, A. A., Blbaum, P., Hardt, M., &amp; Janzing, D. (2023).
Toward Falsifying Causal Graphs Using a Permutation-Based Test.
<a class="reference external" href="https://arxiv.org/abs/2305.09565">https://arxiv.org/abs/2305.09565</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong>  A directed acyclic graph (DAG).</p></li>
<li><p><strong>data</strong>  Observations of variables in the DAG.</p></li>
<li><p><strong>suggestions</strong>  Provide suggestions to the user. At the moment the only source of suggestions comes from
validating causal minimality (using validate_cm).</p></li>
<li><p><strong>independence_test</strong>  Independence test to use for checking pairwise independencies.</p></li>
<li><p><strong>conditional_independence_test</strong>  Conditional independence test to use.</p></li>
<li><p><strong>significance_level</strong>  Significance level for the permutation test.</p></li>
<li><p><strong>significance_ci</strong>  Significance level for (conditional) independence tests.</p></li>
<li><p><strong>n_permutations</strong>  Number of permutations to perform. If -1 use all n_nodes! permutations.</p></li>
<li><p><strong>show_progress_bar</strong>  Whether to show progress bar over permutations.</p></li>
<li><p><strong>n_jobs</strong>  Number of jobs to use for parallel execution of (conditional) independence tests.</p></li>
<li><p><strong>plot_histogram</strong>  Plot histogram of results from permutation baseline.</p></li>
<li><p><strong>plot_kwargs</strong>  Additional plot arguments to be passed to plot_evaluation_results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>EvaluationResult</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.plot_evaluation_results">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">plot_evaluation_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluation_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#plot_evaluation_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.plot_evaluation_results" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.plot_local_insights">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">plot_local_insights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.falsify.EvaluationResult" title="dowhy.gcm.falsify.EvaluationResult"><span class="pre">EvaluationResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">FalsifyConst.VALIDATE_LMC</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#plot_local_insights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.plot_local_insights" title="Permalink to this definition"></a></dt>
<dd><p>For some given graph and evaluation result plot local violations.
:param causal_graph: DiGraph
:param evaluation_result: EvaluationResult
:param method: Method for which to plot violations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.run_validations">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">run_validations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_graph:</span> <span class="pre">~dowhy.graph.DirectedGraph,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">methods:</span> <span class="pre">~typing.Optional[~typing.Union[~typing.Callable,</span> <span class="pre">~typing.Tuple[~typing.Callable,</span> <span class="pre">...],</span> <span class="pre">~typing.List[~typing.Callable]]]</span> <span class="pre">=</span> <span class="pre">functools.partial(&lt;function</span> <span class="pre">validate_lmc&gt;,</span> <span class="pre">independence_test=&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test=&lt;function</span> <span class="pre">kernel_based&gt;)</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#run_validations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.run_validations" title="Permalink to this definition"></a></dt>
<dd><p>Validate a given causal graph using observational data and some given methods. If methods are provided, they must
be wrapped in a partial object, with their respective parameters. E.g., if one wants to test the local
Markov conditions and the pairwise dependencies (unconditional faithfulness), then call</p>
<blockquote>
<div><dl class="simple">
<dt>run_validations(G, data, methods=(</dt><dd><p>partial(validate_lmc, independence_test=, conditional_independence_test=),
partial(validate_pd, independence_test=),
)</p>
</dd>
</dl>
<p>)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong>  A directed acyclic graph (DAG).</p></li>
<li><p><strong>data</strong>  Observations of variables in the DAG.</p></li>
<li><p><strong>methods</strong>  Method functions wrapped in wrap_partial. E.g.
wrap_partial(validate_lmc, data=data, independence_test=, conditional_independence_test=).
If no methods are provided we run validate_lmc with optional keyword arguments provided to
run_validations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validation summary as dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.validate_cm">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">validate_cm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_graph:</span> <span class="pre">~dowhy.graph.DirectedGraph,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">p_values_memory:</span> <span class="pre">~typing.Optional[~dowhy.gcm.falsify._PValuesMemory]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">n_jobs:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#validate_cm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.validate_cm" title="Permalink to this definition"></a></dt>
<dd><p>Function to test causal minimality of a DAG (see [1], Proposition 6.36).
[1] J. Peters, D. Janzing, and B. Schlkopf, Elements of Causal Inference: Foundations and Learning Algorithms.
Cambridge, MA, USA: MIT Press, 2017.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong>  A directed acyclic graph (DAG).</p></li>
<li><p><strong>data</strong>  Observations of variables in the DAG.</p></li>
<li><p><strong>p_values_memory</strong>  _PValuesMemory object, where results of previously performed tests are stored.</p></li>
<li><p><strong>independence_test</strong>  Independence test to use.</p></li>
<li><p><strong>conditional_independence_test</strong>  Conditional independence test to use.</p></li>
<li><p><strong>significance_level</strong>  Significance level for independence tests.</p></li>
<li><p><strong>n_jobs</strong>  Number of jobs to use for parallel execution of (conditional) independence tests.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validation summary as dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.validate_lmc">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">validate_lmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_graph:</span> <span class="pre">~dowhy.graph.DirectedGraph,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">p_values_memory:</span> <span class="pre">~typing.Optional[~dowhy.gcm.falsify._PValuesMemory]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">include_unconditional:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">n_jobs:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#validate_lmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.validate_lmc" title="Permalink to this definition"></a></dt>
<dd><p>Validate the local markov condition for a given directed graph. Return number of violations and p values for each
node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong>  A directed acyclic graph (DAG).</p></li>
<li><p><strong>data</strong>  Observations of variables in the DAG.</p></li>
<li><p><strong>p_values_memory</strong>  _PValuesMemory instance, where results of previously performed tests are stored.</p></li>
<li><p><strong>independence_test</strong>  Test to use for unconditional independencies (only used if include_unconditional=True)</p></li>
<li><p><strong>conditional_independence_test</strong>  Conditional independence test to use for checking local Markov condition.</p></li>
<li><p><strong>significance_level</strong>  Significance level for (conditional) independence tests.</p></li>
<li><p><strong>include_unconditional</strong>  Test also unconditional independencies of root nodes.</p></li>
<li><p><strong>n_jobs</strong>  Number of jobs to use for parallel execution of (conditional) independence tests.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Outcome of validation containing number of violations in the graph and p values/violation for each tuple
(node, non_desc)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.validate_pd">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">validate_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_graph:</span> <span class="pre">~dowhy.graph.DirectedGraph,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">p_values_memory:</span> <span class="pre">~typing.Optional[~dowhy.gcm.falsify._PValuesMemory]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">n_pairs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">-1,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">adjacent_only:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">n_jobs:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#validate_pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.validate_pd" title="Permalink to this definition"></a></dt>
<dd><p>Validate pairwise dependencies (pd) for a given causal graph and data. Test for each node if it is statistically
dependent of all its ancestors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong>  A directed acyclic graph (DAG).</p></li>
<li><p><strong>data</strong>  Observations of variables in the DAG.</p></li>
<li><p><strong>p_values_memory</strong>  _PValuesMemory object, where results of previously performed tests are stored.</p></li>
<li><p><strong>n_pairs</strong>  Evaluate dependencies for n_pairs &lt;= all pairs in the DAG. If n_pairs=-1, evaluate dependencies for
all (ancestor, node) pairs (default).</p></li>
<li><p><strong>independence_test</strong>  Independence test to use for checking pairwise dependencies.</p></li>
<li><p><strong>significance_level</strong>  Significance level for independence tests.</p></li>
<li><p><strong>adjacent_only</strong>  Only test adjacent node pairs.</p></li>
<li><p><strong>n_jobs</strong>  Number of jobs to use for parallel execution of (conditional) independence tests.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Summary dict: {n_violations: int, n_tests: int, p_values: {(ancestor, node): float, }}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.falsify.validate_tpa">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.falsify.</span></span><span class="sig-name descname"><span class="pre">validate_tpa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal_graph_reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.html#dowhy.graph.DirectedGraph" title="dowhy.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_unconditional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/falsify.html#validate_tpa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.falsify.validate_tpa" title="Permalink to this definition"></a></dt>
<dd><p>Graphical criterion to evaluate which pairwise parental d-separations (parental triples) in <cite>causal_graph</cite> are
violated, assuming <cite>causal_graph_reference</cite> is the ground truth graph. If none are violated, then both graphs lie
in the same Markov equivalence class.
Specifically we test:</p>
<blockquote>
<div><p>X _|_G Y | Z and X _/<a href="#id2"><span class="problematic" id="id3">|</span></a>_G Y | Z for Y in ND{X}^G, Z = PA{X}^G</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong>  Causal graph for which to evaluate parental d-separations (G)</p></li>
<li><p><strong>causal_graph_reference</strong>  Causal graph where we test if d-separation holds (G)</p></li>
<li><p><strong>include_unconditional</strong>  Test also unconditional independencies of root nodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validation summary with number of d-separations implied by <cite>causal_graph</cite> and number of times these are
violated in the graph <cite>causal_graph_reference</cite>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.feature">
<span id="dowhy-gcm-feature-module"></span><h2>dowhy.gcm.feature module<a class="headerlink" href="#module-dowhy.gcm.feature" title="Permalink to this heading"></a></h2>
<p>This module is deprecated! All functions are moved into the feature_relevance.py module.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature.feature_relevance_distribution">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature.</span></span><span class="sig-name descname"><span class="pre">feature_relevance_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature.html#feature_relevance_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature.feature_relevance_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated, please use feature_relevance_distribution from the feature_relevance.py module instead.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature.feature_relevance_sample">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature.</span></span><span class="sig-name descname"><span class="pre">feature_relevance_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_target_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_set_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature.html#feature_relevance_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature.feature_relevance_sample" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated, please use feature_relevance_sample from the feature_relevance.py module instead.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature.parent_relevance">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature.</span></span><span class="sig-name descname"><span class="pre">parent_relevance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="dowhy.gcm.causal_models.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature.html#parent_relevance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature.parent_relevance" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated, please use parent_relevance from the feature_relevance.py module instead.</p>
</dd></dl>

</section>
<section id="module-dowhy.gcm.feature_relevance">
<span id="dowhy-gcm-feature-relevance-module"></span><h2>dowhy.gcm.feature_relevance module<a class="headerlink" href="#module-dowhy.gcm.feature_relevance" title="Permalink to this heading"></a></h2>
<p>This module allows to estimate the feature relevance of inputs with respect to a given model. While these models can
be blackbox prediction models, it is also possible to explain causal mechanisms with respect to the direct parents.
In these cases, it would be possible to incorporate the noise to represent the part of the generation process that
cannot be explained by the parents.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature_relevance.feature_relevance_distribution">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature_relevance.</span></span><span class="sig-name descname"><span class="pre">feature_relevance_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature_relevance.html#feature_relevance_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature_relevance.feature_relevance_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the population based feature relevance of the input features for the given prediction_method. This
method uses all samples given in feature_samples by comparing the output of the prediction_method given certain
features are randomized with the outputs when no features are randomized. The subset_scoring_func defines
how these predictions are compared. For instance, the variance of deviations.</p>
<p>If the randomized predictions should rather be compared to the original data, this has (and can) be defined via
the set function by ignoring the second input parameter (the predicted values using all feauters). Instead, the
original data can be used.</p>
<p>Note: The distribution level relevance is estimated by taking the expectation of the outcome of the set functions
when applied to multiple samples. Due to the linearity of the Shapley value estimation, this is equivalent to taking
the expectation over the Shapley values.</p>
<p>Related paper:
Janzing, D., Minorics, L., &amp; Bloebaum, P. (2020).
Feature relevance quantification in explainable AI: A causal problem.
In International Conference on Artificial Intelligence and Statistics (pp. 2907-2916). PMLR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_method</strong>  A callable that is expected to return a prediction for given samples.</p></li>
<li><p><strong>feature_samples</strong>  Samples from the joint distribution.</p></li>
<li><p><strong>subset_scoring_func</strong>  Set function for estimating the quantity of interest based on the model outcomes. This function
expects two inputs; the outcome of the prediction model for some samples if certain features are permuted and the
outcome of the model for the same samples when no features were permuted. The set functions represents the
comparison between the samples, for instance, the variance of deviations. This is then used as the characteristic function
in coalition games when estimating the Shapley values.</p></li>
<li><p><strong>max_num_samples_randomization</strong>  Maximum number of samples used for randomizing the feature that are not in the susbet. Consider increasing this
number for more accurate results (if enough samples are available) or reducing it for less memory consumption and
faster runtime.</p></li>
<li><p><strong>max_num_baseline_samples</strong>  Maximum number of samples on which the set function is evaluated on. These samples are used as fixed observations for
features that are in the subset. For instance, in case of taking the mean as set_function_summary_func, this defines the maximum number
of samples used to estimate the mean. Consider increasing this number for more accurate results (if enough samples are
available) or reducing it for less memory consumption and faster runtime.</p></li>
<li><p><strong>max_batch_size</strong>  Maximum batch size for a estimating the predictions. This has a significant influence on the
overall memory usage. If set to -1, all samples are used in one batch.</p></li>
<li><p><strong>randomize_features_jointly</strong>  If set to True, features that are not in a subset are jointly permuted.
Note that this still represents an interventional distribution. If set to False, features that are not in a subset
are independently permuted. Note: The theory in the linked publication assumes that this is set to True.</p></li>
<li><p><strong>shapley_config</strong>  Config for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array with the feature relevance of each input feature.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature_relevance.feature_relevance_sample">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature_relevance.</span></span><span class="sig-name descname"><span class="pre">feature_relevance_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_target_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_set_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature_relevance.html#feature_relevance_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature_relevance.feature_relevance_sample" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the feature relevance of the prediction_method for each sample in baseline_noise_samples. This
method uses all samples given in feature_samples as background samples. This is, they should represent samples
from the joint distribution of the input features. The subset_scoring_func defines the comparison between the
output of the prediction_method when certain features are randomized and the outputs when no features are
randomized. The most common function would be the difference between the expectations.</p>
<p>If the randomized predictions should rather be compared to the original data, this has (and can) be defined via
the set function by ignoring the second input parameter (the predicted values using all feauters). Instead, the
original data can be used.</p>
<p>Related paper:
Janzing, D., Minorics, L., &amp; Bloebaum, P. (2020).
Feature relevance quantification in explainable AI: A causal problem.
In International Conference on Artificial Intelligence and Statistics (pp. 2907-2916). PMLR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_method</strong>  A callable that is expected to return a prediction for given samples.</p></li>
<li><p><strong>feature_samples</strong>  Samples from the joint distribution. These are used as background samples to randomize features that are not in a subset.</p></li>
<li><p><strong>baseline_samples</strong>  Samples for which the feature relevance should be estimated.</p></li>
<li><p><strong>subset_scoring_func</strong>  Set function for estimating the quantity of interest based on the model outcomes. This function
expects two inputs; the outcome of the prediction model for some samples if certain features are permuted and the
outcome of the model for the same samples when no features were permuted. A typical choice for regression models
would be the difference between expectations. This is then used as the characteristic function
in coalition games when estimating the Shapley values.</p></li>
<li><p><strong>baseline_target_values</strong>  These baseline values are compared with the subset specific outcomes of the prediction method. If set to None (default),
the baseline values are the outcomes of the given prediction_method applied to the baseline_noise_samples, i.e. the outcome of the empty subset.</p></li>
<li><p><strong>max_batch_size</strong>  Maximum batch size for a estimating the predictions. This has a significant influence on the
overall memory usage. If set to -1, all samples are used in one batch.</p></li>
<li><p><strong>average_set_function</strong>  If set to True, the averaged result of the set function applied to each sample of
interest is used for estimating the Shapley values. If set to False, Shapley values for each sample of interest
are estimated separately.</p></li>
<li><p><strong>randomize_features_jointly</strong>  If set to True, features that are not in a subset are jointly permuted.
Note that this still represents an interventional distribution. If set to False, features that are not in a subset
are independently permuted. Note: The theory in the linked publication assumes that this is set to True.</p></li>
<li><p><strong>shapley_config</strong>  Config for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array with the feature relevance for each sample in baseline_noise_samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature_relevance.parent_relevance">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature_relevance.</span></span><span class="sig-name descname"><span class="pre">parent_relevance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="dowhy.gcm.causal_models.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature_relevance.html#parent_relevance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature_relevance.parent_relevance" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the distribution based relevance of the direct parents of the given target_node. This is, the
relevance of direct parents as input features of the the underlying causal model of target_node. Here, the
unobserved noise is considered as a direct parent (input) as well. Samples utilized for the estimation are drawn
from the given causal graph.</p>
<p>By default, the used subset_scoring_func is based on the variance between Y and Y, where Y is the outputs of
the causal model and Y the outputs of the models when certain features are randomized. In case of continuous data,
the feature relevance adds up to Var(Y - Y).</p>
<p>Note: The feature relevance based on the distribution cannot be directly compared with the feature relevance for
single samples. If this is desired, the set function needs to be defined accordingly.</p>
<p>Related paper:
Janzing, D., Minorics, L., &amp; Bloebaum, P. (2020).
Feature relevance quantification in explainable AI: A causal problem.
In International Conference on Artificial Intelligence and Statistics (pp. 2907-2916). PMLR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The fitted structural causal model.</p></li>
<li><p><strong>target_node</strong>  Node with the causal model of interest.</p></li>
<li><p><strong>parent_samples</strong>  Samples for the parents of the given target_node. If None is given, new samples are
generated based on the graph. These samples are used for randomizing features that are not in the subset.</p></li>
<li><p><strong>subset_scoring_func</strong>  Set function for estimating the quantity of interest based on the model outcomes. This function
expects two inputs; the outcome of the causal model for some samples if certain features are permuted and the
outcome of the model for the same samples when no features were permuted. The set functions represents the
comparison between the samples, for instance, the variance of deviations. This is then used as the characteristic function
in coalition games when estimating the Shapley values.</p></li>
<li><p><strong>num_samples_randomization</strong>  Number of samples used as background parent samples for evaluating the set function.
If no parent_samples are given, this represents the number of generated samples from
the joint distribution of the parents and are used for randomizing features that are
not in the subset. Consider increasing this number for more accurate results or reducing it for less memory consumption and faster runtime.</p></li>
<li><p><strong>num_samples_baseline</strong>  Number of samples on which the set functions are evaluated on. These samples are used as fixed observations for
parents that are in the subset. Consider increasing this number for more accurate results or reducing it for less memory consumption and faster runtime.</p></li>
<li><p><strong>max_batch_size</strong>  Maximum batch size for estimating multiple predictions at once. This has a significant influence on the
overall memory usage. If set to -1, all samples are used in one batch.</p></li>
<li><p><strong>shapley_config</strong>  <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>There are two return vales. A dictionary with the feature relevance for each direct parent of the given
target_node and the feature relevance of noise.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.fitting_sampling">
<span id="dowhy-gcm-fitting-sampling-module"></span><h2>dowhy.gcm.fitting_sampling module<a class="headerlink" href="#module-dowhy.gcm.fitting_sampling" title="Permalink to this heading"></a></h2>
<p>This module provides functionality for fitting probabilistic causal models and drawing samples from them.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.draw_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws new joint samples from the given graphical causal model. This is done by first generating random samples
from root nodes and then propagating causal downstream effects through the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  New samples are generated based on the given causal model.</p></li>
<li><p><strong>num_samples</strong>  Number of samples to draw.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas data frame where columns correspond to the nodes in the graph and rows to the drawn joint samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.fit">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.fit" title="Permalink to this definition"></a></dt>
<dd><p>Learns generative causal models of nodes in the causal graph from data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The causal model containing the mechanisms that will be fitted.</p></li>
<li><p><strong>data</strong>  Observations of nodes in the causal model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.fit_causal_model_of_target">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">fit_causal_model_of_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#fit_causal_model_of_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.fit_causal_model_of_target" title="Permalink to this definition"></a></dt>
<dd><p>Fits only the causal mechanism of the given target node based on the training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The causal model containing the target node.</p></li>
<li><p><strong>target_node</strong>  Target node for which the mechanism is fitted.</p></li>
<li><p><strong>training_data</strong>  Training data for fitting the causal mechanism.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.influence">
<span id="dowhy-gcm-influence-module"></span><h2>dowhy.gcm.influence module<a class="headerlink" href="#module-dowhy.gcm.influence" title="Permalink to this heading"></a></h2>
<p>This module provides functions to estimate causal influences.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.influence.arrow_strength">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.influence.</span></span><span class="sig-name descname"><span class="pre">arrow_strength</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_conditional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference_estimation_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/influence.html#arrow_strength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.influence.arrow_strength" title="Permalink to this definition"></a></dt>
<dd><p>Computes the causal strength of each edge directed to the target node.
The strength of an edge is quantified in terms of distance between conditional distributions of the target node in
the original graph and the imputed graph wherein the edge has been removed and the target node is fed a random
permutation of the observations of the source node. For more scientific details behind this API, please refer to
the research paper below.</p>
<p><strong>Research Paper</strong>:
Dominik Janzing, David Balduzzi, Moritz Grosse-Wentrup, Bernhard Schlkopf. <em>Quantifying Causal Influences</em>. The
Annals of Statistics, Vol. 41, No. 5, 2324-2358, 2013.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The probabilistic causal model for whose target node we compute the strength of incoming
edges for.</p></li>
<li><p><strong>target_node</strong>  The target node whose incoming edges strength is to be computed.</p></li>
<li><p><strong>parent_samples</strong>  Optional samples from the parents of the target_node. If None are given, they are generated
based on the provided causal model. Providing observational data can help to mitigate
misspecifications in the graph, such as missing interactions between root nodes or
confounders.</p></li>
<li><p><strong>num_samples_conditional</strong>  Sample size to use for estimating the distance between distributions. The more
more samples, the higher the accuracy.</p></li>
<li><p><strong>max_num_runs</strong>  The maximum number of times to resample and estimate the strength to report the average
strength.</p></li>
<li><p><strong>tolerance</strong>  If the percentage change in the estimated strength between two consecutive runs falls below the
specified tolerance, the algorithm will terminate before reaching the maximum number of runs.
A value of 0.01 would indicate a change of less than 1%. However, in order to minimize the impact
of randomness, there must be at least three consecutive runs where the change is below the
threshold.</p></li>
<li><p><strong>n_jobs</strong>  The number of jobs to run in parallel. Set it to -1 to use all processors.</p></li>
<li><p><strong>difference_estimation_func</strong>  Optional: How to measure the distance between two distributions. By default,
the difference of the variance is estimated for a continuous target node
and the KL divergence for a categorical target node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Causal strength of each edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.influence.arrow_strength_of_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.influence.</span></span><span class="sig-name descname"><span class="pre">arrow_strength_of_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conditional_stochastic_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel" title="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_from_conditional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference_estimation_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_subsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/influence.html#arrow_strength_of_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.influence.arrow_strength_of_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.influence.intrinsic_causal_influence">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.influence.</span></span><span class="sig-name descname"><span class="pre">intrinsic_causal_influence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="dowhy.gcm.causal_models.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.classification.ClassificationModel" title="dowhy.gcm.ml.classification.ClassificationModel"><span class="pre">ClassificationModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'approx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribution_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_training_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_assign_quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AssignmentQuality.GOOD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/influence.html#intrinsic_causal_influence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.influence.intrinsic_causal_influence" title="Permalink to this definition"></a></dt>
<dd><p>Computes the causal contribution of each upstream noise term of the target node (including the noise of the
target itself) to the statistical property (e.g. mean, variance) of the target. We call this contribution
<em>intrinsic</em> as noise terms, by definition, do not inherit properties of observed parents. The contribution of each
noise term is then the <em>intrinsic</em> causal contribution of the corresponding node. For more scientific details,
please refer to the paper below.</p>
<p><strong>Research Paper</strong>:
Janzing et al. <em>Quantifying causal contributions via structure preserving interventions</em>. arXiv:2007.00714, 2021.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The structural causal model for whose target node we compute the intrinsic causal influence
of its ancestors.</p></li>
<li><p><strong>target_node</strong>  Target node whose statistical property is to be attributed.</p></li>
<li><p><strong>prediction_model</strong>  Prediction model for estimating the functional relationship between subsets of ancestor
noise terms and the target node. This can be an instance of a PredictionModel, the string
approx or the string exact. With exact, the underlying causal models in the graph
are utilized directly by propagating given noise inputs through the graph. This is
generally more accurate but slow. With approx, an appropriate model is selected and
trained based on sampled data from the graph, which is less accurate but faster. A more
detailed treatment on why we need this parameter is also provided in <span class="xref std std-ref">icc</span>.</p></li>
<li><p><strong>attribution_func</strong>  Optional attribution function to measure the statistical property of the target node. This
function expects two inputs; predictions after the randomization of certain features (i.e.
samples from noise nodes) and a baseline where no features were randomized. The baseline
predictions can be typically ignored if one is interested in uncertainty measures such as
entropy or variance, but they might be relevant if, for instance, these shall be estimated
based on the residuals. By default, entropy is used if prediction model is a classifier,
variance otherwise.</p></li>
<li><p><strong>num_training_samples</strong>  Number of samples drawn from the graphical causal model that are used for fitting the
prediction_model (if necessary).</p></li>
<li><p><strong>num_samples_randomization</strong>  Number of noise samples drawn from the graphical causal model that are used for
evaluating the set function. Here, these samples are samples from
the noise distributions used for randomizing features that are not in the subset.</p></li>
<li><p><strong>num_samples_baseline</strong>  Number of noise samples drawn from the graphical causal model that are used for
evaluating the set function. Here, these samples are used as fixed observations for
features that are in the subset.</p></li>
<li><p><strong>max_batch_size</strong>  Maximum batch size for estimating the predictions from evaluation samples. This has a
significant impact on the overall memory usage. If set to -1, all samples are used in one
batch.</p></li>
<li><p><strong>auto_assign_quality</strong>  Auto assign quality for the approx prediction_model option.</p></li>
<li><p><strong>shapley_config</strong>  <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Intrinsic causal contribution of each ancestor node to the statistical property defined by the
attribution_func of the target node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.influence.intrinsic_causal_influence_sample">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.influence.</span></span><span class="sig-name descname"><span class="pre">intrinsic_causal_influence_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel" title="dowhy.gcm.causal_models.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_noise_feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/influence.html#intrinsic_causal_influence_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.influence.intrinsic_causal_influence_sample" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the intrinsic causal impact of upstream nodes on a specified target_node, using the provided
baseline_samples as a reference. In this context, observed values are attributed to the noise factors present in
upstream nodes. Compared to intrinsic_causal_influence, this method quantifies the influences with respect to single
observations instead of the distribution. Note that the current implementation only supports non-categorical data,
since the noise terms need to be reconstructed.</p>
<p><strong>Research Paper</strong>:
Janzing et al. <em>Quantifying causal contributions via structure preserving interventions</em>. arXiv:2007.00714, 2021.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The fitted invertible structural causal model.</p></li>
<li><p><strong>target_node</strong>  Node of interest.</p></li>
<li><p><strong>baseline_samples</strong>  Samples for which the influence should be estimated.</p></li>
<li><p><strong>noise_feature_samples</strong>  Optional noise samples of upstream nodes used as background samples.. If None is
given, new noise samples are generated based on the graph. These samples are used for
randomizing features that are not in the subset.</p></li>
<li><p><strong>subset_scoring_func</strong>  Set function for estimating the quantity of interest based. This function
expects two inputs; the outcome of the model for some samples if certain features are permuted and the
outcome of the model for the same samples when no features were permuted. By default,
the difference between means of these samples are estimated.</p></li>
<li><p><strong>num_noise_feature_samples</strong>  If no noise_feature_samples are given, noise samples are drawn from the graph.
This parameter indicates how many.</p></li>
<li><p><strong>max_batch_size</strong>  Maximum batch size for estimating multiple predictions at once. This has a significant influence on the
overall memory usage. If set to -1, all samples are used in one batch.</p></li>
<li><p><strong>shapley_config</strong>  <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries indicating the intrinsic causal influence of a node on the target for a particular
sample. This is, each dictionary belongs to one baseline sample.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.shapley">
<span id="dowhy-gcm-shapley-module"></span><h2>dowhy.gcm.shapley module<a class="headerlink" href="#module-dowhy.gcm.shapley" title="Permalink to this heading"></a></h2>
<p>This module provides functionality for shapley value estimation.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">ShapleyApproximationMethods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#ShapleyApproximationMethods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>AUTO: Using EXACT when number of players is below 6 and EARLY_STOPPING otherwise.
EXACT: Generate all possible subsets and estimate Shapley values with corresponding subset weights.
EXACT_FAST: Generate all possible subsets and estimate Shapley values via weighed least squares regression. This can</p>
<blockquote>
<div><p>be faster, but, depending on the set function, numerically less stable.</p>
</div></blockquote>
<dl class="simple">
<dt>SUBSET_SAMPLING: Randomly samples subsets and estimate Shapley values via weighed least squares regression. Here,</dt><dd><p>only a certain number of randomly drawn subsets are used.</p>
</dd>
<dt>EARLY_STOPPING: Estimate Shapley values based on a few randomly generated permutations. Stop the estimation process</dt><dd><p>when the Shapley values do not change much on average anymore between runs.</p>
</dd>
<dt>PERMUTATION: Estimates Shapley values based on a fixed number of randomly generated permutations. By fine tuning</dt><dd><p>hyperparameters, this can be potentially faster than the early stopping approach due to a better
utilization of the parallelization.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.AUTO">
<span class="sig-name descname"><span class="pre">AUTO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.AUTO" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EARLY_STOPPING">
<span class="sig-name descname"><span class="pre">EARLY_STOPPING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(3,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EARLY_STOPPING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT">
<span class="sig-name descname"><span class="pre">EXACT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(1,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT_FAST">
<span class="sig-name descname"><span class="pre">EXACT_FAST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(2,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT_FAST" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.PERMUTATION">
<span class="sig-name descname"><span class="pre">PERMUTATION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(4,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.PERMUTATION" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.SUBSET_SAMPLING">
<span class="sig-name descname"><span class="pre">SUBSET_SAMPLING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(5,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.SUBSET_SAMPLING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">ShapleyConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">approximation_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="dowhy.gcm.shapley.ShapleyApproximationMethods"><span class="pre">ShapleyApproximationMethods</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ShapleyApproximationMethods.AUTO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_permutations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subset_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_percentage_change_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#ShapleyConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Config for estimating Shapley values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>approximation_method</strong>  Type of approximation methods (see <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="dowhy.gcm.shapley.ShapleyApproximationMethods"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyApproximationMethods</span></code></a>).</p></li>
<li><p><strong>num_permutations</strong>  Number of permutations used for approximating the Shapley values. This value is only
used for PERMUTATION and EARLY_STOPPING. In both cases, it indicates the maximum
number of permutations that are evaluated. Note that EARLY_STOPPING might stop before
reaching the number of permutations if the change in Shapley values fall below
min_percentage_change_threshold.</p></li>
<li><p><strong>num_subset_samples</strong>  Number of subsets used for the SUBSET_SAMPLING method. This value is not used
otherwise.</p></li>
<li><p><strong>min_percentage_change_threshold</strong>  This parameter is only relevant for EARLY_STOPPING and indicates the
minimum required change in percentage of the Shapley values between two
runs before the estimation stops. For instance, with a value of 0.01
the estimation would stop if all Shapley values change less than 0.01
per run. To mitigate the impact of randomness, the changes need to stay
below the threshold for at least 2 consecutive runs.</p></li>
<li><p><strong>n_jobs</strong>  Number of parallel jobs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.estimate_shapley_values">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">estimate_shapley_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_players</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#estimate_shapley_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.estimate_shapley_values" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the Shapley values based on the provided set function. A set function here is defined by taking a
(subset) of players and returning a certain utility value. This is in the context of attributing the
value of the i-th player to a subset of players S by evaluating v(S u {i}) - v(S), where v is the
set function and i is not in S. While we use the term player here, this is often a certain feature/variable.</p>
<p>The input of the set function is a binary vector indicating which player is part of the set. For instance, given 4
players (1,2,3,4) and a subset only contains players 1,2,4, then this is indicated by the vector [1, 1, 0, 1]. The
function is expected to return a numeric value based on this input.</p>
<p>Note: The set function can be arbitrary and can resemble computationally complex operations. Keep in mind
that the estimation of Shapley values can become computationally expensive and requires a lot of memory. If the
runtime is too slow, consider changing the default config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>set_func</strong>  A set function that expects a binary vector as input which specifies which player is part of the
subset.</p></li>
<li><p><strong>num_players</strong>  Total number of players.</p></li>
<li><p><strong>shapley_config</strong>  A config object for indicating the approximation method and other parameters. If None is
given, a default config is used. For faster runtime or more accurate results, consider
creating a custom config.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array representing the Shapley values for each player, i.e. there are as many Shapley values as
num_players. The i-th entry belongs to the i-th player. Here, the set function defines which index belongs
to which player and is responsible to keep it consistent.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.stats">
<span id="dowhy-gcm-stats-module"></span><h2>dowhy.gcm.stats module<a class="headerlink" href="#module-dowhy.gcm.stats" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.estimate_ftest_pvalue">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">estimate_ftest_pvalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_training_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_training_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#estimate_ftest_pvalue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.estimate_ftest_pvalue" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the p-value for the null hypothesis that the same regression error with less parameters can be
achieved. This is, a linear model trained on a data set A with d number of features has the same performance
(in terms of squared error) relative to the number of features as a model trained on a data set B with k number
features, where k &lt; d. Here, both data sets need to have the same target values. A small p-value would
indicate that the model performances are significantly different.</p>
<p>Note that all given test samples are utilized in the f-test.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/F-test#Regression_problems">https://en.wikipedia.org/wiki/F-test#Regression_problems</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_training_a</strong>  Input training samples for model A.</p></li>
<li><p><strong>X_training_b</strong>  Input training samples for model B. These samples should have less features than samples in X_training_a.</p></li>
<li><p><strong>Y_training</strong>  Target training values.</p></li>
<li><p><strong>X_test_a</strong>  Test samples for model A.</p></li>
<li><p><strong>X_test_b</strong>  Test samples for model B.</p></li>
<li><p><strong>Y_test</strong>  Test values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A p-value on [0, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.marginal_expectation">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">marginal_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_feature_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_averaged_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_perturbation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'randomize_columns_jointly'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#marginal_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.marginal_expectation" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the marginal expectation for samples in baseline_noise_samples when randomizing features that are not
part of baseline_feature_indices. This is, this function estimates</p>
<blockquote>
<div><p>y^i = E[Y | do(x^i_s)] := int_x_s E[Y | x^i_s, x_s] p(x_s) d x_s,</p>
</div></blockquote>
<p>where x^i_s is the i-th sample from baseline_noise_samples, s denotes the baseline_feature_indices and
x_s ~ X_s denotes the randomized features that are not in s. For an approximation of the integral, the given
prediction_method is evaluated multiple times for the same x^i_s, but different x_s ~ X_s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction_method</strong>  Prediction method of interest. This should expect a numpy array as input for making</p>
</dd>
</dl>
<p>predictions.
:param feature_samples: Samples from the joint distribution. These are used for randomizing the features that are not in</p>
<blockquote>
<div><p>baseline_feature_indices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>baseline_samples</strong>  Samples for which the marginal expectation should be estimated.</p></li>
<li><p><strong>baseline_feature_indices</strong>  Column indices of the features in s. These values for these features are remain constant
when estimating the expectation.</p></li>
<li><p><strong>return_averaged_results</strong>  If set to True, the expectation over all evaluated samples for the i-th</p></li>
</ul>
</dd>
</dl>
<p>baseline_noise_samples is returned. If set to False, all corresponding results for the i-th sample are returned.
:param feature_perturbation: Type of feature permutation:</p>
<blockquote>
<div><p>randomize_columns_independently: Each feature not in s is randomly permuted separately.
randomize_columns_jointly: All features not in s are jointly permuted. Note that this still represents an
interventional distribution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_batch_size</strong>  Maximum batch size for a estimating the predictions. This has a significant influence on the</p>
</dd>
</dl>
<p>overall memory usage. If set to -1, all samples are used in one batch.
:return: If return_averaged_results is False, a numpy array where the i-th entry belongs to the marginal expectation
of x^i_s when randomizing the remaining features.
If return_averaged_results is True, a two dimensional numpy array where the i-th entry contains all
predictions for x^i_s when randomizing the remaining features.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.permute_features">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">permute_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_permute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#permute_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.permute_features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.quantile_based_fwer">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">quantile_based_fwer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_values_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#quantile_based_fwer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.quantile_based_fwer" title="Permalink to this definition"></a></dt>
<dd><p>Applies a quantile based family wise error rate (FWER) control to the given p-values. This is based on the
approach described in:</p>
<p>Meinshausen, N., Meier, L. and Buehlmann, P. (2009).
p-values for high-dimensional regression. J. Amer. Statist. Assoc.104 16711681</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_values</strong>  A list or array of p-values.</p></li>
<li><p><strong>p_values_scaling</strong>  An optional list of scaling factors for each p-value.</p></li>
<li><p><strong>quantile</strong>  The quantile used for the p-value adjustment. By default, this is the median (0.5).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The p-value that lies on the quantile threshold. Note that this is the quantile based on scaled values
p_values / quantile.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.stochastic_models">
<span id="dowhy-gcm-stochastic-models-module"></span><h2>dowhy.gcm.stochastic_models module<a class="headerlink" href="#module-dowhy.gcm.stochastic_models" title="Permalink to this heading"></a></h2>
<p>This module defines multiple implementations of the abstract class <code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>.</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">BayesianGaussianMixtureDistribution</span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">EmpiricalDistribution</span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<p>An implementation of a stochastic model that uniformly samples from data samples. By randomly returning a sample
from the training data set, this model represents a parameter free representation of the marginal distribution of
the training data. However, it will not generate unseen data points. For this, consider <code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianGaussianMixtureDistribution</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">ScipyDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scipy_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<p>Represents any parametric distribution that can be modeled by scipy.</p>
<p>Initializes a stochastic model that allows to sample from a parametric distribution implemented in Scipy.</p>
<dl class="simple">
<dt>For instance, to use a beta distribution with parameters a=2 and b=0.5:</dt><dd><p>ScipyDistribution(stats.beta, a=2, b=0.5)</p>
</dd>
<dt>Or a Gaussian distribution with mean=0 and standard deviation 2:</dt><dd><p>ScipyDistribution(stats.norm, loc=2, scale=0.5)</p>
</dd>
</dl>
<p>Note that the parameter names need to coincide with the parameter names in the corresponding Scipy
implementations. See <a class="reference external" href="https://docs.scipy.org/doc/scipy/tutorial/stats.html">https://docs.scipy.org/doc/scipy/tutorial/stats.html</a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scipy_distribution</strong>  A continuous or discrete distribution parametric distribution implemented in Scipy.</p></li>
<li><p><strong>parameters</strong>  Set of parameters of the parametric distribution.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.find_suitable_continuous_distribution">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_suitable_continuous_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergence_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.find_suitable_continuous_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.find_suitable_continuous_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Tries to find the best fitting continuous parametric distribution of given samples. This is done by fitting
different parametric models and selecting the one with the smallest KL divergence between observed and generated
samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.map_scipy_distribution_parameters_to_names">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">map_scipy_distribution_parameters_to_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scipy_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.map_scipy_distribution_parameters_to_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.map_scipy_distribution_parameters_to_names" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to obtain a mapping from parameter name to parameter value. Depending whether the
distribution is discrete or continuous, there are slightly different parameter names. The given parameters are
assumed to follow the order as provided by the scipy fit function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scipy_distribution</strong>  The scipy distribution.</p></li>
<li><p><strong>parameters</strong>  The values of the corresponding parameters of the distribution. Here, it is expected to
follow the same order as defined by the scipy fit function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary that maps a parameter name to its value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.scipy_distribution">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scipy_distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.scipy_distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.uncertainty">
<span id="dowhy-gcm-uncertainty-module"></span><h2>dowhy.gcm.uncertainty module<a class="headerlink" href="#module-dowhy.gcm.uncertainty" title="Permalink to this heading"></a></h2>
<p>Functions to estimate uncertainties such as entropy, KL divergence etc.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_discrete">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_discrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_discrete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_discrete" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the entropy assuming the data in X is discrete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong>  Discrete samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Entropy of X.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_kmeans">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_kmeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_kmeans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_kmeans" title="Permalink to this definition"></a></dt>
<dd><p>Related paper:
Kozachenko, L., &amp; Leonenko, N. (1987). Sample estimate of the entropy of a random vector. Problemy Peredachi
Informatsii, 23(2), 916.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_of_probabilities">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_of_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_of_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_of_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the entropy of each probability vector (row wise) in X separately and returns the mean over all
results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_using_discretization">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_using_discretization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_using_discretization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_using_discretization" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_gaussian_entropy">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_gaussian_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_gaussian_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_gaussian_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Entropy with respect to standardized variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_variance">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_variance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.unit_change">
<span id="dowhy-gcm-unit-change-module"></span><h2>dowhy.gcm.unit_change module<a class="headerlink" href="#module-dowhy.gcm.unit_change" title="Permalink to this heading"></a></h2>
<p>This module provides the APIs for attributing the change in the output value of a deterministic mechanism for a statistical unit.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.LinearPredictionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.unit_change.</span></span><span class="sig-name descname"><span class="pre">LinearPredictionModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/unit_change.html#LinearPredictionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.unit_change.LinearPredictionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.LinearPredictionModel.coefficients">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coefficients</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#dowhy.gcm.unit_change.LinearPredictionModel.coefficients" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.SklearnLinearRegressionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.unit_change.</span></span><span class="sig-name descname"><span class="pre">SklearnLinearRegressionModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sklearn_mdl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LinearModel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/unit_change.html#SklearnLinearRegressionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.unit_change.SklearnLinearRegressionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.regression.SklearnRegressionModel" title="dowhy.gcm.ml.regression.SklearnRegressionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SklearnRegressionModel</span></code></a>, <a class="reference internal" href="#dowhy.gcm.unit_change.LinearPredictionModel" title="dowhy.gcm.unit_change.LinearPredictionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearPredictionModel</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.SklearnLinearRegressionModel.coefficients">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coefficients</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#dowhy.gcm.unit_change.SklearnLinearRegressionModel.coefficients" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.unit_change">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.unit_change.</span></span><span class="sig-name descname"><span class="pre">unit_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">background_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_column_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/unit_change.html#unit_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.unit_change.unit_change" title="Permalink to this definition"></a></dt>
<dd><p>This function attributes the change in the output value of a deterministic mechanism for a statistical unit to each input and optionally for the mechanism if <cite>foreground_mechanism</cite> is provided.
The technical method is described in the following research paper:
Kailash Budhathoki, George Michailidis, Dominik Janzing. <em>Explaining the root causes of unit-level changes</em>. arXiv, 2022.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>background_df</strong>  The background dataset.</p></li>
<li><p><strong>foreground_df</strong>  The foreground dataset.</p></li>
<li><p><strong>input_column_names</strong>  The names of the input columns.</p></li>
<li><p><strong>background_mechanism</strong>  The background mechanism. If the mechanism does not change, then this mechanism is used for attribution.</p></li>
<li><p><strong>foreground_mechanism</strong>  The foreground mechanism. If provided, the method also attributes the output change to the change in the mechanism.</p></li>
<li><p><strong>shapley_config</strong>  The configuration for calculating Shapley values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe containing the contributions of each input and optionally the mechanism to the change in the output values of the deterministic mechanism(s) for given inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.unit_change_linear">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.unit_change.</span></span><span class="sig-name descname"><span class="pre">unit_change_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">background_mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.unit_change.LinearPredictionModel" title="dowhy.gcm.unit_change.LinearPredictionModel"><span class="pre">LinearPredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.unit_change.LinearPredictionModel" title="dowhy.gcm.unit_change.LinearPredictionModel"><span class="pre">LinearPredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_column_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/unit_change.html#unit_change_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.unit_change.unit_change_linear" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the contributions of mechanism and each input to the change in the output values of a linear deterministic mechanism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>background_mechanism</strong>  The linear background mechanism.</p></li>
<li><p><strong>background_df</strong>  The background data.</p></li>
<li><p><strong>foreground_mechanism</strong>  The linear foreground mechanism.</p></li>
<li><p><strong>foreground_df</strong>  The foreground data.</p></li>
<li><p><strong>input_column_names</strong>  The names of the input columns in both dataframes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas dataframe with attributions to each cause for the change in each output row of provided dataframes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.unit_change_linear_input_only">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.unit_change.</span></span><span class="sig-name descname"><span class="pre">unit_change_linear_input_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.unit_change.LinearPredictionModel" title="dowhy.gcm.unit_change.LinearPredictionModel"><span class="pre">LinearPredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_column_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/unit_change.html#unit_change_linear_input_only"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.unit_change.unit_change_linear_input_only" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the contributions of each input to the change in the output values of a linear deterministic mechanism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mechanism</strong>  The linear mechanism.</p></li>
<li><p><strong>background_df</strong>  The background data.</p></li>
<li><p><strong>foreground_df</strong>  The foreground data.</p></li>
<li><p><strong>input_column_names</strong>  The names of the input (features) columns in both dataframes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas dataframe with attributions to each cause for the change in each output row of provided dataframes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.unit_change_nonlinear">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.unit_change.</span></span><span class="sig-name descname"><span class="pre">unit_change_nonlinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">background_mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_column_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/unit_change.html#unit_change_nonlinear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.unit_change.unit_change_nonlinear" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the contributions of mechanism and each input to the change in the output values of a non-linear deterministic mechanism.
The technical method is described in the following research paper:
Kailash Budhathoki, George Michailidis, Dominik Janzing. <em>Explaining the root causes of unit-level changes</em>. arXiv, 2022.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>background_mechanism</strong>  The background mechanism.</p></li>
<li><p><strong>background_df</strong>  The background data.</p></li>
<li><p><strong>foreground_mechanism</strong>  The foreground mechanism.</p></li>
<li><p><strong>foreground_df</strong>  The foreground data.</p></li>
<li><p><strong>input_column_names</strong>  The names of the input (features) columns in both dataframes.</p></li>
<li><p><strong>shapley_config</strong>  The configuration for calculating Shapley values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas dataframe with attributions to each cause for the change in each output row of provided dataframes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.unit_change.unit_change_nonlinear_input_only">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.unit_change.</span></span><span class="sig-name descname"><span class="pre">unit_change_nonlinear_input_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_column_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/unit_change.html#unit_change_nonlinear_input_only"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.unit_change.unit_change_nonlinear_input_only" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the contributions of each input to the change in the output values of a non-linear deterministic mechanism.
The technical method is a modification of the attribution method described in the following research paper, without mechanism as a player:
Kailash Budhathoki, George Michailidis, Dominik Janzing. <em>Explaining the root causes of unit-level changes</em>. arXiv, 2022.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mechanism</strong>  The mechanism.</p></li>
<li><p><strong>background_df</strong>  The background data.</p></li>
<li><p><strong>foreground_df</strong>  The foreground data.</p></li>
<li><p><strong>input_column_names</strong>  The names of the input (features) columns in both dataframes.</p></li>
<li><p><strong>shapley_config</strong>  The configuration for calculating Shapley values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas dataframe with attributions to each cause for the change in each output row of provided dataframes.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.validation">
<span id="dowhy-gcm-validation-module"></span><h2>dowhy.gcm.validation module<a class="headerlink" href="#module-dowhy.gcm.validation" title="Permalink to this heading"></a></h2>
<p>Contains a method to reject the causal graph and validate causal mechanisms such as post non-linear models.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.validation.RejectionResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.validation.</span></span><span class="sig-name descname"><span class="pre">RejectionResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/validation.html#RejectionResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.validation.RejectionResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.validation.RejectionResult.NOT_REJECTED">
<span class="sig-name descname"><span class="pre">NOT_REJECTED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(&lt;enum.auto</span> <span class="pre">object&gt;,)</span></em><a class="headerlink" href="#dowhy.gcm.validation.RejectionResult.NOT_REJECTED" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.validation.RejectionResult.REJECTED">
<span class="sig-name descname"><span class="pre">REJECTED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#dowhy.gcm.validation.RejectionResult.REJECTED" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.validation.refute_causal_structure">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.validation.</span></span><span class="sig-name descname"><span class="pre">refute_causal_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_graph:</span> <span class="pre">~dowhy.graph.DirectedGraph,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh'</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.validation.RejectionResult" title="dowhy.gcm.validation.RejectionResult"><span class="pre">RejectionResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/validation.html#refute_causal_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.validation.refute_causal_structure" title="Permalink to this definition"></a></dt>
<dd><p>Validates the assumptions in a causal graph against data. To this end, at each node, we test if the node is dependent on each of its parents, and test the local Markov condition.
Note that valid local Markov conditions also imply a valid global Markov condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong>  A directed acyclic graph (DAG).</p></li>
<li><p><strong>data</strong>  Observations of variables in the DAG.</p></li>
<li><p><strong>independence_test</strong>  Independence test to use for checking edge dependencies.</p></li>
<li><p><strong>conditional_independence_test</strong>  Conditional independence test to use for checking local Markov condition.</p></li>
<li><p><strong>significance_level</strong>  Significance level for (conditional) independence tests.</p></li>
<li><p><strong>fdr_control_method</strong>  Method for false discovery rate (FDR) control. For various options, please refer to <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">this page</a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Outcome of the validation process. The first element of the tuple indicates whether the graph is valid w.r.t. given data, and the second element gives the summary of tests at each node. An example for X-&gt;Y-&gt;Z:</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;local_markov_test&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;edge_dependence_test&#39;</span><span class="p">:</span> <span class="p">{}},</span>
        <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;local_markov_test&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;edge_dependence_test&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;fdr_adjusted_p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}},</span>
        <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;local_markov_test&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;fdr_adjusted_p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
              <span class="s1">&#39;edge_dependence_test&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;fdr_adjusted_p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}}}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.validation.refute_invertible_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.validation.</span></span><span class="sig-name descname"><span class="pre">refute_invertible_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.causal_models.InvertibleStructuralCausalModel,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dowhy.gcm.validation.RejectionResult" title="dowhy.gcm.validation.RejectionResult"><span class="pre">RejectionResult</span></a></span></span><a class="reference internal" href="_modules/dowhy/gcm/validation.html#refute_invertible_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.validation.refute_invertible_model" title="Permalink to this definition"></a></dt>
<dd><p>Validate the assumption that the structural causal models can be represented by a
<code class="xref py py-class docutils literal notranslate"><span class="pre">InvertibleFunctionalCausalModel</span></code> (e.g. the causal mechanisms are
<code class="xref py py-class docutils literal notranslate"><span class="pre">AdditiveNoiseModels</span></code> and/or <code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModels</span></code>).
For this, it is checked if the residual of a causal mechanism is independent of the mechanisms input
(i.e. we assume causal sufficiency here). For instance, <code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModels</span></code> represent</p>
<blockquote>
<div><p>Y = f(g(X) + N),</p>
</div></blockquote>
<p>where f is invertible (g does not need to be), X are the parents of Y and N is (assumed to be) independent noise.
The latter point is important here. For given data, we can then reconstruct N and perform an independence test between X and N.</p>
<p>Note that this method only validates the causal mechanisms and not the graph structure.</p>
<dl class="simple">
<dt>For the case of post non-linear models, see the following paper for more details:</dt><dd><p>Zhang, K., and A. Hyvrinen.
On the Identifiability of the Post-Nonlinear Causal Model.
25th Conference on Uncertainty in Artificial Intelligence (UAI 2009). AUAI Press, 2009.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  A fitted invertible structural causal model.</p></li>
<li><p><strong>data</strong>  Observations of variables in the DAG.</p></li>
<li><p><strong>independence_test</strong>  Independence test to use for checking if residual and input are dependent.</p></li>
<li><p><strong>significance_level</strong>  Significance level for deciding whether input and residual is dependent.</p></li>
<li><p><strong>fdr_control_method</strong>  <p>Method for false discovery rate (FDR) control. For various options, please refer to <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">this page</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The outcome of the validation. The causal model can not be rejected if all causal mechanisms are consistent with
the invertible model assumption.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.whatif">
<span id="dowhy-gcm-whatif-module"></span><h2>dowhy.gcm.whatif module<a class="headerlink" href="#module-dowhy.gcm.whatif" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to answer what-if questions.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.average_causal_effect">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">average_causal_effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions_alternative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions_reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_to_draw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#average_causal_effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.average_causal_effect" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the average causal effect (ACE) on the target of two different sets of interventions.
The interventions can be specified through the parameters <cite>interventions_alternative</cite> and <cite>interventions_reference</cite>.
For example, if the alternative intervention is do(T := 1) and the reference intervention
is do(T := 0), then the average causal effect is given by ACE = E[Y | do(T := 1)] - E[Y | do(T := 0)]:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">average_causal_effect</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
<dl>
<dt>We can also specify more complex interventions on multiple nodes:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">average_causal_effect</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                      <span class="s1">&#39;Y&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                      <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;X0&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>                      <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;X0&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
<p>In the above, we would estimate ACE = E[Y | do(T := 1), do(X0 := X0 + 1)] - E[Y | do(T := 0), do(X0 := X0 * 2)].</p>
<p>Note: The target node can be a continuous real-valued variable or a categorical variable with at most two classes
(i.e. binary).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The probabilistic causal model we perform this intervention on .</p></li>
<li><p><strong>target_node</strong>  Target node for which the ACE is estimated.</p></li>
<li><p><strong>interventions_alternative</strong>  Dictionary defining the interventions for the alternative values.</p></li>
<li><p><strong>interventions_reference</strong>  Dictionary defining the interventions for the reference values.</p></li>
<li><p><strong>observed_data</strong>  Factual data that we observe for the nodes in the causal graph. By default, new data
is sampled using the causal model. If observational data is available, providing them
might improve the accuracy by mitigating issues due to a misspecified graph and/or causal
models.</p></li>
<li><p><strong>num_samples_to_draw</strong>  Number of samples drawn from the causal model for estimating ACE if no observed data is
given.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The estimated average causal effect (ACE).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.counterfactual_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">counterfactual_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.causal_models.StructuralCausalModel" title="dowhy.gcm.causal_models.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.causal_models.InvertibleStructuralCausalModel" title="dowhy.gcm.causal_models.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#counterfactual_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.counterfactual_samples" title="Permalink to this definition"></a></dt>
<dd><p>Estimates counterfactual data for observed data if we were to perform specified interventions. This function
implements the 3-step process for computing counterfactuals by Pearl (see <a class="reference external" href="https://ftp.cs.ucla.edu/pub/stat_ser/r485.pdf">https://ftp.cs.ucla.edu/pub/stat_ser/r485.pdf</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The (invertible) structural causal model we perform this intervention on. If noise_data is
None and observed_data is provided, this must be an invertible structural model, otherwise,
this can be either a structural causal model or an invertible one.</p></li>
<li><p><strong>interventions</strong>  Dictionary containing the interventions we want to perform keyed by node name. An
intervention is a function that takes a value as input and returns another value.
For example, <cite>{X: lambda x: 2}</cite> mimics the atomic intervention <em>do(X:=2)</em>.</p></li>
<li><p><strong>observed_data</strong>  Factual data that we observe for the nodes in the causal graph.</p></li>
<li><p><strong>noise_data</strong>  Data of noise terms corresponding to nodes in the causal graph. If not provided,
these have to be estimated from observed data. Then we require causal models of nodes to be
invertible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Estimated counterfactual data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.interventional_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">interventional_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.causal_models.ProbabilisticCausalModel" title="dowhy.gcm.causal_models.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_to_draw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#interventional_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.interventional_samples" title="Permalink to this definition"></a></dt>
<dd><p>Performs intervention on nodes in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong>  The probabilistic causal model we perform this intervention on .</p></li>
<li><p><strong>interventions</strong>  Dictionary containing the interventions we want to perform, keyed by node name. An
intervention is a function that takes a value as input and returns another value.
For example, <cite>{X: lambda x: 2}</cite> mimics the atomic intervention <em>do(X:=2)</em>.
A soft intervention can be formulated as <cite>{X: lambda x: 0.2 * x}</cite>.</p></li>
<li><p><strong>observed_data</strong>  Optionally, data on which to perform interventions. If None are given, data is generated based
on the generative models.</p></li>
<li><p><strong>num_samples_to_draw</strong>  Sample size to draw from the interventional distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Samples from the interventional distribution.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dowhy.gcm" title="Permalink to this heading"></a></h2>
<p>The gcm sub-package provides features built on top of graphical causal model (GCM) based inference. The status of
this addition and its API is considered experimental, meaning there might be breaking changes to its API in the
future.</p>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="dowhy.do_samplers.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">dowhy.do_samplers package</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="dowhy.gcm.independence_test.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">dowhy.gcm.independence_test package</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PyWhy contributors.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>
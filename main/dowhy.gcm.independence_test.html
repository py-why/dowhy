
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B139P18WHM');
</script>
    <title>dowhy.gcm.independence_test package &#8212; DoWhy  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dowhy.gcm.ml package" href="dowhy.gcm.ml.html" />
    <link rel="prev" title="dowhy.gcm package" href="dowhy.gcm.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">DoWhy  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="example_notebooks/nb_index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="dowhy.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="code_repo.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
      <div class="navbar-end-item">
        
<div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main-branch
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <!-- hard-coding the old versions, as no further old version will be added -->
            <!-- It would be nice if this opened the same page in an older version, but that seems to be overkill
                 right now. Therefore defaulting to the starting page (index). -->
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
            <dd><a href="/dowhy/v0.1-alpha/index.html">v0.1-alpha</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="dowhy.gcm.independence_test.html">main</a></dd>
        </dl>
    </div>
</div>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.api.html">
   dowhy.api package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_estimators.html">
   dowhy.causal_estimators package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_identifiers.html">
   dowhy.causal_identifiers package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_refuters.html">
   dowhy.causal_refuters package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.data_transformers.html">
   dowhy.data_transformers package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.do_samplers.html">
   dowhy.do_samplers package
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="dowhy.gcm.html">
   dowhy.gcm package
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     dowhy.gcm.independence_test package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.ml.html">
     dowhy.gcm.ml package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.util.html">
     dowhy.gcm.util package
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.graph_learners.html">
   dowhy.graph_learners package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.interpreters.html">
   dowhy.interpreters package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.utils.html">
   dowhy.utils package
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test.kernel">
   dowhy.gcm.independence_test.kernel module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test.kernel_operation">
   dowhy.gcm.independence_test.kernel_operation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test.regression">
   dowhy.gcm.independence_test.regression module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test">
   Module contents
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="dowhy-gcm-independence-test-package">
<h1>dowhy.gcm.independence_test package<a class="headerlink" href="#dowhy-gcm-independence-test-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-dowhy.gcm.independence_test.kernel">
<span id="dowhy-gcm-independence-test-kernel-module"></span><h2>dowhy.gcm.independence_test.kernel module<a class="headerlink" href="#module-dowhy.gcm.independence_test.kernel" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel.approx_kernel_based">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel.</span></span><span class="sig-name descname"><span class="pre">approx_kernel_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">X:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Y:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Z:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">num_random_features_X:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">50,</span> <span class="pre">num_random_features_Y:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">50,</span> <span class="pre">num_random_features_Z:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">50,</span> <span class="pre">num_permutations:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100,</span> <span class="pre">approx_kernel:</span> <span class="pre">~typing.Callable[[~numpy.ndarray],</span> <span class="pre">~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">approximate_rbf_kernel_features&gt;,</span> <span class="pre">scale_data:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">use_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">bootstrap_num_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">bootstrap_num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000,</span> <span class="pre">bootstrap_n_jobs:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">p_value_adjust_func:</span> <span class="pre">~typing.Callable[[~typing.Union[~numpy.ndarray,</span> <span class="pre">~typing.List[float]]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">quantile_based_fwer&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel.html#approx_kernel_based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel.approx_kernel_based" title="Permalink to this definition"></a></dt>
<dd><p>Implementation of the Randomized Conditional Independence Test. The independence test estimates a p-value
for the null hypothesis that X and Y are independent (given Z). Depending whether Z is given, a conditional or
pairwise independence test is performed.</p>
<p>If Z is given: Using RCIT as conditional independence test.
If Z is not given: Using RIT as pairwise independence test.</p>
<p>Note:
- The data can be multivariate, i.e. the given input matrices can have multiple columns.
- Categorical data need to be represented as strings.
- It is possible to apply a different kernel to each column in the matrices. For instance, a RBF kernel for the</p>
<blockquote>
<div><p>first dimension in X and a delta kernel for the second.</p>
</div></blockquote>
<dl class="simple">
<dt>Based on the work:</dt><dd><p>Strobl, Eric V., Kun Zhang, and Shyam Visweswaran.
Approximate kernel-based conditional independence tests for fast non-parametric causal discovery.
Journal of Causal Inference 7.1 (2019).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Data matrix for observations from X.</p></li>
<li><p><strong>Y</strong> – Data matrix for observations from Y.</p></li>
<li><p><strong>Z</strong> – Optional data matrix for observations from Z. This is the conditional variable.</p></li>
<li><p><strong>num_random_features_X</strong> – Number of features sampled from the approximated kernel map for X.</p></li>
<li><p><strong>num_random_features_Y</strong> – Number of features sampled from the approximated kernel map for Y.</p></li>
<li><p><strong>num_random_features_Z</strong> – Number of features sampled from the approximated kernel map for Z.</p></li>
<li><p><strong>num_permutations</strong> – Number of permutations for estimating the test test statistic.</p></li>
<li><p><strong>approx_kernel</strong> – The approximated kernel map. The expected input is a n x d numpy array and the output is 
expected to be a n x k numpy array with k &lt;&lt; d. By default, the Nystroem method with a RBF
kernel is used.</p></li>
<li><p><strong>scale_data</strong> – If set to True, the data will be standardized. If set to False, the data is taken as it is.
Standardizing the data helps in identifying weak dependencies. If one is only interested in
stronger ones, consider setting this to False.</p></li>
<li><p><strong>use_bootstrap</strong> – If True, the independence tests are performed on multiple subsets of the data and the final
p-value is constructed based on the provided p_value_adjust_func function.</p></li>
<li><p><strong>bootstrap_num_runs</strong> – Number of bootstrap runs (only relevant if use_bootstrap is True).</p></li>
<li><p><strong>bootstrap_num_samples</strong> – Maximum number of used samples per bootstrap run.</p></li>
<li><p><strong>bootstrap_n_jobs</strong> – Number of parallel jobs for the boostrap runs.</p></li>
<li><p><strong>p_value_adjust_func</strong> – A callable that expects a numpy array of multiple p-values and returns one p-value. This
is typically used a family wise error rate control method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The p-value for the null hypothesis that X and Y are independent (given Z).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel.kernel_based">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel.</span></span><span class="sig-name descname"><span class="pre">kernel_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">X:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Y:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Z:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">kernel:</span> <span class="pre">~typing.Callable[[~numpy.ndarray],</span> <span class="pre">~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">apply_rbf_kernel_with_adaptive_precision&gt;,</span> <span class="pre">scale_data:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">use_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">bootstrap_num_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20,</span> <span class="pre">bootstrap_num_samples_per_run:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">bootstrap_n_jobs:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">p_value_adjust_func:</span> <span class="pre">~typing.Callable[[~typing.Union[~numpy.ndarray,</span> <span class="pre">~typing.List[float]]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">quantile_based_fwer&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel.html#kernel_based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel.kernel_based" title="Permalink to this definition"></a></dt>
<dd><p>Prepares the data and uses kernel (conditional) independence test. The independence test estimates a p-value
for the null hypothesis that X and Y are independent (given Z). Depending whether Z is given, a conditional or
pairwise independence test is performed.</p>
<p>If Z is given: Using KCI as conditional independence test.
If Z is not given: Using HSIC as pairwise independence test.</p>
<p>Note:
- The data can be multivariate, i.e. the given input matrices can have multiple columns.
- Categorical data need to be represented as strings.
- It is possible to apply a different kernel to each column in the matrices. For instance, a RBF kernel for the</p>
<blockquote>
<div><p>first dimension in X and a delta kernel for the second.</p>
</div></blockquote>
<p>Based on the work:
- Conditional: K. Zhang, J. Peters, D. Janzing, B. Schölkopf. <em>Kernel-based Conditional Independence Test and Application in Causal Discovery</em>. UAI’11, Pages 804–813, 2011.
- Pairwise: A. Gretton, K. Fukumizu, C.-H. Teo, L. Song, B. Schölkopf, A. Smola. <em>A Kernel Statistical Test of Independence</em>. NIPS 21, 2007.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Data matrix for observations from X.</p></li>
<li><p><strong>Y</strong> – Data matrix for observations from Y.</p></li>
<li><p><strong>Z</strong> – Optional data matrix for observations from Z. This is the conditional variable.</p></li>
<li><p><strong>kernel</strong> – A kernel for estimating the pairwise similarities between samples. The expected input is a n x d
numpy array and the output is expected to be a n x n numpy array. By default, the RBF kernel is used.</p></li>
<li><p><strong>scale_data</strong> – If set to True, the data will be standardized. If set to False, the data is taken as it is.
Standardizing the data helps in identifying weak dependencies. If one is only interested in
stronger ones, consider setting this to False.</p></li>
<li><p><strong>use_bootstrap</strong> – If True, the independence tests are performed on multiple subsets of the data and the final
p-value is constructed based on the provided p_value_adjust_func function.</p></li>
<li><p><strong>bootstrap_num_runs</strong> – Number of bootstrap runs (only relevant if use_bootstrap is True).</p></li>
<li><p><strong>bootstrap_num_samples_per_run</strong> – Number of samples used in a bootstrap run (only relevant if use_bootstrap is
True).</p></li>
<li><p><strong>bootstrap_n_jobs</strong> – Number of parallel jobs for the boostrap runs.</p></li>
<li><p><strong>p_value_adjust_func</strong> – A callable that expects a numpy array of multiple p-values and returns one p-value. This
is typically used a family wise error rate control method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The p-value for the null hypothesis that X and Y are independent (given Z).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.independence_test.kernel_operation">
<span id="dowhy-gcm-independence-test-kernel-operation-module"></span><h2>dowhy.gcm.independence_test.kernel_operation module<a class="headerlink" href="#module-dowhy.gcm.independence_test.kernel_operation" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.apply_delta_kernel">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">apply_delta_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#apply_delta_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.apply_delta_kernel" title="Permalink to this definition"></a></dt>
<dd><p>Applies the delta kernel, i.e. the distance is 1 if two entries are equal and 0 otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Input data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outcome of the delta-kernel, a binary distance matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">apply_rbf_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#apply_rbf_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the RBF (Gaussian) kernel for the given input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data.</p></li>
<li><p><strong>precision</strong> – Specific precision matrix for the RBF kernel. If None is given, this is inferred from the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outcome of applying a RBF (Gaussian) kernel on the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel_with_adaptive_precision">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">apply_rbf_kernel_with_adaptive_precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#apply_rbf_kernel_with_adaptive_precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel_with_adaptive_precision" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the RBF (Gaussian) kernel for the given input data. Here, each column is scaled by an individual
precision parameter which is automatically inferred from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Input data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outcome of applying a RBF (Gaussian) kernel on the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.approximate_delta_kernel_features">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">approximate_delta_kernel_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_random_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#approximate_delta_kernel_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.approximate_delta_kernel_features" title="Permalink to this definition"></a></dt>
<dd><p>Applies the Nystroem method to create a NxD (D &lt;&lt; N) approximated delta kernel map using a subset of the data,
where N is the number of samples in X and D the number of components. The delta kernel gives 1 if two entries are
equal and 0 otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data.</p></li>
<li><p><strong>num_random_components</strong> – Number of components D for the approximated kernel map.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A NxD approximated RBF kernel map, where N is the number of samples in X and D the number of components.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.approximate_rbf_kernel_features">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">approximate_rbf_kernel_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_random_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#approximate_rbf_kernel_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.approximate_rbf_kernel_features" title="Permalink to this definition"></a></dt>
<dd><p>Applies the Nystroem method to create a NxD (D &lt;&lt; N) approximated RBF kernel map using a subset of the data,
where N is the number of samples in X and D the number of components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data.</p></li>
<li><p><strong>num_random_components</strong> – Number of components D for the approximated kernel map.</p></li>
<li><p><strong>precision</strong> – Specific precision matrix for the RBF kernel. If None is given, this is inferred from the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A NxD approximated RBF kernel map, where N is the number of samples in X and D the number of components.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.auto_create_list_of_kernel_approximations">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">auto_create_list_of_kernel_approximations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#auto_create_list_of_kernel_approximations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.auto_create_list_of_kernel_approximations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.auto_create_list_of_kernels">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">auto_create_list_of_kernels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#auto_create_list_of_kernels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.auto_create_list_of_kernels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.independence_test.regression">
<span id="dowhy-gcm-independence-test-regression-module"></span><h2>dowhy.gcm.independence_test.regression module<a class="headerlink" href="#module-dowhy.gcm.independence_test.regression" title="Permalink to this heading"></a></h2>
<p>Regression based (conditional) independence test. Testing independence via regression, i.e. if a variable has
information about another variable, then they are dependent.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.regression.regression_based">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.regression.</span></span><span class="sig-name descname"><span class="pre">regression_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">X:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Y:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Z:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">num_components_all_inputs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">40,</span> <span class="pre">num_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20,</span> <span class="pre">p_value_adjust_func:</span> <span class="pre">~typing.Callable[[~typing.Union[~numpy.ndarray,</span> <span class="pre">~typing.List[float]]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">quantile_based_fwer&gt;,</span> <span class="pre">f_test_samples_ratio:</span> <span class="pre">~typing.Optional[float]</span> <span class="pre">=</span> <span class="pre">0.3,</span> <span class="pre">max_samples_per_run:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10000</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/regression.html#regression_based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.regression.regression_based" title="Permalink to this definition"></a></dt>
<dd><p>The main idea is that if X and Y are dependent, then X should help in predicting Y. If there is no dependency,
then X should not help. When Z is given, the idea remains the same, but here X and Y are conditionally independent
given Z if X does not help in predicting Y when knowing Z. This is, X has not additional information about Y given
Z. In the pairwise case (Z is not given), the performances (in terms of squared error) between predicting Y based
on X and predicting Y by returning its mean (the best estimator without any inputs) are compared. Note that
categorical inputs are transformed via the sklearn one-hot-encoder.</p>
<p>Here, we use the <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.kernel_approximation.Nystroem</span></code> approach to approximate a kernel map of the inputs that serves as new input features.
These new features allow to model complex non-linear relationships. In case of categorical data, we first apply an
one-hot-encoding and then map it into the kernel feature space. Afterwards, we use linear regression as a prediction
model based on the non-linear input features. The idea is then the same as in Granger causality, where we
apply a f-test to see if the additional input features significantly help in predicting the target or not.</p>
<p>Note: As compared to <code class="xref py py-func docutils literal notranslate"><span class="pre">kernel_based()</span></code>, this method is quite fast and provides reasonably well results. However, there
are types of dependencies that this test cannot detect. For instance, if X determines the variance of Y, then this
cannot be captured. For these more complex dependencies, consider using the <code class="xref py py-func docutils literal notranslate"><span class="pre">kernel_based()</span></code> independence test instead.</p>
<dl class="simple">
<dt>This test is motivated by Granger causality, the approx_kernel_based test and the following paper:</dt><dd><p>K Chalupka, P Perona, F. Eberhardt. <em>Fast Conditional Independence Test for Vector Variables with Large Sample Sizes</em>. arXiv:1804.02747, 2018.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data for X.</p></li>
<li><p><strong>Y</strong> – Input data for Y.</p></li>
<li><p><strong>Z</strong> – Input data for Z. The set of variables to (optionally) condition on.</p></li>
<li><p><strong>num_components_all_inputs</strong> – Number of kernel features when combining X and Z. If Z is not given, it will be
replaced with an empty array. If Z is given, half of the number is used to
generate features for Z.</p></li>
<li><p><strong>num_runs</strong> – Number of runs. This equals the number of estimated p-values, which get adjusted by the
p_value_adjust_func.</p></li>
<li><p><strong>p_value_adjust_func</strong> – A callable that expects a numpy array of multiple p-values and returns one p-value. This
is typically used a family wise error rate control method.</p></li>
<li><p><strong>f_test_samples_ratio</strong> – Ratio for splitting the data into test and training data sets for calculating
the f-statistic. A ratio of 0.3 means that 30% of the samples are used for the f-test (test samples) and 70% are
used for training the prediction model (training samples). If set to None, training and test data set are the same,
which could help in settings where only a few samples are available.</p></li>
<li><p><strong>max_samples_per_run</strong> – Maximum number of samples used per run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The p-value for the null hypothesis that X and Y are independent given Z. If Z is not given,
then for the hypothesis that X and Y are independent.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.independence_test">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dowhy.gcm.independence_test" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.independence_test">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.</span></span><span class="sig-name descname"><span class="pre">independence_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioned_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kernel'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/independence_test.html#independence_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.independence_test" title="Permalink to this definition"></a></dt>
<dd><p>Performs a (conditional) independence test.
Three methods for (conditional) independence test are supported at the moment:</p>
<ul class="simple">
<li><p><cite>kernel</cite>: Kernel-based (conditional) independence test.</p>
<ul>
<li><ol class="upperalpha simple" start="11">
<li><p>Zhang, J. Peters, D. Janzing, B. Schölkopf. <em>Kernel-based Conditional Independence Test and Application in Causal Discovery</em>. UAI’11, Pages 804–813, 2011.</p></li>
</ol>
</li>
<li><ol class="upperalpha simple">
<li><p>Gretton, K. Fukumizu, C.-H. Teo, L. Song, B. Schölkopf, A. Smola. <em>A Kernel Statistical Test of Independence</em>. NIPS 21, 2007.</p></li>
</ol>
</li>
</ul>
</li>
<li><p><cite>approx_kernel</cite>: Approximate kernel-based (conditional) independence test.</p>
<ul>
<li><ol class="upperalpha simple" start="5">
<li><p>Strobl, K. Zhang, S. Visweswaran. <em>Approximate kernel-based conditional independence tests for fast non-parametric causal discovery</em>. Journal of Causal Inference, 2019.</p></li>
</ol>
</li>
</ul>
</li>
<li><p><cite>regression</cite>: Regression based (conditional) independence test using a f-test. See <code class="xref py py-func docutils literal notranslate"><span class="pre">regression_based()</span></code> for more details.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Observations of X.</p></li>
<li><p><strong>Y</strong> – Observations of Y.</p></li>
<li><p><strong>conditioned_on</strong> – Observations of conditioning variable if we want to perform a conditional independence test. By default, independence test is carried out.</p></li>
<li><p><strong>method</strong> – Method for conditional independence test. The choices are:
<cite>kernel</cite> (default): <code class="xref py py-func docutils literal notranslate"><span class="pre">kernel_based()</span></code> (conditional) independence test.
<cite>approx_kernel</cite>: <code class="xref py py-func docutils literal notranslate"><span class="pre">approx_kernel_based()</span></code> (conditional) independence test.
<cite>regression</cite>: <code class="xref py py-func docutils literal notranslate"><span class="pre">regression_based()</span></code> (conditional) independence test.
For more information about these methods, see above.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>p-value of the (conditional) independence test. (Conditional) Independence is the null hypothesis.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="dowhy.gcm.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">dowhy.gcm package</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="dowhy.gcm.ml.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">dowhy.gcm.ml package</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PyWhy contributors.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>
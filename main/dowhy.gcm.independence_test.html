
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-B139P18WHM');
    </script>
    
    <title>dowhy.gcm.independence_test package &#8212; DoWhy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=949a1ff5" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=0c6e27e1"></script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dowhy.gcm.independence_test';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dowhy.gcm.ml package" href="dowhy.gcm.ml.html" />
    <link rel="prev" title="dowhy.gcm package" href="dowhy.gcm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="main" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/dowhy-logo-small.png" class="logo__image only-light" alt="DoWhy  documentation - Home"/>
    <img src="_static/dowhy-logo-small.png" class="logo__image only-dark pst-js-only" alt="DoWhy  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="example_notebooks/nb_index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="cite.html">
    Citing this package
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributing.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="dowhy.html">
    dowhy package
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="code_repo.html">
    Release notes
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <dd><a href="/dowhy/v0.9.1/index.html">v0.9.1</a></dd>
            <dd><a href="/dowhy/v0.9/index.html">v0.9</a></dd>
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.13/index.html">v0.13</a></dd>
            <dd><a href="/dowhy/v0.12/index.html">v0.12</a></dd>
            <dd><a href="/dowhy/v0.11.1/index.html">v0.11.1</a></dd>
            <dd><a href="/dowhy/v0.11/index.html">v0.11</a></dd>
            <dd><a href="/dowhy/v0.10.1/index.html">v0.10.1</a></dd>
            <dd><a href="/dowhy/v0.10/index.html">v0.10</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
        </dl>        
        <dl>
            <dt>Branches</dt>
            <dd><a href="">main</a></dd>
        </dl>        
    </div>
</div></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="example_notebooks/nb_index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="cite.html">
    Citing this package
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="dowhy.html">
    dowhy package
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="code_repo.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <dd><a href="/dowhy/v0.9.1/index.html">v0.9.1</a></dd>
            <dd><a href="/dowhy/v0.9/index.html">v0.9</a></dd>
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.13/index.html">v0.13</a></dd>
            <dd><a href="/dowhy/v0.12/index.html">v0.12</a></dd>
            <dd><a href="/dowhy/v0.11.1/index.html">v0.11.1</a></dd>
            <dd><a href="/dowhy/v0.11/index.html">v0.11</a></dd>
            <dd><a href="/dowhy/v0.10.1/index.html">v0.10.1</a></dd>
            <dd><a href="/dowhy/v0.10/index.html">v0.10</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
        </dl>        
        <dl>
            <dt>Branches</dt>
            <dd><a href="">main</a></dd>
        </dl>        
    </div>
</div></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dowhy.api.html">dowhy.api package</a></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.causal_estimators.html">dowhy.causal_estimators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.causal_identifier.html">dowhy.causal_identifier package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dowhy.causal_prediction.html">dowhy.causal_prediction package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.causal_prediction.algorithms.html">dowhy.causal_prediction.algorithms package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.causal_prediction.dataloaders.html">dowhy.causal_prediction.dataloaders package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.causal_prediction.datasets.html">dowhy.causal_prediction.datasets package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.causal_prediction.models.html">dowhy.causal_prediction.models package</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dowhy.causal_refuters.html">dowhy.causal_refuters package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="dowhy.causal_refuters.overrule.html">dowhy.causal_refuters.overrule package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="dowhy.causal_refuters.overrule.BCS.html">dowhy.causal_refuters.overrule.BCS package</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.data_transformers.html">dowhy.data_transformers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.do_samplers.html">dowhy.do_samplers package</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="dowhy.gcm.html">dowhy.gcm package</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">dowhy.gcm.independence_test package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html">dowhy.gcm.ml package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html">dowhy.gcm.util package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.graph_learners.html">dowhy.graph_learners package</a></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.interpreters.html">dowhy.interpreters package</a></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.utils.html">dowhy.utils package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="dowhy.html" class="nav-link">dowhy package</a></li>
    
    
    <li class="breadcrumb-item"><a href="dowhy.gcm.html" class="nav-link">dowhy.gcm package</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">dowhy.gcm.independence_test package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="dowhy-gcm-independence-test-package">
<h1>dowhy.gcm.independence_test package<a class="headerlink" href="#dowhy-gcm-independence-test-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-dowhy.gcm.independence_test.generalised_cov_measure">
<span id="dowhy-gcm-independence-test-generalised-cov-measure-module"></span><h2>dowhy.gcm.independence_test.generalised_cov_measure module<a class="headerlink" href="#module-dowhy.gcm.independence_test.generalised_cov_measure" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.generalised_cov_measure.generalised_cov_based">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.generalised_cov_measure.</span></span><span class="sig-name descname"><span class="pre">generalised_cov_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_model_X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.html#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AssignmentQuality.BETTER</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_model_Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dowhy.gcm.html#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="dowhy.gcm.ml.html#dowhy.gcm.ml.prediction_model.PredictionModel" title="dowhy.gcm.ml.prediction_model.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AssignmentQuality.BETTER</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/generalised_cov_measure.html#generalised_cov_based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.generalised_cov_measure.generalised_cov_based" title="Link to this definition">#</a></dt>
<dd><p>(Conditional) independence test based on the Generalised Covariance Measure.</p>
<p>Note:
- Currently, only univariate and continuous X and Y are supported.
- Residuals are based on the training data.
- The relationships need to be non-deterministic, i.e., the residuals cannot be constant!</p>
<p>See
- R. D. Shah and J Peters. <em>The hardness of conditional independence testing and the generalised covariance measure</em>, The Annals of Statistics 48(3), 2018
for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Data matrix for observations from X.</p></li>
<li><p><strong>Y</strong> – Data matrix for observations from Y.</p></li>
<li><p><strong>Z</strong> – Optional data matrix for observations from Z. This is the conditional variable.</p></li>
<li><p><strong>prediction_model_X</strong> – Either a model class that will be used as prediction model for regressing X on Z
(e.g., a linear regressor) or an AssignmentQuality for automatically selecting
a model.</p></li>
<li><p><strong>prediction_model_Y</strong> – Either a model class that will be used as prediction model for regressing X on Z
(e.g., a linear regressor) or an AssignmentQuality for automatically selecting
a model.</p></li>
</ul>
</dd>
</dl>
<p>:return The p-value for the null hypothesis that X and Y are independent (given Z).</p>
</dd></dl>

</section>
<section id="module-dowhy.gcm.independence_test.kernel">
<span id="dowhy-gcm-independence-test-kernel-module"></span><h2>dowhy.gcm.independence_test.kernel module<a class="headerlink" href="#module-dowhy.gcm.independence_test.kernel" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel.approx_kernel_based">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel.</span></span><span class="sig-name descname"><span class="pre">approx_kernel_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">X:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Y:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Z:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">num_random_features_X:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">50,</span> <span class="pre">num_random_features_Y:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">50,</span> <span class="pre">num_random_features_Z:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">50,</span> <span class="pre">num_permutations:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100,</span> <span class="pre">approx_kernel:</span> <span class="pre">~typing.Callable[[~numpy.ndarray],</span> <span class="pre">~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">approximate_rbf_kernel_features&gt;,</span> <span class="pre">scale_data:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">use_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">bootstrap_num_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">bootstrap_num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000,</span> <span class="pre">bootstrap_n_jobs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">p_value_adjust_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">~typing.List[float]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">merge_p_values_average&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel.html#approx_kernel_based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel.approx_kernel_based" title="Link to this definition">#</a></dt>
<dd><p>Implementation of the Randomized Conditional Independence Test. The independence test estimates a p-value
for the null hypothesis that X and Y are independent (given Z). Depending whether Z is given, a conditional or
pairwise independence test is performed.</p>
<p>If Z is given: Using RCIT as conditional independence test.
If Z is not given: Using RIT as pairwise independence test.</p>
<p>Note:
- The data can be multivariate, i.e. the given input matrices can have multiple columns.
- Categorical data need to be represented as strings.
- It is possible to apply a different kernel to each column in the matrices. For instance, a RBF kernel for the</p>
<blockquote>
<div><p>first dimension in X and a delta kernel for the second.</p>
</div></blockquote>
<dl class="simple">
<dt>Based on the work:</dt><dd><p>Strobl, Eric V., Kun Zhang, and Shyam Visweswaran.
Approximate kernel-based conditional independence tests for fast non-parametric causal discovery.
Journal of Causal Inference 7.1 (2019).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Data matrix for observations from X.</p></li>
<li><p><strong>Y</strong> – Data matrix for observations from Y.</p></li>
<li><p><strong>Z</strong> – Optional data matrix for observations from Z. This is the conditional variable.</p></li>
<li><p><strong>num_random_features_X</strong> – Number of features sampled from the approximated kernel map for X.</p></li>
<li><p><strong>num_random_features_Y</strong> – Number of features sampled from the approximated kernel map for Y.</p></li>
<li><p><strong>num_random_features_Z</strong> – Number of features sampled from the approximated kernel map for Z.</p></li>
<li><p><strong>num_permutations</strong> – Number of permutations for estimating the test test statistic.</p></li>
<li><p><strong>approx_kernel</strong> – The approximated kernel map. The expected input is a n x d numpy array and the output is
expected to be a n x k numpy array with k &lt;&lt; d. By default, the Nystroem method with a RBF
kernel is used.</p></li>
<li><p><strong>scale_data</strong> – If set to True, the data will be standardized. If set to False, the data is taken as it is.
Standardizing the data helps in identifying weak dependencies. If one is only interested in
stronger ones, consider setting this to False.</p></li>
<li><p><strong>use_bootstrap</strong> – If True, the independence tests are performed on multiple subsets of the data and the final
p-value is constructed based on the provided p_value_adjust_func function.</p></li>
<li><p><strong>bootstrap_num_runs</strong> – Number of bootstrap runs (only relevant if use_bootstrap is True).</p></li>
<li><p><strong>bootstrap_num_samples</strong> – Maximum number of used samples per bootstrap run.</p></li>
<li><p><strong>bootstrap_n_jobs</strong> – Number of parallel jobs for the bootstrap runs.</p></li>
<li><p><strong>p_value_adjust_func</strong> – A callable that expects a numpy array of multiple p-values and returns one p-value. This
is typically used a family wise error rate control method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The p-value for the null hypothesis that X and Y are independent (given Z).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel.kernel_based">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel.</span></span><span class="sig-name descname"><span class="pre">kernel_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">X:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Y:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Z:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">use_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">bootstrap_num_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">max_num_samples_run:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">bootstrap_n_jobs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">p_value_adjust_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">~typing.List[float]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">merge_p_values_average&gt;,</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel.html#kernel_based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel.kernel_based" title="Link to this definition">#</a></dt>
<dd><p>Prepares the data and uses kernel (conditional) independence test. The independence test estimates a p-value
for the null hypothesis that X and Y are independent (given Z). Depending whether Z is given, a conditional or
pairwise independence test is performed.</p>
<p>Here, we utilize the implementations of the <a class="github reference external" href="https://github.com/cmu-phil/causal-learn">cmu-phil/causal-learn</a> package.</p>
<p>If Z is given: Using KCI as conditional independence test, i.e. we use <a class="github reference external" href="https://github.com/cmu-phil/causal-learn/blob/main/causallearn/utils/KCI/KCI.py#L238">cmu-phil/causal-learn</a>.
If Z is not given: Using KCI as pairwise independence test, i.e. we use <a class="github reference external" href="https://github.com/cmu-phil/causal-learn/blob/main/causallearn/utils/KCI/KCI.py#L17">cmu-phil/causal-learn</a>.</p>
<p>Note:
- The data can be multivariate, i.e. the given input matrices can have multiple columns.
- Categorical data need to be represented as strings.</p>
<p>Based on the work:
- K. Zhang, J. Peters, D. Janzing, B. Schölkopf. <em>Kernel-based Conditional Independence Test and Application in Causal Discovery</em>. UAI’11, Pages 804–813, 2011.
- A. Gretton, K. Fukumizu, C.-H. Teo, L. Song, B. Schölkopf, A. Smola. <em>A Kernel Statistical Test of Independence</em>. NIPS 21, 2007.</p>
<p>For more information about configuring the kernel independence test, see:
- <a class="github reference external" href="https://github.com/cmu-phil/causal-learn/blob/main/causallearn/utils/KCI/KCI.py#L17">cmu-phil/causal-learn</a> (if Z is not given)
- <a class="github reference external" href="https://github.com/cmu-phil/causal-learn/blob/main/causallearn/utils/KCI/KCI.py#L238">cmu-phil/causal-learn</a> (if Z is given)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Data matrix for observations from X.</p></li>
<li><p><strong>Y</strong> – Data matrix for observations from Y.</p></li>
<li><p><strong>Z</strong> – Optional data matrix for observations from Z. This is the conditional variable.</p></li>
<li><p><strong>use_bootstrap</strong> – If True, the independence tests are performed on multiple subsets of the data and the final
p-value is constructed based on the provided p_value_adjust_func function.</p></li>
<li><p><strong>bootstrap_num_runs</strong> – Number of bootstrap runs (only relevant if use_bootstrap is True).</p></li>
<li><p><strong>max_num_samples_run</strong> – Maximum number of samples used in an evaluation. If use_bootstrap is True, then
different samples but at most max_num_samples_run are used.</p></li>
<li><p><strong>bootstrap_n_jobs</strong> – Number of parallel jobs for the bootstrap runs.</p></li>
<li><p><strong>p_value_adjust_func</strong> – A callable that expects a numpy array of multiple p-values and returns one p-value. This
is typically used a family wise error rate control method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The p-value for the null hypothesis that X and Y are independent (given Z).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.independence_test.kernel_operation">
<span id="dowhy-gcm-independence-test-kernel-operation-module"></span><h2>dowhy.gcm.independence_test.kernel_operation module<a class="headerlink" href="#module-dowhy.gcm.independence_test.kernel_operation" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.apply_delta_kernel">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">apply_delta_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#apply_delta_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.apply_delta_kernel" title="Link to this definition">#</a></dt>
<dd><p>Applies the delta kernel, i.e. the distance is 1 if two entries are equal and 0 otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The outcome of the delta-kernel, a binary distance matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">apply_rbf_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#apply_rbf_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel" title="Link to this definition">#</a></dt>
<dd><p>Estimates the RBF (Gaussian) kernel for the given input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data.</p></li>
<li><p><strong>precision</strong> – Specific precision matrix for the RBF kernel. If None is given, this is inferred from the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The outcome of applying a RBF (Gaussian) kernel on the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel_with_adaptive_precision">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">apply_rbf_kernel_with_adaptive_precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#apply_rbf_kernel_with_adaptive_precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel_with_adaptive_precision" title="Link to this definition">#</a></dt>
<dd><p>Estimates the RBF (Gaussian) kernel for the given input data. Here, each column is scaled by an individual
precision parameter which is automatically inferred from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The outcome of applying a RBF (Gaussian) kernel on the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.approximate_delta_kernel_features">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">approximate_delta_kernel_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_random_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#approximate_delta_kernel_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.approximate_delta_kernel_features" title="Link to this definition">#</a></dt>
<dd><p>Applies the Nystroem method to create a NxD (D &lt;&lt; N) approximated delta kernel map using a subset of the data,
where N is the number of samples in X and D the number of components. The delta kernel gives 1 if two entries are
equal and 0 otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data.</p></li>
<li><p><strong>num_random_components</strong> – Number of components D for the approximated kernel map.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NxD approximated RBF kernel map, where N is the number of samples in X and D the number of components.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.kernel_operation.approximate_rbf_kernel_features">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.kernel_operation.</span></span><span class="sig-name descname"><span class="pre">approximate_rbf_kernel_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_random_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/kernel_operation.html#approximate_rbf_kernel_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.kernel_operation.approximate_rbf_kernel_features" title="Link to this definition">#</a></dt>
<dd><p>Applies the Nystroem method to create a NxD (D &lt;&lt; N) approximated RBF kernel map using a subset of the data,
where N is the number of samples in X and D the number of components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data.</p></li>
<li><p><strong>num_random_components</strong> – Number of components D for the approximated kernel map.</p></li>
<li><p><strong>precision</strong> – Specific precision matrix for the RBF kernel. If None is given, this is inferred from the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NxD approximated RBF kernel map, where N is the number of samples in X and D the number of components.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.independence_test.regression">
<span id="dowhy-gcm-independence-test-regression-module"></span><h2>dowhy.gcm.independence_test.regression module<a class="headerlink" href="#module-dowhy.gcm.independence_test.regression" title="Link to this heading">#</a></h2>
<p>Regression based (conditional) independence test. Testing independence via regression, i.e. if a variable has
information about another variable, then they are dependent.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.regression.regression_based">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.regression.</span></span><span class="sig-name descname"><span class="pre">regression_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">X:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Y:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">Z:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">max_num_components_all_inputs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">40,</span> <span class="pre">k_folds:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">p_value_adjust_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">~typing.List[float]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">merge_p_values_average&gt;,</span> <span class="pre">max_samples_per_fold:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">-1,</span> <span class="pre">n_jobs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/independence_test/regression.html#regression_based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.regression.regression_based" title="Link to this definition">#</a></dt>
<dd><p>The main idea is that if X and Y are dependent, then X should help in predicting Y. If there is no dependency,
then X should not help. When Z is given, the idea remains the same, but here X and Y are conditionally independent
given Z if X does not help in predicting Y when knowing Z. This is, X has not additional information about Y given
Z. In the pairwise case (Z is not given), the performances (in terms of squared error) between predicting Y based
on X and predicting Y by returning its mean (the best estimator without any inputs) are compared. Note that
categorical inputs are transformed via encoders.</p>
<p>Here, we use the <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.kernel_approximation.Nystroem</span></code> approach to approximate a kernel map of the inputs that serves as new input features.
These new features allow to model complex non-linear relationships. In case of categorical data, we first apply an
encoding and then map it into the kernel feature space. Afterwards, we use linear regression as a prediction
model based on the non-linear input features. The idea is then to apply a f-test to see if the additional input
features significantly help in predicting the target or not.</p>
<dl class="simple">
<dt>This test is motivated by Granger causality, the approx_kernel_based test and the following paper:</dt><dd><p>K Chalupka, P Perona, F. Eberhardt. <em>Fast Conditional Independence Test for Vector Variables with Large Sample Sizes</em>. arXiv:1804.02747, 2018.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data for X.</p></li>
<li><p><strong>Y</strong> – Input data for Y.</p></li>
<li><p><strong>Z</strong> – Input data for Z. The set of variables to (optionally) condition on.</p></li>
<li><p><strong>max_num_components_all_inputs</strong> – Maximum number of kernel features when combining X and Z. If Z is not given, it will be
replaced with an empty array. If Z is given, half of the number is used to
generate features for Z. Note that the actual number of components is 1/10 of the
number of samples, but at most max_num_components_all_inputs.</p></li>
<li><p><strong>num_target_components_factor</strong> – The factor indicates how many components are used for the target variable. This is,
num_target_components_factor * dimension of the target many components.</p></li>
<li><p><strong>k_folds</strong> – Number of folds for training and test set. This equals the number of estimated p-values, which get adjusted by the
p_value_adjust_func.</p></li>
<li><p><strong>p_value_adjust_func</strong> – A callable that expects a numpy array of multiple p-values and returns one p-value. This
is typically used a family wise error rate control method.</p></li>
<li><p><strong>max_samples_per_fold</strong> – Maximum number of samples used per fold for training and testing. If -1, it uses all data.</p></li>
<li><p><strong>n_jobs</strong> – Number of parallel jobs for the evaluation of the folds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The p-value for the null hypothesis that X and Y are independent given Z. If Z is not given,
then for the hypothesis that X and Y are independent.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.independence_test">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dowhy.gcm.independence_test" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.independence_test.independence_test">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.independence_test.</span></span><span class="sig-name descname"><span class="pre">independence_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioned_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kernel'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/independence_test.html#independence_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.independence_test.independence_test" title="Link to this definition">#</a></dt>
<dd><p>Performs a (conditional) independence test.
Three methods for (conditional) independence test are supported at the moment:</p>
<ul>
<li><p><cite>kernel</cite>: Kernel-based (conditional) independence test.</p>
<ul class="simple">
<li><ol class="upperalpha simple" start="11">
<li><p>Zhang, J. Peters, D. Janzing, B. Schölkopf. <em>Kernel-based Conditional Independence Test and Application in Causal Discovery</em>. UAI’11, Pages 804–813, 2011.</p></li>
</ol>
</li>
<li><ol class="upperalpha simple">
<li><p>Gretton, K. Fukumizu, C.-H. Teo, L. Song, B. Schölkopf, A. Smola. <em>A Kernel Statistical Test of Independence</em>. NIPS 21, 2007.</p></li>
</ol>
</li>
</ul>
<p>Here, we utilize the implementations of the <a class="github reference external" href="https://github.com/cmu-phil/causal-learn">cmu-phil/causal-learn</a> package.</p>
</li>
<li><p><cite>approx_kernel</cite>: Approximate kernel-based (conditional) independence test.</p>
<ul class="simple">
<li><ol class="upperalpha simple" start="5">
<li><p>Strobl, K. Zhang, S. Visweswaran. <em>Approximate kernel-based conditional independence tests for fast non-parametric causal discovery</em>. Journal of Causal Inference, 2019.</p></li>
</ol>
</li>
</ul>
</li>
<li><p><cite>regression</cite>: Regression based (conditional) independence test using a f-test. See <code class="xref py py-func docutils literal notranslate"><span class="pre">regression_based()</span></code> for more details.</p></li>
<li><p><cite>gcm</cite>: (Conditional) independence test based on the Generalised Covariance Measure. See <code class="xref py py-func docutils literal notranslate"><span class="pre">generalised_cov_based()</span></code> for more details.</p>
<blockquote>
<div><ul class="simple">
<li><ol class="upperalpha simple" start="18">
<li><ol class="upperalpha simple" start="4">
<li><p>Shah and J Peters. <em>The hardness of conditional independence testing and the generalised covariance measure</em>, The Annals of Statistics 48(3), 2018</p></li>
</ol>
</li>
</ol>
</li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Observations of X.</p></li>
<li><p><strong>Y</strong> – Observations of Y.</p></li>
<li><p><strong>conditioned_on</strong> – Observations of conditioning variable if we want to perform a conditional independence test. By default, independence test is carried out.</p></li>
<li><p><strong>method</strong> – Method for conditional independence test. The choices are:
<cite>kernel</cite> (default): <code class="xref py py-func docutils literal notranslate"><span class="pre">kernel_based()</span></code> (conditional) independence test.
<cite>approx_kernel</cite>: <code class="xref py py-func docutils literal notranslate"><span class="pre">approx_kernel_based()</span></code> (conditional) independence test.
<cite>regression</cite>: <code class="xref py py-func docutils literal notranslate"><span class="pre">regression_based()</span></code> (conditional) independence test.
<cite>gcm</cite>: <code class="xref py py-func docutils literal notranslate"><span class="pre">generalised_cov_based()</span></code> (conditional) independence test.
For more information about these methods, see above.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>p-value of the (conditional) independence test. (Conditional) Independence is the null hypothesis.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dowhy.gcm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">dowhy.gcm package</p>
      </div>
    </a>
    <a class="right-next"
       href="dowhy.gcm.ml.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">dowhy.gcm.ml package</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test.generalised_cov_measure">dowhy.gcm.independence_test.generalised_cov_measure module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.generalised_cov_measure.generalised_cov_based"><code class="docutils literal notranslate"><span class="pre">generalised_cov_based()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test.kernel">dowhy.gcm.independence_test.kernel module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.kernel.approx_kernel_based"><code class="docutils literal notranslate"><span class="pre">approx_kernel_based()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.kernel.kernel_based"><code class="docutils literal notranslate"><span class="pre">kernel_based()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test.kernel_operation">dowhy.gcm.independence_test.kernel_operation module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.kernel_operation.apply_delta_kernel"><code class="docutils literal notranslate"><span class="pre">apply_delta_kernel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel"><code class="docutils literal notranslate"><span class="pre">apply_rbf_kernel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.kernel_operation.apply_rbf_kernel_with_adaptive_precision"><code class="docutils literal notranslate"><span class="pre">apply_rbf_kernel_with_adaptive_precision()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.kernel_operation.approximate_delta_kernel_features"><code class="docutils literal notranslate"><span class="pre">approximate_delta_kernel_features()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.kernel_operation.approximate_rbf_kernel_features"><code class="docutils literal notranslate"><span class="pre">approximate_rbf_kernel_features()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test.regression">dowhy.gcm.independence_test.regression module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.regression.regression_based"><code class="docutils literal notranslate"><span class="pre">regression_based()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dowhy.gcm.independence_test">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dowhy.gcm.independence_test.independence_test"><code class="docutils literal notranslate"><span class="pre">independence_test()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/dowhy.gcm.independence_test.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022, PyWhy contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-B139P18WHM');
    </script>
    
    <title>Customizing Causal Mechanism Assignment &#8212; DoWhy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=949a1ff5" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=0c6e27e1"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/modeling_gcm/customizing_model_assignment';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Estimating Confidence Intervals" href="estimating_confidence_intervals.html" />
    <link rel="prev" title="Evaluate a GCM" href="model_evaluation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/dowhy-logo-small.png" class="logo__image only-light" alt="DoWhy  documentation - Home"/>
    <script>document.write(`<img src="../../_static/dowhy-logo-small.png" class="logo__image only-dark" alt="DoWhy  documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../example_notebooks/nb_index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dowhy.html">
                        dowhy package
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing.html">
                        Contributing
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../code_repo.html">
                        Release notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../cite.html">
                        Citing this package
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <dd><a href="/dowhy/v0.9.1/index.html">v0.9.1</a></dd>
            <dd><a href="/dowhy/v0.9/index.html">v0.9</a></dd>
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.11.1/index.html">v0.11.1</a></dd>
            <dd><a href="/dowhy/v0.11/index.html">v0.11</a></dd>
            <dd><a href="/dowhy/v0.10.1/index.html">v0.10.1</a></dd>
            <dd><a href="/dowhy/v0.10/index.html">v0.10</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
        </dl>        
        <dl>
            <dt>Branches</dt>
            <dd><a href="">main</a></dd>
        </dl>        
    </div>
</div></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../example_notebooks/nb_index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dowhy.html">
                        dowhy package
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing.html">
                        Contributing
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../code_repo.html">
                        Release notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../cite.html">
                        Citing this package
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <dd><a href="/dowhy/v0.9.1/index.html">v0.9.1</a></dd>
            <dd><a href="/dowhy/v0.9/index.html">v0.9</a></dd>
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.11.1/index.html">v0.11.1</a></dd>
            <dd><a href="/dowhy/v0.11/index.html">v0.11</a></dd>
            <dd><a href="/dowhy/v0.10.1/index.html">v0.10.1</a></dd>
            <dd><a href="/dowhy/v0.10/index.html">v0.10</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
        </dl>        
        <dl>
            <dt>Branches</dt>
            <dd><a href="">main</a></dd>
        </dl>        
    </div>
</div></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../foreword.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction to DoWhy</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modeling_causal_relations/index.html">Modeling Causal Relations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modeling_causal_relations/specifying_causal_graph.html">Specifying a causal graph using domain knowledge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modeling_causal_relations/learning_causal_structure.html">Learning causal structure from data</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../modeling_causal_relations/refuting_causal_graph/index.html">Refuting a Causal Graph</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../modeling_causal_relations/refuting_causal_graph/independence_tests.html">Performing independence tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modeling_causal_relations/refuting_causal_graph/refute_causal_structure.html">Graph refutations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Modeling Graphical Causal Models (GCMs)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="graphical_causal_model_types.html">Types of graphical causal models</a></li>
<li class="toctree-l2"><a class="reference internal" href="draw_samples.html">Generate samples from a GCM</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_evaluation.html">Evaluate a GCM</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Customizing Causal Mechanism Assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimating_confidence_intervals.html">Estimating Confidence Intervals</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../causal_tasks/index.html">Performing Causal Tasks</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/index.html">Estimating Causal Effects</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/identifying_causal_effect/index.html">Identifying causal effect</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/identifying_causal_effect/backdoor.html">Backdoor criterion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/identifying_causal_effect/frontdoor.html">Frontdoor criterion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/identifying_causal_effect/instrumental_variable.html">Natural experiments and instrumental variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/identifying_causal_effect/id_algorithm.html">ID algorithm for discovering new identification strategies</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/effect_estimation_with_backdoor/index.html">Estimating average causal effect using backdoor</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/effect_estimation_with_backdoor/regression_based_methods.html">Regression-based methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/effect_estimation_with_backdoor/distance_matching.html">Distance-based matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/effect_estimation_with_backdoor/propensity_based_methods.html">Propensity-based methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/effect_estimation_with_backdoor/do_sampler.html">Do-sampler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/effect_estimation_with_natural_experiments/index.html">Estimating average causal effect with natural experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/conditional_effect_estimation/index.html">Estimating conditional average causal effect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/estimating_causal_effects/effect_estimation_with_gcm.html">Estimating average causal effect using GCM</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../causal_tasks/quantify_causal_influence/index.html">Quantify Causal Influence</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/quantify_causal_influence/mediation_analysis.html">Mediation Analysis: Estimating natural direct and indirect effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/quantify_causal_influence/quantify_arrow_strength.html">Direct Effect: Quantifying Arrow Strength</a></li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/quantify_causal_influence/icc.html">Quantifying Intrinsic Causal Influence</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../causal_tasks/root_causing_and_explaining/index.html">Root-Cause Analysis and Explanation</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/root_causing_and_explaining/anomaly_attribution.html">Anomaly Attribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/root_causing_and_explaining/distribution_change.html">Attributing Distributional Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/root_causing_and_explaining/feature_relevance.html">Feature Relevance</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../causal_tasks/what_if/index.html">Asking and Answering What-If Questions</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/what_if/interventions.html">Simulating the Impact of Interventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../causal_tasks/what_if/counterfactuals.html">Computing Counterfactuals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../causal_tasks/causal_prediction/index.html">Predicting outcome for out-of-distribution inputs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../refuting_causal_estimates/index.html">Refuting causal estimates</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/index.html">Refuting Effect Estimates</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/placebo_treatment.html">Placebo Treatment Refuter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/dummy_outcome.html">Dummy Outcome Refuter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/random_common_cause.html">Random Common Cause Refuter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/data_subsample.html">Data Subsample Refuter</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/sensitivity_analysis/index.html">Sensitivity Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/sensitivity_analysis/simulation_based.html">Simulation-based sensitivity analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/sensitivity_analysis/linear_partialr2.html">Partial-R2 based sensitivity analysis for linear estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../refuting_causal_estimates/refuting_effect_estimates/sensitivity_analysis/nonlinear_reisz.html">Reisz estimator-based sensitivity analysis for non-linear estimators</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Citing this package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Modeling Graphical Causal Models (GCMs)</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Customizing...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="customizing-causal-mechanism-assignment">
<h1>Customizing Causal Mechanism Assignment<a class="headerlink" href="#customizing-causal-mechanism-assignment" title="Permalink to this heading">#</a></h1>
<p>In GCM-based inference, fitting means, we learn the generative model of the variables in the graph from
data. Before we can fit the variables to data, each node in a causal graph requires a
generative causal model, or a “causal mechanism”. In this section, we’ll dive deeper into how to use
this feature.</p>
<p>To understand this, let’s pull up the mental model for a probabilistic causal model (PCM) again:</p>
<a class="reference internal image-reference" href="../../_images/pcm.png"><img alt="Mental model for causal models" src="../../_images/pcm.png" style="width: 80%;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>On the left, it shows a trivial causal graph <span class="math notranslate nohighlight">\(X \rightarrow Y\)</span>. <span class="math notranslate nohighlight">\(X\)</span> is a so-called root
node (it has no parents), <span class="math notranslate nohighlight">\(Y\)</span> is a non-root node (it <em>has</em> parents). We fundamentally
distinguish between these two types of nodes.</p>
<p>For root nodes such as <span class="math notranslate nohighlight">\(X\)</span>, the distribution <span class="math notranslate nohighlight">\(P_x\)</span> is modeled using a stochastic model.
Non-root nodes such as <span class="math notranslate nohighlight">\(Y\)</span> are modelled using a <em>conditional</em> stochastic model. DoWhy’s gcm package
defines corresponding interfaces for both, namely <a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a> and
<a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel" title="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
<p>The gcm package also provides ready-to-use implementations, such as <a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.stochastic_models.ScipyDistribution" title="dowhy.gcm.stochastic_models.ScipyDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScipyDistribution</span></code></a>
or <a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution" title="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianGaussianMixtureDistribution</span></code></a> for
<a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.causal_mechanisms.StochasticModel" title="dowhy.gcm.causal_mechanisms.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, and <a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.causal_mechanisms.AdditiveNoiseModel" title="dowhy.gcm.causal_mechanisms.AdditiveNoiseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdditiveNoiseModel</span></code></a> for
<a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.causal_mechanisms.ConditionalStochasticModel" title="dowhy.gcm.causal_mechanisms.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
<p>Knowing that, we can now start to manually assign causal models to nodes according to our needs.
Say, we know from domain knowledge, that our root node X follows a normal distribution. In this
case, we can explicitly assign this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dowhy</span> <span class="kn">import</span> <span class="n">gcm</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span> <span class="o">=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">ProbabilisticCausalModel</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">ScipyDistribution</span><span class="p">(</span><span class="n">norm</span><span class="p">))</span>
</pre></div>
</div>
<p>For the non-root node Y, let’s use an additive noise model (ANM), represented by the
<a class="reference internal" href="../../dowhy.gcm.html#dowhy.gcm.causal_mechanisms.AdditiveNoiseModel" title="dowhy.gcm.causal_mechanisms.AdditiveNoiseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdditiveNoiseModel</span></code></a> class. It has a
structural assignment of the form: <span class="math notranslate nohighlight">\(Y := f(X) + N\)</span>. Here, <span class="math notranslate nohighlight">\(f\)</span> is a deterministic prediction
function, whereas <span class="math notranslate nohighlight">\(N\)</span> is a noise term. Let’s put all of this together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="n">gcm</span><span class="o">.</span><span class="n">AdditiveNoiseModel</span><span class="p">(</span><span class="n">prediction_model</span><span class="o">=</span><span class="n">gcm</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">create_linear_regressor</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>                                                         <span class="n">noise_model</span><span class="o">=</span><span class="n">gcm</span><span class="o">.</span><span class="n">ScipyDistribution</span><span class="p">(</span><span class="n">norm</span><span class="p">)))</span>
</pre></div>
</div>
<p>The rather interesting part here is the <code class="docutils literal notranslate"><span class="pre">prediction_model</span></code>, which corresponds to our function
<span class="math notranslate nohighlight">\(f\)</span> above. This prediction model must satisfy the contract defined by
<code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionModel</span></code>, i.e. it must implement the methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>
<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>This interface is very analogous to model interfaces in many machine learning libraries, such as
<a class="reference external" href="https://scikit-learn.org">Scikit Learn</a>. In fact, the gcm package provides multiple adapter classes to
make libraries such as Scikit Learn interoperable.</p>
<p>Now that we have associated a data-generating process to each node in the causal graph, let us
prepare the training data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally, we can learn the parameters of those causal models from the training data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">causal_model</span></code> is now ready to be used for various types of causal queries as explained in
<a class="reference internal" href="../causal_tasks/index.html"><span class="doc">Performing Causal Tasks</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As mentioned above, DoWhy has a wrapper class that supports scikit learn models out of the box. For instance</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">AdditiveNoiseModel</span><span class="p">(</span><span class="n">gcm</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">SklearnRegressionModel</span><span class="p">(</span><span class="n">RandomForestRegressor</span><span class="p">)))</span>
</pre></div>
</div>
<p>would use a RandomForestRegressor instead of a LinearRegressor from the sklearn package.</p>
</div>
<section id="using-ground-truth-models">
<h2>Using ground truth models<a class="headerlink" href="#using-ground-truth-models" title="Permalink to this heading">#</a></h2>
<p>In some scenarios the ground truth models might be known and should be used instead. Let’s
assume, we know that our relationship are linear with coefficients <span class="math notranslate nohighlight">\(\alpha = 2\)</span> and
<span class="math notranslate nohighlight">\(\beta = 3\)</span>. Let’s make use of this knowledge by creating a custom prediction model that
implements the <code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionModel</span></code> interface:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dowhy.gcm.ml.prediction_model</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyCustomModel</span><span class="p">(</span><span class="n">gcm</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">PredictionModel</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">=</span> <span class="n">coefficient</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="c1"># Nothing to fit here, since we know the ground truth.</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">*</span> <span class="n">X</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="n">MyCustomModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can use this in our ANMs instead:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">AdditiveNoiseModel</span><span class="p">(</span><span class="n">MyCustomModel</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Important:</strong> When a function or algorithm is called that requires a causal graph, DoWhy GCM sorts the input
features internally based on their <strong>alphabetical order</strong>. For instance, in case of the MyCustomModel above, if
the names of the input features are ‘X2’ and ‘X1’, the model should expect ‘X1’ in the first input and ‘X2’ in
the second column.</p>
</div>
</section>
<section id="creating-causal-model-gcm-from-equations">
<h2>Creating causal model (GCM) from equations<a class="headerlink" href="#creating-causal-model-gcm-from-equations" title="Permalink to this heading">#</a></h2>
<p>In the above section, we saw how ground truth models can be created and used for a node. Now in cases where we know the ground truth for almost all of the nodes and we want to create a custom causal model out of it without writing a lot of code.
That is when creating a graphical causal model (GCM) from equations serves as a robust utility, enabling the generation of a causal model by defining relationships between nodes.
This functionality proves highly valuable when the inter-node relationships are known, providing a means to construct a custom causal model. In this section, we’ll dive deeper into how to use this feature.</p>
<dl>
<dt><strong>Defining Equations:</strong></dt><dd><ul class="simple">
<li><p>The functionality supports three equation formats: root node equation, non-root node equation, and an equation for an unknown causal relationship.</p></li>
<li><dl class="simple">
<dt>Structure for each node type:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>Root Node</dt><dd><p>&lt;node_name&gt; = <span class="math notranslate nohighlight">\(N_i\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Non-root Node</dt><dd><p>&lt;node_name&gt; = <span class="math notranslate nohighlight">\(f_i(PA_i) + N_i\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Unknown relationship of node with its parent nodes</dt><dd><p>&lt;node_name&gt; -&gt; PA_i,…</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</li>
<li><p>Note here in the above structure, the <span class="math notranslate nohighlight">\(N_i\)</span> is the noise model and the <span class="math notranslate nohighlight">\(f_i(PA_i)\)</span> notation is the functional causal model or simply a function which defines the relationship between the current node and its parent nodes.</p></li>
<li><p>Root node equation defines the relationship for a root node, specifying a noise model. Non-root node equation extends this by incorporating a function expression involving other nodes and a noise model. Unknown causal model equation is used when the exact relationship between nodes is unknown, only specifying the edges.</p></li>
</ul>
</dd>
<dt><strong>Defining Noise Models(N):</strong></dt><dd><ul class="simple">
<li><dl class="simple">
<dt>The noise models include options like empirical, Bayesian Gaussian mixture, parametric, and those from the <cite>scipy.stats</cite> library. Lets look at each option in detail -</dt><dd><ol class="arabic simple">
<li><p>empirical(): An implementation of a stochastic model class.</p></li>
<li><p>bayesiangaussianmixture(): An implementation of a stochastic model class.</p></li>
<li><p>parametric(): Use it when you want the system to find the best continuous distribution for the data.</p></li>
<li><p>&lt;scipy_function&gt;(): You can specify continuous distribution functions defined in the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#continuous-distributions">scipy.stats</a> library.</p></li>
</ol>
</dd>
</dl>
</li>
</ul>
</dd>
<dt><strong>Defining Functional Causal Models(F(X)):</strong></dt><dd><ul class="simple">
<li><p>Relationships between child and parent nodes can be defined in a expression which supports almost all the airthematic operations and functions in the <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html">numpy</a> library</p></li>
</ul>
</dd>
<dt><strong>Undefined/Unknown relationships for Nodes:</strong></dt><dd><ul class="simple">
<li><p>In case when the relationship between the child and parent nodes are unknown, the user can define such nodes as given below example -</p></li>
</ul>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(X_i -&gt; PA_i, PA_i\)</span></p>
</div></blockquote>
</dd>
<dt><strong>Example</strong></dt><dd><ul class="simple">
<li><p>Users can provide a string containing equations representing the causal relationships between nodes.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dowhy</span> <span class="kn">import</span> <span class="n">gcm</span>
<span class="kn">from</span> <span class="nn">dowhy.utils</span> <span class="kn">import</span> <span class="n">plot</span>

<span class="n">scm</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">X = empirical()</span>
<span class="s2">Y = norm(loc=0, scale=1)</span>
<span class="s2">Z = 12 * X + log(abs(Y)) + norm(loc=0, scale=1)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">causal_model</span> <span class="o">=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">create_causal_model_from_equations</span><span class="p">(</span><span class="n">scm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">plot</span><span class="p">(</span><span class="n">causal_model</span><span class="o">.</span><span class="n">graph</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/causal_graph.png"><img alt="../../_images/causal_graph.png" class="align-center" src="../../_images/causal_graph.png" style="width: 80%;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The functionality sanitizes the input equations to prevent security vulnerabilities.</p></li>
<li><p>The naming of the nodes is currently restricted to python variable naming constraints which means that the name of node can only contain alphabets, numbers (not at the start) and ‘_’ character.</p></li>
</ul>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="model_evaluation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Evaluate a GCM</p>
      </div>
    </a>
    <a class="right-next"
       href="estimating_confidence_intervals.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Estimating Confidence Intervals</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-ground-truth-models">Using ground truth models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-causal-model-gcm-from-equations">Creating causal model (GCM) from equations</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/user_guide/modeling_gcm/customizing_model_assignment.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022, PyWhy contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>
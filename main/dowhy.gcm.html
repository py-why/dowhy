
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B139P18WHM');
</script>
    <title>dowhy.gcm package &#8212; DoWhy  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dowhy.gcm.independence_test package" href="dowhy.gcm.independence_test.html" />
    <link rel="prev" title="dowhy.do_samplers package" href="dowhy.do_samplers.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">DoWhy  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="example_notebooks/nb_index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="dowhy.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="code_repo.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
      <div class="navbar-end-item">
        
<div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main-branch
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <!-- hard-coding the old versions, as no further old version will be added -->
            <!-- It would be nice if this opened the same page in an older version, but that seems to be overkill
                 right now. Therefore defaulting to the starting page (index). -->
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
            <dd><a href="/dowhy/v0.1-alpha/index.html">v0.1-alpha</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="dowhy.gcm.html">main</a></dd>
        </dl>
    </div>
</div>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.api.html">
   dowhy.api package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_estimators.html">
   dowhy.causal_estimators package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_identifiers.html">
   dowhy.causal_identifiers package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.causal_refuters.html">
   dowhy.causal_refuters package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.data_transformers.html">
   dowhy.data_transformers package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.do_samplers.html">
   dowhy.do_samplers package
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   dowhy.gcm package
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.independence_test.html">
     dowhy.gcm.independence_test package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.ml.html">
     dowhy.gcm.ml package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dowhy.gcm.util.html">
     dowhy.gcm.util package
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.graph_learners.html">
   dowhy.graph_learners package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.interpreters.html">
   dowhy.interpreters package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dowhy.utils.html">
   dowhy.utils package
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subpackages">
   Subpackages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.anomaly">
   dowhy.gcm.anomaly module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.anomaly_scorer">
   dowhy.gcm.anomaly_scorer module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.anomaly_scorers">
   dowhy.gcm.anomaly_scorers module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.auto">
   dowhy.gcm.auto module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.cms">
   dowhy.gcm.cms module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.confidence_intervals">
   dowhy.gcm.confidence_intervals module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.confidence_intervals_cms">
   dowhy.gcm.confidence_intervals_cms module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.config">
   dowhy.gcm.config module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.constant">
   dowhy.gcm.constant module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.density_estimator">
   dowhy.gcm.density_estimator module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.density_estimators">
   dowhy.gcm.density_estimators module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.distribution_change">
   dowhy.gcm.distribution_change module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.divergence">
   dowhy.gcm.divergence module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.fcms">
   dowhy.gcm.fcms module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.feature">
   dowhy.gcm.feature module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.fitting_sampling">
   dowhy.gcm.fitting_sampling module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.graph">
   dowhy.gcm.graph module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.influence">
   dowhy.gcm.influence module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.shapley">
   dowhy.gcm.shapley module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.stats">
   dowhy.gcm.stats module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.stochastic_models">
   dowhy.gcm.stochastic_models module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.uncertainty">
   dowhy.gcm.uncertainty module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.validation">
   dowhy.gcm.validation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm.whatif">
   dowhy.gcm.whatif module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-dowhy.gcm">
   Module contents
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="dowhy-gcm-package">
<h1>dowhy.gcm package<a class="headerlink" href="#dowhy-gcm-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.independence_test.html">dowhy.gcm.independence_test package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.kernel">dowhy.gcm.independence_test.kernel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.kernel_operation">dowhy.gcm.independence_test.kernel_operation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.regression">dowhy.gcm.independence_test.regression module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.ml.html">dowhy.gcm.ml package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml.classification">dowhy.gcm.ml.classification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml.regression">dowhy.gcm.ml.regression module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.util.html">dowhy.gcm.util package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util.general">dowhy.gcm.util.general module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util.plotting">dowhy.gcm.util.plotting module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util.pygraphviz">dowhy.gcm.util.pygraphviz module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-dowhy.gcm.anomaly">
<span id="dowhy-gcm-anomaly-module"></span><h2>dowhy.gcm.anomaly module<a class="headerlink" href="#module-dowhy.gcm.anomaly" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.anomaly_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">anomaly_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_data:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_conditional:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_unconditional:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scorer_factory:</span> <span class="pre">~typing.Callable[[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~dowhy.gcm.anomaly_scorer.AnomalyScorer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#anomaly_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.anomaly_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.attribute_anomalies">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">attribute_anomalies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel" title="dowhy.gcm.cms.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><span class="pre">AnomalyScorer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute_mean_deviation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_distribution_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#attribute_anomalies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.attribute_anomalies" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the contributions of upstream nodes to the anomaly score of the target_node for each sample in
anomaly_samples. By default, the anomaly score is based on the information theoretic (IT) score
-log(P(g(X) &gt;= g(x))), where g is the anomaly_scorer, X samples from the marginal
distribution of the target_node and x an observation of the target_node in anomaly_samples. If
attribute_mean_deviation is set to True, the contribution to g(x) - E[g(X)] is estimated instead, i.e. the feature
relevance for the given scoring function. The underlying algorithm utilizes the reconstructed noise of upstream
nodes (including the target_node itself) for the given anomaly_samples. By this, it is possible to estimate how
much of the anomaly score can be explained by upstream anomalies with respect to anomalous noise values.</p>
<p>Note: This function requires that the noise can be recovered from samples, i.e. the causal models of non-root nodes
need to be an InvertibleNoiseModel (e.g. AdditiveNoiseModel).</p>
<p>Related paper:
Janzing, D., Budhathoki, K., Minorics, L., &amp; Bloebaum, P. (2019).
Causal structure based root cause analysis of outliers
<a class="reference external" href="https://arxiv.org/abs/1912.02724">https://arxiv.org/abs/1912.02724</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The fitted InvertibleStructuralCausalModel.</p></li>
<li><p><strong>target_node</strong> – Target node for which the contributions are estimated.</p></li>
<li><p><strong>anomaly_samples</strong> – Anomalous observations for which the contributions are estimated.</p></li>
<li><p><strong>anomaly_scorer</strong> – Anomaly scorer g. If None is given, a MedianCDFQuantileScorer is used.</p></li>
<li><p><strong>attribute_mean_deviation</strong> – If set to False, the contribution is estimated based on the IT score and if it is
set to True, the contribution is based on the feature relevance with respect to the given scoring function.</p></li>
<li><p><strong>num_distribution_samples</strong> – Number of samples from X, the marginal distribution of the target. These are used
for evaluating the tail probability in case of the IT score
(attribute_mean_deviation is False) or as samples for randomization in case of
feature relevance (attribute_mean_deviation is True).</p></li>
<li><p><strong>shapley_config</strong> – <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that assigns a numpy array to each upstream node including the target_node itself. The
i-th entry of an array indicates the contribution of the corresponding node to the anomaly score of the target
for the i-th observation in anomaly_samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.attribute_anomaly_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">attribute_anomaly_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anomaly_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute_mean_deviation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#attribute_anomaly_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.attribute_anomaly_scores" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the contributions of the features for each sample in anomaly_samples to the anomaly score obtained
by the anomaly_scoring_func. If attribute_mean_deviation is set to False, the anomaly score is based on the
information theoretic (IT) score -log(P(g(X) &gt;= g(x))), where g is the anomaly_scoring_func, X samples from the
marginal distribution of the target_node and x an observation of the target_node in anomaly_samples. If
attribute_mean_deviation is set to True, the contribution to g(x) - E[g(X)] is estimated instead, i.e. the
feature relevance for the given scorer.</p>
<p>Note that the anomaly scoring function needs to handle the dimension and modality of the data. An example for a
function for multidimensional continues data would be:</p>
<blockquote>
<div><p>density_estimator = GaussianMixtureDensityEstimator()
density_estimator.fit(original_observations)
anomaly_scoring_func = lambda x, y: estimate_inverse_density_score(x, y, density_estimator)</p>
</div></blockquote>
<p>Related paper:
Janzing, D., Budhathoki, K., Minorics, L., &amp; Bloebaum, P. (2022).
Causal structure based root cause analysis of outliers
<a class="reference external" href="https://arxiv.org/abs/1912.02724">https://arxiv.org/abs/1912.02724</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anomaly_samples</strong> – Samples x for which the contributions are estimated. The dimensionality of these samples
doesn’t matter as long as the anomaly_scoring_func supports it.</p></li>
<li><p><strong>distribution_samples</strong> – Samples from the (non-anomalous) distribution X.</p></li>
<li><p><strong>anomaly_scoring_func</strong> – A function g that takes a sample from X as input and returns an anomaly score.</p></li>
<li><p><strong>attribute_mean_deviation</strong> – If set to False, the contribution is estimated based on the IT score and if it is
set to True, the contribution is based on the feature relevance with respect to the
given scoring function.</p></li>
<li><p><strong>shapley_config</strong> – <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array with the feature contributions to the anomaly score for each sample in anomaly_samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly.conditional_anomaly_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly.</span></span><span class="sig-name descname"><span class="pre">conditional_anomaly_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_samples:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal_mechanism:</span> <span class="pre">~dowhy.gcm.graph.ConditionalStochasticModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_scorer_factory:</span> <span class="pre">~typing.Callable[[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~dowhy.gcm.anomaly_scorer.AnomalyScorer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_conditional:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly.html#conditional_anomaly_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly.conditional_anomaly_scores" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the conditional anomaly scores based on the expected outcomes of the causal model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong> – Samples from all parents of the target node.</p></li>
<li><p><strong>target_samples</strong> – Samples from the target node.</p></li>
<li><p><strong>causal_mechanism</strong> – Causal mechanism of the target node.</p></li>
<li><p><strong>anomaly_scorer_factory</strong> – A callable that returns an anomaly scorer.</p></li>
<li><p><strong>num_samples_conditional</strong> – Number of samples drawn from the conditional distribution based on the given
parent samples. The more samples, the more accurate the results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The conditional anomaly score for each sample in target_samples.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.anomaly_scorer">
<span id="dowhy-gcm-anomaly-scorer-module"></span><h2>dowhy.gcm.anomaly_scorer module<a class="headerlink" href="#module-dowhy.gcm.anomaly_scorer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorer.AnomalyScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorer.</span></span><span class="sig-name descname"><span class="pre">AnomalyScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorer.html#AnomalyScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorer.AnomalyScorer.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorer.html#AnomalyScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorer.AnomalyScorer.score">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorer.html#AnomalyScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.anomaly_scorers">
<span id="dowhy-gcm-anomaly-scorers-module"></span><h2>dowhy.gcm.anomaly_scorers module<a class="headerlink" href="#module-dowhy.gcm.anomaly_scorers" title="Permalink to this heading"></a></h2>
<p>This module contains implementations of different anomaly scorers.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.ITAnomalyScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">ITAnomalyScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anomaly_scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><span class="pre">AnomalyScorer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#ITAnomalyScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<p>Transforms any anomaly scorer into an information theoretic (IT) score. This means, given a scorer S(x), an
anomalous observation x and samples from the distribution of X, this scorer class represents:</p>
<blockquote>
<div><p>score(x) = -log(P(S(X) &gt;= S(x)))</p>
</div></blockquote>
<p>This is, the negative logarithm of the probability to get the same or a higher score with (random) samples from X
compared to the score obtained based on the anomalous observation x. By this, the score of arbitrarily different
anomaly scorers become comparable information theoretic quantities. The new score -log(P(S(X) &gt;= S(x))) can also
be seen as “The higher the score, the rarer the anomaly event”. For instance, if we have S(x) = c, but observe
the same or higher scores in 50% or even 100% of all samples in X, then this is not really a rare event, and thus,
not an anomaly. As mentioned above, transforming it into an IT score makes arbitrarily different anomaly scorer
with potentially completely different scaling comparable. For example, one could compare the IT score of
isolation forests with z-scores.</p>
<dl class="simple">
<dt>For more details about IT scores, see:</dt><dd><p>Causal structure based root cause analysis of outliers
Kailash Budhathoki, Patrick Bloebaum, Lenon Minorics, Dominik Janzing (2022)</p>
</dd>
</dl>
<p>The higher the score, the higher the likelihood that the observations is an anomaly.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.ITAnomalyScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#ITAnomalyScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.ITAnomalyScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#ITAnomalyScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.ITAnomalyScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.InverseDensityScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">InverseDensityScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density_estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.density_estimator.DensityEstimator" title="dowhy.gcm.density_estimator.DensityEstimator"><span class="pre">DensityEstimator</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#InverseDensityScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<p>Estimates an anomaly score based on 1 / p(x), where x is the data to score. The density value p(x) is estimated
using the given density estimator. If None is given, a Gaussian mixture model is used by default.</p>
<p>Note: The given density estimator needs to support the data types, i.e. if the data has categorical values, the
density estimator needs to be able to handle that. The default Gaussian model can only handle numeric data.</p>
<p>Note: If the density p(x) is 0, a nan or inf could be returned.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.InverseDensityScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#InverseDensityScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.InverseDensityScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#InverseDensityScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.InverseDensityScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MeanDeviationScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">MeanDeviationScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MeanDeviationScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = <a href="#id3"><span class="problematic" id="id4">|x - E[X]|</span></a> / std[X]</p>
</dd>
</dl>
<p>This scores the given sample based on its distance to the mean of X and scaled by the standard deviation of X. This
is also equivalent to the Z-score in Gaussian variables.</p>
<p>The higher the score, the higher the deviation of the observation from the mean of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MeanDeviationScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MeanDeviationScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MeanDeviationScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MeanDeviationScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MeanDeviationScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">MedianCDFQuantileScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianCDFQuantileScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = 1 - 2 * min[P(X &gt;= x), P(X &lt;= x)]</p>
</dd>
</dl>
<p>It scores the observation based on the quantile of x with respect to the distribution of X. Here, if the
sample x lies in the tail of the distribution, we want to have a large score. Since we apriori don’t know
whether the sample falls on the left or right side of the median of X, we estimate the quantile on both
sides and take the minimum. Here, these probabilities are estimated by counting and since half of the samples are
on one side from the median, we need to multiply this by a factor of two to obtain the two-sided quantile.
For example:</p>
<blockquote>
<div><p>X = [-3, -2, -1, 0, 1, 2, 3]
x = 2.5</p>
</div></blockquote>
<dl class="simple">
<dt>Then, x falls in the right sided-quantile and only one sample in X is larger than x. Therefore, we get</dt><dd><p>p(X &gt;= x) = 1 / 7
P(X &lt;= x) = 6 / 7</p>
</dd>
<dt>With the end score of:</dt><dd><p>1 - 2 * min[P(X &gt;= x), P(X &lt;= x)] = 1 - 2 / 7 = 0.71</p>
</dd>
</dl>
<p>Note: For equal samples, we contribute half of the count to the left and half of the count the right side.</p>
<p>The higher the score, the less likely the sample comes from the distribution of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianCDFQuantileScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianCDFQuantileScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianDeviationScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">MedianDeviationScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianDeviationScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = <a href="#id5"><span class="problematic" id="id6">|x - med[X]|</span></a> / mad[X]</p>
</dd>
</dl>
<p>This scores the given sample based on its distance to the median of X and scaled by the median absolute deviation
of X.</p>
<p>The higher the score, the higher the deviation of the observation from the median of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianDeviationScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianDeviationScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.MedianDeviationScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#MedianDeviationScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.MedianDeviationScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.anomaly_scorers.</span></span><span class="sig-name descname"><span class="pre">RescaledMedianCDFQuantileScorer</span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#RescaledMedianCDFQuantileScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.anomaly_scorer.AnomalyScorer" title="dowhy.gcm.anomaly_scorer.AnomalyScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnomalyScorer</span></code></a></p>
<dl class="simple">
<dt>Given an anomalous observation x and samples from the distribution of X, this score represents:</dt><dd><p>score(x) = -log(2 * min[P(X &gt;= x), P(X &lt;= x)])</p>
</dd>
</dl>
<p>This is a rescaled version of the score s obtained by the <a class="reference internal" href="#dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer" title="dowhy.gcm.anomaly_scorers.MedianCDFQuantileScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MedianCDFQuantileScorer</span></code></a>
by calculating the negative log-probability -log(1 - s). This has the advantage that small differences in the
probabilities are amplified, especially when they are close to 0. For instance, the difference between
probabilities 0.02 and 0.01 seems to be small and insignificant, but the rescaled difference would be significantly
larger: -log(0.02) - log(0.01) −= 8.5</p>
<p>The higher the score, the less likely the sample comes from the distribution of X.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#RescaledMedianCDFQuantileScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the anomaly scorer to the given data. Depending on the definition of the scorer, this can imply
different things, such as fitting a (parametric) distribution to the data or estimating certain properties
such as mean, variance, median etc. that are used for computing a score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Samples from the underlying data distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/anomaly_scorers.html#RescaledMedianCDFQuantileScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.anomaly_scorers.RescaledMedianCDFQuantileScorer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.auto">
<span id="dowhy-gcm-auto-module"></span><h2>dowhy.gcm.auto module<a class="headerlink" href="#module-dowhy.gcm.auto" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.auto.AssignmentQuality">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">AssignmentQuality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#AssignmentQuality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.AssignmentQuality" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.auto.AssignmentQuality.BETTER">
<span class="sig-name descname"><span class="pre">BETTER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#dowhy.gcm.auto.AssignmentQuality.BETTER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.auto.AssignmentQuality.GOOD">
<span class="sig-name descname"><span class="pre">GOOD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(&lt;enum.auto</span> <span class="pre">object&gt;,)</span></em><a class="headerlink" href="#dowhy.gcm.auto.AssignmentQuality.GOOD" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.assign_causal_mechanisms">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">assign_causal_mechanisms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">based_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AssignmentQuality.GOOD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#assign_causal_mechanisms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.assign_causal_mechanisms" title="Permalink to this definition"></a></dt>
<dd><p>Automatically assigns appropriate causal models. If causal models are already assigned to nodes and
override_models is set to False, this function only validates the assignments with respect to the graph structure.
Here, the validation checks whether root nodes have StochasticModels and non-root ConditionalStochasticModels
assigned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The causal model to whose nodes to assign causal models.</p></li>
<li><p><strong>based_on</strong> – Jointly sampled data corresponding to the nodes of the given graph.</p></li>
<li><p><strong>quality</strong> – AssignmentQuality for the automatic model selection and model accuracy. This changes the type of</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>prediction model and time spent on the selection. Options are:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>AssignmentQuality.GOOD: Checks whether the data is linear. If the data is linear, an OLS model is</dt><dd><p>used, otherwise a gradient boost model.
Model selection speed: Fast
Model training speed: Fast
Model inference speed: Fast
Model accuracy: Medium</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>AssignmentQuality.BETTER: Compares multiple model types and uses the one with the best performance</dt><dd><p>averaged over multiple splits of the training data. By default, the model with the smallest root mean
squared error is selected for regression problems and the model with the highest F1 score is selected for
classification problems. For a list of possible models, see _LIST_OF_POTENTIAL_REGRESSORS and
_LIST_OF_POTENTIAL_CLASSIFIERS, respectively.
Model selection speed: Medium
Model training speed: Fast
Model inference speed: Fast
Model accuracy: Good</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">param override_models</dt>
<dd class="field-odd"><p>If set to True, existing model assignments are replaced with automatically selected</p>
</dd>
</dl>
<p>ones. If set to False, the assigned models are only validated with respect to the graph structure.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.find_best_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">find_best_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model_factories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_samples_per_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_selection_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#find_best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.find_best_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.has_linear_relationship">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">has_linear_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#has_linear_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.has_linear_relationship" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.auto.select_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.auto.</span></span><span class="sig-name descname"><span class="pre">select_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_selection_quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.ClassificationModel" title="dowhy.gcm.fcms.ClassificationModel"><span class="pre">ClassificationModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/auto.html#select_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.auto.select_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.cms">
<span id="dowhy-gcm-cms-module"></span><h2>dowhy.gcm.cms module<a class="headerlink" href="#module-dowhy.gcm.cms" title="Permalink to this heading"></a></h2>
<p>This module defines the fundamental classes for graphical causal models (GCMs).</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.cms.InvertibleStructuralCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.cms.</span></span><span class="sig-name descname"><span class="pre">InvertibleStructuralCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.gcm.graph.DirectedGraph],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#InvertibleStructuralCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralCausalModel</span></code></a></p>
<p>Represents an invertible structural graphical causal model, as required e.g. by
<a class="reference internal" href="#dowhy.gcm.whatif.counterfactual_samples" title="dowhy.gcm.whatif.counterfactual_samples"><code class="xref py py-func docutils literal notranslate"><span class="pre">counterfactual_samples()</span></code></a>. This is a subclass of
<a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralCausalModel</span></code></a> and has further restrictions on the class of causal mechanisms.
Here, the mechanisms of non-root nodes need to be invertible with respect to the noise,
such as <a class="reference internal" href="#dowhy.gcm.fcms.PostNonlinearModel" title="dowhy.gcm.fcms.PostNonlinearModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong> – Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.InvertibleStructuralCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="dowhy.gcm.graph.InvertibleFunctionalCausalModel"><span class="pre">InvertibleFunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#InvertibleStructuralCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.InvertibleStructuralCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="dowhy.gcm.graph.InvertibleFunctionalCausalModel"><span class="pre">InvertibleFunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#InvertibleStructuralCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong> – Causal mechanism to be assigned. A root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.cms.</span></span><span class="sig-name descname"><span class="pre">ProbabilisticCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.gcm.graph.DirectedGraph],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a probabilistic graphical causal model, i.e. it combines a graphical representation of causal
causal relationships and corresponding causal mechanism for each node describing the data generation process. The
causal mechanisms can be any general stochastic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong> – Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel.clone" title="Permalink to this definition"></a></dt>
<dd><p>Clones the causal model, but keeps causal mechanisms untrained.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong> – Causal mechanism to be assigned. A root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.cms.StructuralCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.cms.</span></span><span class="sig-name descname"><span class="pre">StructuralCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.gcm.graph.DirectedGraph],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#StructuralCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.StructuralCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticCausalModel</span></code></a></p>
<p>Represents a structural causal model (SCM), as required e.g. by
<a class="reference internal" href="#dowhy.gcm.whatif.counterfactual_samples" title="dowhy.gcm.whatif.counterfactual_samples"><code class="xref py py-func docutils literal notranslate"><span class="pre">counterfactual_samples()</span></code></a>. As compared to a <a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticCausalModel</span></code></a>,
an SCM describes the data generation process in non-root nodes by functional causal models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong> – Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.StructuralCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><span class="pre">FunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#StructuralCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.StructuralCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.StructuralCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><span class="pre">FunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#StructuralCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.StructuralCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong> – Causal mechanism to be assigned. A root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.confidence_intervals">
<span id="dowhy-gcm-confidence-intervals-module"></span><h2>dowhy.gcm.confidence_intervals module<a class="headerlink" href="#module-dowhy.gcm.confidence_intervals" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to estimate confidence intervals via bootstrapping.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.confidence_intervals.confidence_intervals">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.confidence_intervals.</span></span><span class="sig-name descname"><span class="pre">confidence_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">estimation_func:</span> <span class="pre">~typing.Union[~typing.Callable[[],</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">~typing.Callable[[],</span> <span class="pre">~typing.Dict[~typing.Any,</span> <span class="pre">float]]],</span> <span class="pre">confidence_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.95,</span> <span class="pre">num_bootstrap_resamples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20,</span> <span class="pre">bootstrap_results_summary_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray],</span> <span class="pre">~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">estimate_geometric_median&gt;,</span> <span class="pre">n_jobs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/confidence_intervals.html#confidence_intervals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.confidence_intervals.confidence_intervals" title="Permalink to this definition"></a></dt>
<dd><p>Estimates confidence intervals based on the outputs generated by calling the given estimation_func. Since one result
for each repetition is produced, all results can be summarized by the method defined in
summary_method_of_bootstrap_results.
For instance, summary_method_of_bootstrap_results = lambda x: numpy.mean(x, axis=0) to get the mean over all runs.
By default, the geometric median is returned.</p>
<p>Currently, the confidence intervals are empirically estimated based on the n-th estimated quantiles (without bias
correction) of the results, where the quantiles are determined by the given confidence_level.</p>
<p>NOTE: The outputs of estimation_func are assumed to be pairwise independent. For multidimensional outputs of
estimation_func, this could be violated and should be kept in mind. For instance, when evaluating the outcome of
interventions in a graph like X -&gt; Y -&gt; Z, the confidence intervals are estimate independently for X, Y and Z
although they have a strong dependency. If estimation_func returns one dimensional results, as for instance when
estimating the direct arrow strength, then there should be no problem.</p>
<p><strong>Example usage with numpy array output:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">estimation_func</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">direct_arrow_strength_of_model</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">parent_data</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrow_strengths</span><span class="p">,</span> <span class="n">confidence_intervals</span> <span class="o">=</span> <span class="n">confidence_intervals</span><span class="p">(</span><span class="n">estimation_func</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example usage with dictionary output:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">estimation_func</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">distribution_change</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">causal_dag</span><span class="p">,</span> <span class="n">original_observations</span><span class="p">,</span> <span class="n">outlier_observations</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_contributions</span><span class="p">,</span> <span class="n">confidence_intervals</span> <span class="o">=</span> <span class="n">confidence_intervals</span><span class="p">(</span><span class="n">estimation_func</span><span class="p">)</span>
</pre></div>
</div>
<p>More details about the estimation of confidence intervals via bootstrapping can be found <a class="reference external" href="https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading24.pdf">here</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimation_func</strong> – Function that generates a non-deterministic output for which the confidence interval(s) are
estimated.</p></li>
<li><p><strong>confidence_level</strong> – Confidence level of the interval.</p></li>
<li><p><strong>num_bootstrap_resamples</strong> – Number of samples generated by estimation_func, i.e. number of times
is called. The higher the number, the more accurate the results and intervals,
but the slower the runtime.</p></li>
<li><p><strong>bootstrap_results_summary_func</strong> – Function that takes a numpy array with all results as an input and returns
a single (potentially multidimensional) value/vector. For instance, the mean or median
over all results.</p></li>
<li><p><strong>n_jobs</strong> – Number of parallel jobs. Each repetition can be estimated in parallel.
However, since many other functions of the library are already running in parallel (
such as distribution change), this is set to 1 by default. Only if it is certain that
the estimation_func is not running in parallel internally (e.g. when performing
interventions), this should be set to a different value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple (summarized result over all repetitions based on
summary_method_of_bootstrap_results, confidence interval for each dimension/variable)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.confidence_intervals.estimate_geometric_median">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.confidence_intervals.</span></span><span class="sig-name descname"><span class="pre">estimate_geometric_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/confidence_intervals.html#estimate_geometric_median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.confidence_intervals.estimate_geometric_median" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.confidence_intervals_cms">
<span id="dowhy-gcm-confidence-intervals-cms-module"></span><h2>dowhy.gcm.confidence_intervals_cms module<a class="headerlink" href="#module-dowhy.gcm.confidence_intervals_cms" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to estimate confidence intervals via bootstrapping the fitting and sampling.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.confidence_intervals_cms.bootstrap_training_and_sampling">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.confidence_intervals_cms.</span></span><span class="sig-name descname"><span class="pre">bootstrap_training_and_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel" title="dowhy.gcm.cms.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel" title="dowhy.gcm.cms.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_training_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_data_subset_size_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/confidence_intervals_cms.html#bootstrap_training_and_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.confidence_intervals_cms.bootstrap_training_and_sampling" title="Permalink to this definition"></a></dt>
<dd><p>A convenience function when computing confidence intervals specifically for causal queries. This function
specifically bootstraps training <em>and</em> sampling.</p>
<p><strong>Example usage:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scores_median</span><span class="p">,</span> <span class="n">scores_intervals</span> <span class="o">=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">confidence_intervals</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">gcm</span><span class="o">.</span><span class="n">bootstrap_training_and_sampling</span><span class="p">(</span><span class="n">gcm</span><span class="o">.</span><span class="n">arrow_strength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                        <span class="n">causal_model</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                        <span class="n">bootstrap_training_data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                        <span class="n">target_node</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – The causal query to perform. A causal query is a function taking a graphical causal model as first
parameter and an arbitrary number of remaining parameters. It must return a dictionary with
attribution-like data.</p></li>
<li><p><strong>causal_model</strong> – A graphical causal model to perform the causal query on. It need not be fitted.</p></li>
<li><p><strong>bootstrap_training_data</strong> – The training data to use when fitting. A random subset from this data set is used
in every iteration when calling fit.</p></li>
<li><p><strong>bootstrap_data_subset_size_fraction</strong> – The fraction defines the fractional size of the subset compared to
the total training data.</p></li>
<li><p><strong>args</strong> – Args passed through verbatim to the causal queries.</p></li>
<li><p><strong>kwargs</strong> – Keyword args passed through verbatim to the causal queries.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing (1) the median of causal query results and (2) the confidence intervals.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.config">
<span id="dowhy-gcm-config-module"></span><h2>dowhy.gcm.config module<a class="headerlink" href="#module-dowhy.gcm.config" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.disable_progress_bars">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">disable_progress_bars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/config.html#disable_progress_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.disable_progress_bars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.enable_progress_bars">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">enable_progress_bars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/config.html#enable_progress_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.enable_progress_bars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.set_default_n_jobs">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">set_default_n_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/config.html#set_default_n_jobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.set_default_n_jobs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.constant">
<span id="dowhy-gcm-constant-module"></span><h2>dowhy.gcm.constant module<a class="headerlink" href="#module-dowhy.gcm.constant" title="Permalink to this heading"></a></h2>
</section>
<section id="module-dowhy.gcm.density_estimator">
<span id="dowhy-gcm-density-estimator-module"></span><h2>dowhy.gcm.density_estimator module<a class="headerlink" href="#module-dowhy.gcm.density_estimator" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimator.DensityEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.density_estimator.</span></span><span class="sig-name descname"><span class="pre">DensityEstimator</span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimator.html#DensityEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimator.DensityEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimator.DensityEstimator.density">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimator.html#DensityEstimator.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimator.DensityEstimator.density" title="Permalink to this definition"></a></dt>
<dd><p>Returns the density of each input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimator.DensityEstimator.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimator.html#DensityEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimator.DensityEstimator.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.density_estimators">
<span id="dowhy-gcm-density-estimators-module"></span><h2>dowhy.gcm.density_estimators module<a class="headerlink" href="#module-dowhy.gcm.density_estimators" title="Permalink to this heading"></a></h2>
<p>This module contains implementations of different density estimators.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.density_estimators.</span></span><span class="sig-name descname"><span class="pre">GaussianMixtureDensityEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#GaussianMixtureDensityEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.density_estimator.DensityEstimator" title="dowhy.gcm.density_estimator.DensityEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DensityEstimator</span></code></a></p>
<p>Represents a density estimator based on a Gaussian mixture model. The estimator uses the sklearn
BayesianGaussianMixture model internally.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#GaussianMixtureDensityEstimator.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.density" title="Permalink to this definition"></a></dt>
<dd><p>Returns the density of each input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#GaussianMixtureDensityEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.GaussianMixtureDensityEstimator.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.KernelDensityEstimator1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.density_estimators.</span></span><span class="sig-name descname"><span class="pre">KernelDensityEstimator1D</span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#KernelDensityEstimator1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.density_estimator.DensityEstimator" title="dowhy.gcm.density_estimator.DensityEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DensityEstimator</span></code></a></p>
<p>Represents a kernel based density estimator. The estimator uses the sklearn KernelDensity class internally.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.KernelDensityEstimator1D.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#KernelDensityEstimator1D.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D.density" title="Permalink to this definition"></a></dt>
<dd><p>Returns the density of each input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.density_estimators.KernelDensityEstimator1D.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/density_estimators.html#KernelDensityEstimator1D.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.density_estimators.KernelDensityEstimator1D.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.distribution_change">
<span id="dowhy-gcm-distribution-change-module"></span><h2>dowhy.gcm.distribution_change module<a class="headerlink" href="#module-dowhy.gcm.distribution_change" title="Permalink to this heading"></a></h2>
<p>This module defines functions to attribute distribution changes.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.distribution_change">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">distribution_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">old_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">new_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">target_node:</span> <span class="pre">~typing.Any,</span> <span class="pre">num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">mechanism_change_test_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~typing.Optional[~numpy.ndarray],</span> <span class="pre">~typing.Optional[~numpy.ndarray]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">mechanism_change_test&gt;,</span> <span class="pre">mechanism_change_test_significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">mechanism_change_test_fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh',</span> <span class="pre">return_additional_info:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">shapley_config:</span> <span class="pre">~typing.Optional[~dowhy.gcm.shapley.ShapleyConfig]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_factory:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#distribution_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.distribution_change" title="Permalink to this definition"></a></dt>
<dd><p>Attributes the change in the marginal distribution of the target_node to nodes upstream in the causal DAG.</p>
<p>Note that this method creates two copies of the causal DAG. The causal models of one causal DAG are learned from
old data and those of another DAG are learned from new data.</p>
<p><strong>Research Paper</strong>:
Kailash Budhathoki, Dominik Janzing, Patrick Bloebaum, Hoiyi Ng. <em>Why did the distribution change?</em>. Proceedings
of The 24th International Conference on Artificial Intelligence and Statistics, PMLR 130:1666-1674, 2021.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – Reference causal model.</p></li>
<li><p><strong>old_data</strong> – Joint samples from the ‘old’ distribution.</p></li>
<li><p><strong>new_data</strong> – Joint samples from the ‘new’ distribution.</p></li>
<li><p><strong>target_node</strong> – Target node of interest for attributing the marginal distribution change.</p></li>
<li><p><strong>num_samples</strong> – Number of samples used for estimating Shapley values. This can have a significant influence
on runtime and accuracy.</p></li>
<li><p><strong>difference_estimation_func</strong> – Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions,
e.g. difference in average values.</p></li>
<li><p><strong>mechanism_change_test_func</strong> – Function for testing whether the causal mechanism of a node has changed. This
function should return a p–value for the null hypothesis that the mechanism has
not changed.</p></li>
<li><p><strong>mechanism_change_test_significance_level</strong> – A significance level for rejecting the null hypothesis that the
causal mechanism of a node has not changed.</p></li>
<li><p><strong>mechanism_change_test_fdr_control_method</strong> – The false discovery rate control method for mechanism change
tests. For more options, checkout <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">statsmodels manual</a>.</p></li>
<li><p><strong>return_additional_info</strong> – If set to True, three additional items are returned: a dictionary indicating
whether each node’s mechanism changed, the causal DAG whose causal models are
learned from old data, and the causal DAG whose causal models are learned from new
data.</p></li>
<li><p><strong>shapley_config</strong> – Configuration for the Shapley estimator.</p></li>
<li><p><strong>graph_factory</strong> – Allows customization in case a graph class different than networkx.DiGraph should be used.
This function <em>must</em> copy nodes and edges. Attributes of nodes will be overridden in the copy,
so the algorithm is independent of the attribute copy behavior of this factory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>By default, if <cite>return_additional_info</cite> is set to False, only the dictionary containing contribution of
each upstream node is returned. If <cite>return_additional_info</cite> is set to True, three additional items are
returned: a dictionary indicating whether each node’s mechanism changed, the causal DAG whose causal models
learned from old data, and the causal DAG whose causal models are learned from new data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.distribution_change_of_graphs">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">distribution_change_of_graphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model_old:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">causal_model_new:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">target_node:</span> <span class="pre">~typing.Any,</span> <span class="pre">num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">shapley_config:</span> <span class="pre">~typing.Optional[~dowhy.gcm.shapley.ShapleyConfig]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_factory:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#distribution_change_of_graphs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.distribution_change_of_graphs" title="Permalink to this definition"></a></dt>
<dd><p>Attributes the change of the marginal distribution of target_node to upstream nodes based on the distributions
generated by the ‘old’ and ‘new’ causal graphs. These graphs are assumed to represent the same causal structure and
to be fitted on the respective data.</p>
<p>Note: This method creates a copy of the given causal models, i.e. the original objects will not be modified.</p>
<p>Related paper:
Budhathoki, K., Janzing, D., Bloebaum, P., &amp; Ng, H. (2021). Why did the distribution change?
arXiv preprint arXiv:2102.13384.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model_old</strong> – The ProbabilisticCausalModel fitted on the ‘old’ data.</p></li>
<li><p><strong>causal_model_new</strong> – The ProbabilisticCausalModel fitted on the ‘new’ data.</p></li>
<li><p><strong>target_node</strong> – Node of interest for attributing the marginal distribution change.</p></li>
<li><p><strong>num_samples</strong> – Number of samples used for the estimation. This can have a significant influence on the runtime
and accuracy.</p></li>
<li><p><strong>difference_estimation_func</strong> – Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions. An example
could be the KL divergence.</p></li>
<li><p><strong>shapley_config</strong> – Config for the Shapley estimator.</p></li>
<li><p><strong>graph_factory</strong> – Allows customization in case a graph class different than networkx.DiGraph should be used.
This function <em>must</em> copy nodes and edges. Attributes of nodes will be overridden in the copy,
so the algorithm is independent of the attribute copy behavior of this factory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the contributions of upstream nodes to the marginal distribution change in the
target node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.estimate_distribution_change_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">estimate_distribution_change_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">original_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">new_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">~typing.Union[~numpy.ndarray,</span> <span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">max_num_evaluation_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000,</span> <span class="pre">num_joint_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">500,</span> <span class="pre">early_stopping_percentage:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.01,</span> <span class="pre">mechanism_change_test_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~typing.Optional[~numpy.ndarray],</span> <span class="pre">~typing.Optional[~numpy.ndarray]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">mechanism_change_test&gt;,</span> <span class="pre">mechanism_change_test_significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">mechanism_change_test_fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh'</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#estimate_distribution_change_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.estimate_distribution_change_scores" title="Permalink to this definition"></a></dt>
<dd><p>Given newly observed and original samples from the joint distribution of the given causal graphical model, this
method estimates a score for each node that quantifies how much the distribution of the node has changed. For this,
it first checks whether the underlying causal mechanism has changed at all and, if this is the case, it estimates
the difference between the new and original distributions. The score is based on the quantity measured by the
provided difference_estimation_func or 0 if no mechanism change has been detected.</p>
<p>Note that for each parent sample, num_joint_samples conditional samples are generated based on the original and new
causal mechanism and evaluated by the given difference_estimation_func function. These results are then averaged
over multiple different parent samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The underlying causal model based on the original data.</p></li>
<li><p><strong>original_data</strong> – Samples from the original data.</p></li>
<li><p><strong>new_data</strong> – Samples from the new data.</p></li>
<li><p><strong>difference_estimation_func</strong> – Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions. An example
could be the KL divergence.</p></li>
<li><p><strong>max_num_evaluation_samples</strong> – Maximum number of (parent) samples for evaluating the difference in
distributions.</p></li>
<li><p><strong>num_joint_samples</strong> – Number of samples generated in a node per parent sample.</p></li>
<li><p><strong>early_stopping_percentage</strong> – If the change in percentage between multiple consecutive runs is below this
threshold, the evaluation stops before evaluating all max_num_evaluation_samples.</p></li>
<li><p><strong>mechanism_change_test_func</strong> – Function for testing whether the causal mechanism of a node has changed. This
function should return a p–value for the null hypothesis that the mechanism has
not changed.</p></li>
<li><p><strong>mechanism_change_test_significance_level</strong> – A significance level for rejecting the null hypothesis that the
causal mechanism of a node has not changed.</p></li>
<li><p><strong>mechanism_change_test_fdr_control_method</strong> – <p>The false discovery rate control method for mechanism change
tests. For more options, checkout <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">statsmodels manual</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary assining a score to each node in the causal graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.mechanism_change_test">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">mechanism_change_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">target_original_data:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">target_new_data:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">parents_original_data:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">parents_new_data:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Union[~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float],</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#mechanism_change_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.mechanism_change_test" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a p-value for the null hypothesis that the original and new data were generated by the same mechanism. 
Here, we check the dependency between binary labels indicating whether a sample is from the original or a new 
data set. If the labels do not provide information to determine if a sample is coming from the original/new 
distribution, then it is likely that the mechanism has not changed.</p>
<p>For non-root nodes, samples from parent variables are needed as conditioning variables. This is, testing the
null hypothesis that the data were generated by the same mechanism given the parent samples. By this, we incorporate
upstream changes that might have impacted the parents, but not the target node itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_original_data</strong> – Samples of the node from the original data set.</p></li>
<li><p><strong>target_new_data</strong> – Samples of the node from the new data set.</p></li>
<li><p><strong>parents_original_data</strong> – Samples from parents of the node from the original data set.</p></li>
<li><p><strong>parents_new_data</strong> – Samples from parents of the node from the new data set.</p></li>
<li><p><strong>independence_test</strong> – Pairwise/conditional independence test.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A p-value for the null hypothesis that the mechanism has not changed.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.divergence">
<span id="dowhy-gcm-divergence-module"></span><h2>dowhy.gcm.divergence module<a class="headerlink" href="#module-dowhy.gcm.divergence" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.auto_estimate_kl_divergence">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">auto_estimate_kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#auto_estimate_kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.auto_estimate_kl_divergence" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_categorical">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_categorical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_categorical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_categorical" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_continuous">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_continuous" title="Permalink to this definition"></a></dt>
<dd><p>Estimates KL-Divergence using k-nearest neighbours (Wang et al., 2009).</p>
<p>Q. Wang, S. R. Kulkarni, and S. Verdú,
“Divergence estimation for multidimensional densities via k-nearest-neighbor distances”,
IEEE Transactions on Information Theory, vol. 55, no. 5, pp. 2392-2405, May 2009.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – (N_1,D) Sample drawn from distribution P_X</p></li>
<li><p><strong>Y</strong> – (N_2,D) Sample drawn from distribution P_Y</p></li>
</ul>
</dd>
</dl>
<p>return: Estimated value of D(P_X||P_Y).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_of_probabilities">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_of_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_of_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_of_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the Kullback-Leibler divergence between each pair of probability vectors (row wise) in X and Y
separately and returns the mean over all results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.is_probability_matrix">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">is_probability_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#is_probability_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.is_probability_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.fcms">
<span id="dowhy-gcm-fcms-module"></span><h2>dowhy.gcm.fcms module<a class="headerlink" href="#module-dowhy.gcm.fcms" title="Permalink to this heading"></a></h2>
<p>This module defines multiple implementations of the abstract class <a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>
(FCM)</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.AdditiveNoiseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">AdditiveNoiseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#AdditiveNoiseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.AdditiveNoiseModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.fcms.PostNonlinearModel" title="dowhy.gcm.fcms.PostNonlinearModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code></a></p>
<dl class="simple">
<dt>Represents the continuous functional causal model of the form</dt><dd><p>Y = f(X) + N,</p>
</dd>
</dl>
<p>where X is the input (typically, direct causal parents of Y) and the noise N is assumed to be independent of X. This
is a special instance of a <code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code> where the function g is the
identity function.</p>
<p>Given joint samples from (X, Y), this model can be fitted by first training a model f (e.g. using least squares
regression) and then reconstruct N by N = Y - f(X), i.e. using the residual.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_model</strong> – The prediction model f.</p></li>
<li><p><strong>invertible_function</strong> – The invertible function g.</p></li>
<li><p><strong>noise_model</strong> – The StochasticModel to describe the distribution of the noise N.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.AdditiveNoiseModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#AdditiveNoiseModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.AdditiveNoiseModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassificationModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">ClassificationModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassificationModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassificationModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionModel</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassificationModel.classes">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.fcms.ClassificationModel.classes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassificationModel.predict_probabilities">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassificationModel.predict_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassificationModel.predict_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">ClassifierFCM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.fcms.ClassificationModel" title="dowhy.gcm.fcms.ClassificationModel"><span class="pre">ClassificationModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>, <a class="reference internal" href="#dowhy.gcm.fcms.ProbabilityEstimatorModel" title="dowhy.gcm.fcms.ProbabilityEstimatorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilityEstimatorModel</span></code></a></p>
<dl class="simple">
<dt>Represents the categorical functional causal model of the form</dt><dd><p>Y = f(X, N),</p>
</dd>
</dl>
<p>where X is the input (typically, direct causal parents of Y) and the noise N here is uniform on [0, 1]. The model
is mostly based on a standard classification model that outputs probabilities. In order to generate a new random
sample given an input x, the return value y is uniformly sampled based on the class probabilities p(y | x). Here,
the noise is used to make this sampling process deterministic by using the cumulative distribution functions defined
by the given inputs.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.classifier_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classifier_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.ClassificationModel" title="dowhy.gcm.fcms.ClassificationModel"><span class="pre">ClassificationModel</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.classifier_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.draw_noise_samples">
<span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd><p>Returns uniformly sampled values on [0, 1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_samples</strong> – Number of noise samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Noise samples on [0, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.estimate_probabilities">
<span class="sig-name descname"><span class="pre">estimate_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.estimate_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.estimate_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Returns the class probabilities for the given parent_samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parent_samples</strong> – Samples from inputs X.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A nxd numpy matrix with class probabilities for each sample, where n is the number of samples and d
the number of classes. Here, array entry A[i][j] corresponds to the i-th sample indicating the
probability of the j-th class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the model Y = f(X, N), where X are the parent_samples and N the noise_samples. Here, the
cumulative distribution functions are defined by the parent_samples. For instance, lets say we have 2
classes, n = 0.7 and an input x with p(y = 0| x) = 0.6 and p(y = 1| x) = 0.4, then we get y = 1 as a return
value. This is because p(y = 0| x) &lt; n &lt;= 1.0, i.e. n falls into the bucket that is spanned by p(y = 1| x).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong> – Samples from the inputs X.</p></li>
<li><p><strong>noise_samples</strong> – Samples from the noise on [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Class labels Y based on the inputs and noise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the underlying classification model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input samples.</p></li>
<li><p><strong>Y</strong> – Target labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.get_class_names">
<span class="sig-name descname"><span class="pre">get_class_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.get_class_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.get_class_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.InvertibleFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">InvertibleFunction</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#InvertibleFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.InvertibleFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.InvertibleFunction.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#InvertibleFunction.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.InvertibleFunction.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Applies the function on the input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.InvertibleFunction.evaluate_inverse">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate_inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#InvertibleFunction.evaluate_inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.InvertibleFunction.evaluate_inverse" title="Permalink to this definition"></a></dt>
<dd><p>Returns the outcome of applying the inverse of the function on the inputs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">PostNonlinearModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">invertible_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.fcms.InvertibleFunction" title="dowhy.gcm.fcms.InvertibleFunction"><span class="pre">InvertibleFunction</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="dowhy.gcm.graph.InvertibleFunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvertibleFunctionalCausalModel</span></code></a></p>
<dl class="simple">
<dt>Represents an post nonlinear FCM, i.e. models of the form:</dt><dd><p>Y = g(f(X) + N),</p>
</dd>
</dl>
<p>where X are parent nodes of the target node Y, f an arbitrary prediction model expecting inputs from the
parents X, N a noise variable and g an invertible function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_model</strong> – The prediction model f.</p></li>
<li><p><strong>invertible_function</strong> – The invertible function g.</p></li>
<li><p><strong>noise_model</strong> – The StochasticModel to describe the distribution of the noise N.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.draw_noise_samples">
<span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples from the noise distribution N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_samples</strong> – Number of noise samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array containing num_samples samples from the noise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.estimate_noise">
<span class="sig-name descname"><span class="pre">estimate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.estimate_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.estimate_noise" title="Permalink to this definition"></a></dt>
<dd><p>Reconstruct the noise given samples from (X, Y). This is done by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Transform Y via the inverse of g: g^-1(Y) = f(X) + N</p></li>
<li><p>Return the residual g^-1(Y) - f(X)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_samples</strong> – Samples from the input X.</p></li>
<li><p><strong>parent_samples</strong> – Samples from the target Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reconstructed noise based on the given samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the post non-linear model given samples (X, N). This is done by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Evaluate f(X)</p></li>
<li><p>Evaluate f(X) + N</p></li>
<li><p>Return g(f(X) + N)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong> – Samples from the inputs X.</p></li>
<li><p><strong>noise_samples</strong> – Samples from the noise N.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Y values based on the given samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the post non-linear model of the form Y = g(f(X) + N). Here, this consists of three steps given
samples from (X, Y):</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Transform Y via the inverse of g: g^-1(Y) = f(X) + N</p></li>
<li><p>Fit the model for f on (X, g^-1(Y))</p></li>
<li><p>Reconstruct N based on the residual N = g^-1(Y) - f(X)</p></li>
</ol>
</div></blockquote>
<p>Note that the noise here can be inferred uniquely if the model assumption holds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Samples from the input X.</p></li>
<li><p><strong>Y</strong> – Samples from the target Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.invertible_function">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">invertible_function</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.InvertibleFunction" title="dowhy.gcm.fcms.InvertibleFunction"><span class="pre">InvertibleFunction</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.invertible_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.noise_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">noise_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.noise_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.prediction_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prediction_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.prediction_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">PredictionModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents general prediction model implementations. Each prediction model should provide a fit and a predict
method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel.clone" title="Permalink to this definition"></a></dt>
<dd><p>Clones the prediction model using the same hyper parameters but not fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An unfitted clone of the prediction model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ProbabilityEstimatorModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">ProbabilityEstimatorModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ProbabilityEstimatorModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ProbabilityEstimatorModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ProbabilityEstimatorModel.estimate_probabilities">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ProbabilityEstimatorModel.estimate_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ProbabilityEstimatorModel.estimate_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.feature">
<span id="dowhy-gcm-feature-module"></span><h2>dowhy.gcm.feature module<a class="headerlink" href="#module-dowhy.gcm.feature" title="Permalink to this heading"></a></h2>
<p>This module allows to estimate the feature relevance of inputs with respect to a given model. While these models can
be blackbox prediction models, it is also possible to explain causal mechanisms with respect to the direct parents.
In these cases, it would be possible to incorporate the noise to represent the part of the generation process that
cannot be explained by the parents.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature.feature_relevance_distribution">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature.</span></span><span class="sig-name descname"><span class="pre">feature_relevance_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature.html#feature_relevance_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature.feature_relevance_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the population based feature relevance of the input features for the given prediction_method. This
method uses all samples given in feature_samples by comparing the output of the prediction_method given certain
features are randomized with the outputs when no features are randomized. The subset_scoring_func defines
how these predictions are compared. For instance, the variance of deviations.</p>
<p>If the randomized predictions should rather be compared to the original data, this has (and can) be defined via
the set function by ignoring the second input parameter (the predicted values using all feauters). Instead, the
original data can be used.</p>
<p>Note: The distribution level relevance is estimated by taking the expectation of the outcome of the set functions
when applied to multiple samples. Due to the linearity of the Shapley value estimation, this is equivalent to taking
the expectation over the Shapley values.</p>
<p>Related paper:
Janzing, D., Minorics, L., &amp; Bloebaum, P. (2020).
Feature relevance quantification in explainable AI: A causal problem.
In International Conference on Artificial Intelligence and Statistics (pp. 2907-2916). PMLR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_method</strong> – A callable that is expected to return a prediction for given samples.</p></li>
<li><p><strong>feature_samples</strong> – Samples from the joint distribution.</p></li>
<li><p><strong>subset_scoring_func</strong> – Set function for estimating the quantity of interest based on the model outcomes. This function
expects two inputs; the outcome of the prediction model for some samples if certain features are permuted and the
outcome of the model for the same samples when no features were permuted. The set functions represents the
comparison between the samples, for instance, the variance of deviations. This is then used as the ‘characteristic function’
in coalition games when estimating the Shapley values.</p></li>
<li><p><strong>max_num_samples_randomization</strong> – Maximum number of samples used for randomizing the feature that are not in the susbet. Consider increasing this 
number for more accurate results (if enough samples are available) or reducing it for less memory consumption and 
faster runtime.</p></li>
<li><p><strong>max_num_baseline_samples</strong> – Maximum number of samples on which the set function is evaluated on. These samples are used as fixed observations for
features that are in the subset. For instance, in case of taking the mean as set_function_summary_func, this defines the maximum number 
of samples used to estimate the mean. Consider increasing this number for more accurate results (if enough samples are 
available) or reducing it for less memory consumption and faster runtime.</p></li>
<li><p><strong>max_batch_size</strong> – Maximum batch size for a estimating the predictions. This has a significant influence on the
overall memory usage. If set to -1, all samples are used in one batch.</p></li>
<li><p><strong>randomize_features_jointly</strong> – If set to True, features that are not in a subset are jointly permuted. 
Note that this still represents an interventional distribution. If set to False, features that are not in a subset 
are independently permuted. Note: The theory in the linked publication assumes that this is set to True.</p></li>
<li><p><strong>shapley_config</strong> – Config for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array with the feature relevance of each input feature.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature.feature_relevance_sample">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature.</span></span><span class="sig-name descname"><span class="pre">feature_relevance_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_target_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_set_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature.html#feature_relevance_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature.feature_relevance_sample" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the feature relevance of the prediction_method for each sample in baseline_noise_samples. This
method uses all samples given in feature_samples as ‘background’ samples. This is, they should represent samples
from the joint distribution of the input features. The subset_scoring_func defines the comparison between the
output of the prediction_method when certain features are randomized and the outputs when no features are
randomized. The most common function would be the difference between the expectations.</p>
<p>If the randomized predictions should rather be compared to the original data, this has (and can) be defined via
the set function by ignoring the second input parameter (the predicted values using all feauters). Instead, the
original data can be used.</p>
<p>Related paper:
Janzing, D., Minorics, L., &amp; Bloebaum, P. (2020).
Feature relevance quantification in explainable AI: A causal problem.
In International Conference on Artificial Intelligence and Statistics (pp. 2907-2916). PMLR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_method</strong> – A callable that is expected to return a prediction for given samples.</p></li>
<li><p><strong>feature_samples</strong> – Samples from the joint distribution. These are used as ‘background samples’ to randomize features that are not in a subset.</p></li>
<li><p><strong>baseline_samples</strong> – Samples for which the feature relevance should be estimated.</p></li>
<li><p><strong>subset_scoring_func</strong> – Set function for estimating the quantity of interest based on the model outcomes. This function
expects two inputs; the outcome of the prediction model for some samples if certain features are permuted and the
outcome of the model for the same samples when no features were permuted. A typical choice for regression models
would be the difference between expectations. This is then used as the ‘characteristic function’
in coalition games when estimating the Shapley values.</p></li>
<li><p><strong>baseline_target_values</strong> – These baseline values are compared with the subset specific outcomes of the prediction method. If set to None (default),
the baseline values are the outcomes of the given prediction_method applied to the baseline_noise_samples, i.e. the outcome of the empty subset.</p></li>
<li><p><strong>max_batch_size</strong> – Maximum batch size for a estimating the predictions. This has a significant influence on the
overall memory usage. If set to -1, all samples are used in one batch.</p></li>
<li><p><strong>average_set_function</strong> – If set to True, the averaged result of the set function applied to each sample of
interest is used for estimating the Shapley values. If set to False, Shapley values for each sample of interest
are estimated separately.</p></li>
<li><p><strong>randomize_features_jointly</strong> – If set to True, features that are not in a subset are jointly permuted.
Note that this still represents an interventional distribution. If set to False, features that are not in a subset
are independently permuted. Note: The theory in the linked publication assumes that this is set to True.</p></li>
<li><p><strong>shapley_config</strong> – Config for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array with the feature relevance for each sample in baseline_noise_samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.feature.parent_relevance">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.feature.</span></span><span class="sig-name descname"><span class="pre">parent_relevance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_scoring_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/feature.html#parent_relevance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.feature.parent_relevance" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the distribution based relevance of the direct parents of the given target_node. This is, the 
relevance of direct parents as input features of the the underlying causal model of target_node. Here, the 
unobserved noise is considered as a direct parent (input) as well. Samples utilized for the estimation are drawn 
from the given causal graph.</p>
<p>By default, the used subset_scoring_func is based on the variance between Y and Y’, where Y is the outputs of
the causal model and Y’ the outputs of the models when certain features are randomized. In case of continuous data,
the feature relevance adds up to Var(Y - Y’).</p>
<p>Note: The feature relevance based on the distribution cannot be directly compared with the feature relevance for 
single samples. If this is desired, the set function needs to be defined accordingly.</p>
<p>Related paper:
Janzing, D., Minorics, L., &amp; Bloebaum, P. (2020). 
Feature relevance quantification in explainable AI: A causal problem. 
In International Conference on Artificial Intelligence and Statistics (pp. 2907-2916). PMLR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The fitted structural causal model.</p></li>
<li><p><strong>target_node</strong> – Node with the causal model of interest.</p></li>
<li><p><strong>parent_samples</strong> – Samples for the parents of the given target_node. If None is given, new samples are
generated based on the graph. These samples are used for randomizing features that are not in the subset.</p></li>
<li><p><strong>subset_scoring_func</strong> – Set function for estimating the quantity of interest based on the model outcomes. This function
expects two inputs; the outcome of the causal model for some samples if certain features are permuted and the 
outcome of the model for the same samples when no features were permuted. The set functions represents the 
comparison between the samples, for instance, the variance of deviations. This is then used as the ‘characteristic function’
in coalition games when estimating the Shapley values.</p></li>
<li><p><strong>num_samples_randomization</strong> – Number of samples used as background parent samples for evaluating the set function.
If no parent_samples are given, this represents the number of generated samples from
the joint distribution of the parents and are used for randomizing features that are 
not in the subset. Consider increasing this number for more accurate results or reducing it for less memory consumption and faster runtime.</p></li>
<li><p><strong>num_samples_baseline</strong> – Number of samples on which the set functions are evaluated on. These samples are used as fixed observations for
parents that are in the subset. Consider increasing this number for more accurate results or reducing it for less memory consumption and faster runtime.</p></li>
<li><p><strong>max_batch_size</strong> – Maximum batch size for estimating multiple predictions at once. This has a significant influence on the
overall memory usage. If set to -1, all samples are used in one batch.</p></li>
<li><p><strong>shapley_config</strong> – <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>There are two return vales. A dictionary with the feature relevance for each direct parent of the given 
target_node and the feature relevance of noise.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.fitting_sampling">
<span id="dowhy-gcm-fitting-sampling-module"></span><h2>dowhy.gcm.fitting_sampling module<a class="headerlink" href="#module-dowhy.gcm.fitting_sampling" title="Permalink to this heading"></a></h2>
<p>This module provides functionality for fitting probabilistic causal models and drawing samples from them.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.draw_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws new joint samples from the given graphical causal model. This is done by first generating random samples
from root nodes and then propagating causal downstream effects through the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – New samples are generated based on the given causal model.</p></li>
<li><p><strong>num_samples</strong> – Number of samples to draw.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pandas data frame where columns correspond to the nodes in the graph and rows to the drawn joint samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.fit">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.fit" title="Permalink to this definition"></a></dt>
<dd><p>Learns generative causal models of nodes in the causal graph from data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The causal model containing the mechanisms that will be fitted.</p></li>
<li><p><strong>data</strong> – Observations of nodes in the causal model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.fit_causal_model_of_target">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">fit_causal_model_of_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#fit_causal_model_of_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.fit_causal_model_of_target" title="Permalink to this definition"></a></dt>
<dd><p>Fits only the causal mechanism of the given target node based on the training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The causal model containing the target node.</p></li>
<li><p><strong>target_node</strong> – Target node for which the mechanism is fitted.</p></li>
<li><p><strong>training_data</strong> – Training data for fitting the causal mechanism.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.graph">
<span id="dowhy-gcm-graph-module"></span><h2>dowhy.gcm.graph module<a class="headerlink" href="#module-dowhy.gcm.graph" title="Permalink to this heading"></a></h2>
<p>This module defines the fundamental interfaces and functions related to causal graphs in graphical causal models.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">ConditionalStochasticModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A conditional stochastic model represents a model used for causal mechanisms for non-root nodes in a graphical
causal model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel.draw_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.DirectedGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">DirectedGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#DirectedGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.DirectedGraph" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><code class="xref py py-class docutils literal notranslate"><span class="pre">HasNodes</span></code></a>, <a class="reference internal" href="#dowhy.gcm.graph.HasEdges" title="dowhy.gcm.graph.HasEdges"><code class="xref py py-class docutils literal notranslate"><span class="pre">HasEdges</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>A protocol representing a directed graph as needed by graphical causal models.</p>
<p>This protocol specifically defines a subset of the networkx.DiGraph class, which make that class automatically
compatible with DirectedGraph. While in most cases a networkx.DiGraph is the class of choice when constructing
a causal graph, anyone can choose to provide their own implementation of the DirectGraph interface.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.DirectedGraph.predecessors">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predecessors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#DirectedGraph.predecessors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.DirectedGraph.predecessors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">FunctionalCausalModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a></p>
<p>Represents a Functional Causal Model (FCM), a specific type of conditional stochastic model, that is defined
as:</p>
<blockquote>
<div><p>Y := f(X, N), N: Noise</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel.draw_noise_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasEdges">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">HasEdges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#HasEdges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.HasEdges" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>This protocol defines a trait for classes having edges.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasEdges.edges">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edges</span></span><a class="headerlink" href="#dowhy.gcm.graph.HasEdges.edges" title="Permalink to this definition"></a></dt>
<dd><p>:returns a Dict[Tuple[Any, Any], Dict[Any, Any]]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasNodes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">HasNodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#HasNodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.HasNodes" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>This protocol defines a trait for classes having nodes.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasNodes.nodes">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nodes</span></span><a class="headerlink" href="#dowhy.gcm.graph.HasNodes.nodes" title="Permalink to this definition"></a></dt>
<dd><p>:returns Dict[Any, Dict[Any, Any]]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.InvertibleFunctionalCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">InvertibleFunctionalCausalModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#InvertibleFunctionalCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.InvertibleFunctionalCausalModel.estimate_noise">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#InvertibleFunctionalCausalModel.estimate_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel.estimate_noise" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">StochasticModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A stochastic model represents a model used for causal mechanisms for root nodes in a graphical causal model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel.draw_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.clone_causal_models">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">clone_causal_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#clone_causal_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.clone_causal_models" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.get_ordered_predecessors">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">get_ordered_predecessors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#get_ordered_predecessors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.get_ordered_predecessors" title="Permalink to this definition"></a></dt>
<dd><p>This function returns predecessors of a node in a well-defined order.</p>
<p>This is necessary, because we select subsets of columns in Dataframes by using a node’s parents, and these parents
might not be returned in a reliable order.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.is_root_node">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">is_root_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#is_root_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.is_root_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.node_connected_subgraph_view">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">node_connected_subgraph_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#node_connected_subgraph_view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.node_connected_subgraph_view" title="Permalink to this definition"></a></dt>
<dd><p>Returns a view of the provided graph g that contains only nodes connected to the node passed in</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_acyclic">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_acyclic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_acyclic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_acyclic" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_causal_dag">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_causal_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_causal_dag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_causal_dag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_causal_graph">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_causal_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_causal_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_causal_graph" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_causal_model_assignment">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_causal_model_assignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_causal_model_assignment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_causal_model_assignment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_local_structure">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_local_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_local_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_local_structure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_node">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_node_has_causal_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_node_has_causal_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_node_has_causal_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_node_has_causal_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_node_in_graph">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_node_in_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_node_in_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_node_in_graph" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.influence">
<span id="dowhy-gcm-influence-module"></span><h2>dowhy.gcm.influence module<a class="headerlink" href="#module-dowhy.gcm.influence" title="Permalink to this heading"></a></h2>
<p>This module provides functions to estimate causal influences.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.influence.arrow_strength">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.influence.</span></span><span class="sig-name descname"><span class="pre">arrow_strength</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_conditional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference_estimation_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/influence.html#arrow_strength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.influence.arrow_strength" title="Permalink to this definition"></a></dt>
<dd><p>Computes the causal strength of each edge directed to the target node.
The strength of an edge is quantified in terms of distance between conditional distributions of the target node in
the original graph and the imputed graph wherein the edge has been removed and the target node is fed a random
permutation of the observations of the source node. For more scientific details behind this API, please refer to
the research paper below.</p>
<p><strong>Research Paper</strong>:
Dominik Janzing, David Balduzzi, Moritz Grosse-Wentrup, Bernhard Schölkopf. <em>Quantifying Causal Influences</em>. The
Annals of Statistics, Vol. 41, No. 5, 2324-2358, 2013.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The probabilistic causal model for whose target node we compute the strength of incoming
edges for.</p></li>
<li><p><strong>target_node</strong> – The target node whose incoming edges’ strength is to be computed.</p></li>
<li><p><strong>parent_samples</strong> – Optional samples from the parents of the target_node. If None are given, they are generated
based on the provided causal model. Providing observational data can help to mitigate
misspecifications in the graph, such as missing interactions between root nodes or 
confounders.</p></li>
<li><p><strong>num_samples_conditional</strong> – Sample size to use for estimating the distance between distributions.</p></li>
<li><p><strong>max_num_runs</strong> – The maximum number of times to resample and estimate the strength to report the average
strength.</p></li>
<li><p><strong>tolerance</strong> – The difference in average strength between two successive runs to terminate early without
running it max_num_runs times.</p></li>
<li><p><strong>n_jobs</strong> – The number of jobs to run in parallel. Set it to -1 to use all processors.</p></li>
<li><p><strong>difference_estimation_func</strong> – Optional: How to measure the distance between two distributions. By default,
the difference of the variance is estimated for a continuous target node
and the KL divergence for a categorical target node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Causal strength of each edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.influence.arrow_strength_of_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.influence.</span></span><span class="sig-name descname"><span class="pre">arrow_strength_of_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conditional_stochastic_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_from_conditional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference_estimation_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_subsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/influence.html#arrow_strength_of_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.influence.arrow_strength_of_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.influence.intrinsic_causal_influence">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.influence.</span></span><span class="sig-name descname"><span class="pre">intrinsic_causal_influence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.ClassificationModel" title="dowhy.gcm.fcms.ClassificationModel"><span class="pre">ClassificationModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'approx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribution_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_training_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_randomization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_assign_quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.auto.AssignmentQuality" title="dowhy.gcm.auto.AssignmentQuality"><span class="pre">AssignmentQuality</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AssignmentQuality.GOOD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/influence.html#intrinsic_causal_influence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.influence.intrinsic_causal_influence" title="Permalink to this definition"></a></dt>
<dd><p>Computes the causal contribution of each upstream noise term of the target node (including the noise of the
target itself) to the statistical property (e.g. mean, variance) of the target. We call this contribution
<em>intrinsic</em> as noise terms, by definition, do not inherit properties of observed parents. The contribution of each
noise term is then the <em>intrinsic</em> causal contribution of the corresponding node. For more scientific details,
please refer to the paper below.</p>
<p><strong>Research Paper</strong>:
Janzing et al. <em>Quantifying causal contributions via structure preserving interventions</em>. arXiv:2007.00714, 2021.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The structural causal model for whose target node we compute the intrinsic causal influence
of its ancestors.</p></li>
<li><p><strong>target_node</strong> – Target node whose statistical property is to be attributed.</p></li>
<li><p><strong>prediction_model</strong> – Prediction model for estimating the functional relationship between subsets of ancestor
noise terms and the target node. This can be an instance of a PredictionModel, the string
‘approx’ or the string ‘exact’. With ‘exact’, the underlying causal models in the graph
are utilized directly by propagating given noise inputs through the graph. This is
generally more accurate but slow. With ‘approx’, an appropriate model is selected and
trained based on sampled data from the graph, which is less accurate but faster. A more
detailed treatment on why we need this parameter is also provided in <span class="xref std std-ref">icc</span>.</p></li>
<li><p><strong>attribution_func</strong> – Optional attribution function to measure the statistical property of the target node. This
function expects two inputs; predictions after the randomization of certain features (i.e.
samples from noise nodes) and a baseline where no features were randomized. The baseline
predictions can be typically ignored if one is interested in uncertainty measures such as
entropy or variance, but they might be relevant if, for instance, these shall be estimated
based on the residuals. By default, entropy is used if prediction model is a classifier,
variance otherwise.</p></li>
<li><p><strong>num_training_samples</strong> – Number of samples drawn from the graphical causal model that are used for fitting the
prediction_model (if necessary).</p></li>
<li><p><strong>num_samples_randomization</strong> – Number of noise samples drawn from the graphical causal model that are used for
evaluating the set function. Here, these samples are samples from
the noise distributions used for randomizing features that are not in the subset.</p></li>
<li><p><strong>num_samples_baseline</strong> – Number of noise samples drawn from the graphical causal model that are used for
evaluating the set function. Here, these samples are used as fixed observations for
features that are in the subset.</p></li>
<li><p><strong>max_batch_size</strong> – Maximum batch size for estimating the predictions from evaluation samples. This has a
significant impact on the overall memory usage. If set to -1, all samples are used in one
batch.</p></li>
<li><p><strong>auto_assign_quality</strong> – Auto assign quality for the ‘approx’ prediction_model option.</p></li>
<li><p><strong>shapley_config</strong> – <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyConfig</span></code></a> for the Shapley estimator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Intrinsic causal contribution of each ancestor node to the statistical property defined by the
attribution_func of the target node.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.shapley">
<span id="dowhy-gcm-shapley-module"></span><h2>dowhy.gcm.shapley module<a class="headerlink" href="#module-dowhy.gcm.shapley" title="Permalink to this heading"></a></h2>
<p>This module provides functionality for shapley value estimation.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">ShapleyApproximationMethods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#ShapleyApproximationMethods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>AUTO: Using EXACT when number of players is below 6 and EARLY_STOPPING otherwise.
EXACT: Generate all possible subsets and estimate Shapley values with corresponding subset weights.
EXACT_FAST: Generate all possible subsets and estimate Shapley values via weighed least squares regression. This can</p>
<blockquote>
<div><p>be faster, but, depending on the set function, numerically less stable.</p>
</div></blockquote>
<dl class="simple">
<dt>SUBSET_SAMPLING: Randomly samples subsets and estimate Shapley values via weighed least squares regression. Here,</dt><dd><p>only a certain number of randomly drawn subsets are used.</p>
</dd>
<dt>EARLY_STOPPING: Estimate Shapley values based on a few randomly generated permutations. Stop the estimation process</dt><dd><p>when the the Shapley values do not change much on average anymore between runs.</p>
</dd>
<dt>PERMUTATION: Estimates Shapley values based on a fixed number of randomly generated permutations. By fine tuning</dt><dd><p>hyperparameters, this can be potentially faster than the early stopping approach due to a better
utilization of the parallelization.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.AUTO">
<span class="sig-name descname"><span class="pre">AUTO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.AUTO" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EARLY_STOPPING">
<span class="sig-name descname"><span class="pre">EARLY_STOPPING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(3,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EARLY_STOPPING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT">
<span class="sig-name descname"><span class="pre">EXACT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(1,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT_FAST">
<span class="sig-name descname"><span class="pre">EXACT_FAST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(2,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT_FAST" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.PERMUTATION">
<span class="sig-name descname"><span class="pre">PERMUTATION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(4,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.PERMUTATION" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.SUBSET_SAMPLING">
<span class="sig-name descname"><span class="pre">SUBSET_SAMPLING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.SUBSET_SAMPLING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">ShapleyConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">approximation_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="dowhy.gcm.shapley.ShapleyApproximationMethods"><span class="pre">ShapleyApproximationMethods</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ShapleyApproximationMethods.AUTO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_percentage_change_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#ShapleyConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Config for estimating Shapley values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>approximation_method</strong> – Type of approximation methods (see <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="dowhy.gcm.shapley.ShapleyApproximationMethods"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyApproximationMethods</span></code></a>).</p></li>
<li><p><strong>num_samples</strong> – Number of samples used for approximating the Shapley values. Depending on the approximation
method, this can either represent the number of drawn subsets (in SUBSET_SAMPLING) or the
number of drawn permutations (in EARLY_STOPPING and PERMUTATION). In case of EARLY_STOPPING,
this also represents a limit on the evaluation runs.</p></li>
<li><p><strong>min_percentage_change_threshold</strong> – This parameter is only relevant for EARLY_STOPPING and indicates the
minimum required change of the Shapley values between two runs
(i.e. evaluation of permutations) before the estimation stops.
For instance, if the Shapley value changes less than the given value for
a certain number of consecutive runs, the algorithm stops and returns
the current result.</p></li>
<li><p><strong>n_jobs</strong> – Number of parallel jobs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.estimate_shapley_values">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">estimate_shapley_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_players</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#estimate_shapley_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.estimate_shapley_values" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the Shapley values based on the provided set function. A set function here is defined by taking a
(subset) of players and returning a certain utility value. This is in the context of attributing the
value of the i-th player to a subset of players S by evaluating v(S u {i}) - v(S), where v is the
set function and i is not in S. While we use the term ‘player’ here, this is often a certain feature/variable.</p>
<p>The input of the set function is a binary vector indicating which player is part of the set. For instance, given 4
players (1,2,3,4) and a subset only contains players 1,2,4, then this is indicated by the vector [1, 1, 0, 1]. The
function is expected to return a numeric value based on this input.</p>
<p>Note: The set function can be arbitrary and can resemble computationally complex operations. Keep in mind
that the estimation of Shapley values can become computationally expensive and requires a lot of memory. If the
runtime is too slow, consider changing the default config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>set_func</strong> – A set function that expects a binary vector as input which specifies which player is part of the
subset.</p></li>
<li><p><strong>num_players</strong> – Total number of players.</p></li>
<li><p><strong>shapley_config</strong> – A config object for indicating the approximation method and other parameters. If None is
given, a default config is used. For faster runtime or more accurate results, consider
creating a custom config.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array representing the Shapley values for each player, i.e. there are as many Shapley values as
num_players. The i-th entry belongs to the i-th player. Here, the set function defines which index belongs
to which player and is responsible to keep it consistent.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.stats">
<span id="dowhy-gcm-stats-module"></span><h2>dowhy.gcm.stats module<a class="headerlink" href="#module-dowhy.gcm.stats" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.estimate_ftest_pvalue">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">estimate_ftest_pvalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_training_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_training_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#estimate_ftest_pvalue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.estimate_ftest_pvalue" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the p-value for the null hypothesis that the same regression error with less parameters can be
achieved. This is, a linear model trained on a data set A with d number of features has the same performance
(in terms of squared error) relative to the number of features as a model trained on a data set B with k number
features, where k &lt; d. Here, both data sets need to have the same target values. A small p-value would
indicate that the model performances are significantly different.</p>
<p>Note that all given test samples are utilized in the f-test.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/F-test#Regression_problems">https://en.wikipedia.org/wiki/F-test#Regression_problems</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_training_a</strong> – Input training samples for model A.</p></li>
<li><p><strong>X_training_b</strong> – Input training samples for model B. These samples should have less features than samples in X_training_a.</p></li>
<li><p><strong>Y_training</strong> – Target training values.</p></li>
<li><p><strong>X_test_a</strong> – Test samples for model A.</p></li>
<li><p><strong>X_test_b</strong> – Test samples for model B.</p></li>
<li><p><strong>Y_test</strong> – Test values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A p-value on [0, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.marginal_expectation">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">marginal_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_feature_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_averaged_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_perturbation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'randomize_columns_jointly'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#marginal_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.marginal_expectation" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the marginal expectation for samples in baseline_noise_samples when randomizing features that are not
part of baseline_feature_indices. This is, this function estimates</p>
<blockquote>
<div><p>y^i = E[Y | do(x^i_s)] := int_x_s’ E[Y | x^i_s, x_s’] p(x_s’) d x_s’,</p>
</div></blockquote>
<p>where x^i_s is the i-th sample from baseline_noise_samples, s denotes the baseline_feature_indices and
x_s’ ~ X_s’ denotes the randomized features that are not in s. For an approximation of the integral, the given
prediction_method is evaluated multiple times for the same x^i_s, but different x_s’ ~ X_s’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prediction_method</strong> – Prediction method of interest. This should expect a numpy array as input for making</p>
</dd>
</dl>
<p>predictions.
:param feature_samples: Samples from the joint distribution. These are used for randomizing the features that are not in</p>
<blockquote>
<div><p>baseline_feature_indices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>baseline_samples</strong> – Samples for which the marginal expectation should be estimated.</p></li>
<li><p><strong>baseline_feature_indices</strong> – Column indices of the features in s. These values for these features are remain constant
when estimating the expectation.</p></li>
<li><p><strong>return_averaged_results</strong> – If set to True, the expectation over all evaluated samples for the i-th</p></li>
</ul>
</dd>
</dl>
<p>baseline_noise_samples is returned. If set to False, all corresponding results for the i-th sample are returned.
:param feature_perturbation: Type of feature permutation:</p>
<blockquote>
<div><p>‘randomize_columns_independently’: Each feature not in s is randomly permuted separately.
‘randomize_columns_jointly’: All features not in s are jointly permuted. Note that this still represents an
interventional distribution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_batch_size</strong> – Maximum batch size for a estimating the predictions. This has a significant influence on the</p>
</dd>
</dl>
<p>overall memory usage. If set to -1, all samples are used in one batch.
:return: If return_averaged_results is False, a numpy array where the i-th entry belongs to the marginal expectation
of x^i_s when randomizing the remaining features.
If return_averaged_results is True, a two dimensional numpy array where the i-th entry contains all
predictions for x^i_s when randomizing the remaining features.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.permute_features">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">permute_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_permute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#permute_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.permute_features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.quantile_based_fwer">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">quantile_based_fwer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_values_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#quantile_based_fwer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.quantile_based_fwer" title="Permalink to this definition"></a></dt>
<dd><p>Applies a quantile based family wise error rate (FWER) control to the given p-values. This is based on the
approach described in:</p>
<p>Meinshausen, N., Meier, L. and Buehlmann, P. (2009).
p-values for high-dimensional regression. J. Amer. Statist. Assoc.104 1671–1681</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_values</strong> – A list or array of p-values.</p></li>
<li><p><strong>p_values_scaling</strong> – An optional list of scaling factors for each p-value.</p></li>
<li><p><strong>quantile</strong> – The quantile used for the p-value adjustment. By default, this is the median (0.5).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The p-value that lies on the quantile threshold. Note that this is the quantile based on scaled values
p_values / quantile.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.stochastic_models">
<span id="dowhy-gcm-stochastic-models-module"></span><h2>dowhy.gcm.stochastic_models module<a class="headerlink" href="#module-dowhy.gcm.stochastic_models" title="Permalink to this heading"></a></h2>
<p>This module defines multiple implementations of the abstract class <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>.</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">BayesianGaussianMixtureDistribution</span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">EmpiricalDistribution</span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<p>An implementation of a stochastic model that uniformly samples from data samples. By randomly returning a sample
from the training data set, this model represents a parameter free representation of the marginal distribution of
the training data. However, it will not generate unseen data points. For this, consider <code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianGaussianMixtureDistribution</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">ScipyDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scipy_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<p>Represents any parametric distribution that can be modeled by scipy.</p>
<p>Initializes a stochastic model that allows to sample from a parametric distribution implemented in Scipy.</p>
<dl class="simple">
<dt>For instance, to use a beta distribution with parameters a=2 and b=0.5:</dt><dd><p>ScipyDistribution(stats.beta, a=2, b=0.5)</p>
</dd>
<dt>Or a Gaussian distribution with mean=0 and standard deviation 2:</dt><dd><p>ScipyDistribution(stats.norm, loc=2, scale=0.5)</p>
</dd>
</dl>
<p>Note that the parameter names need to coincide with the parameter names in the corresponding Scipy
implementations. See <a class="reference external" href="https://docs.scipy.org/doc/scipy/tutorial/stats.html">https://docs.scipy.org/doc/scipy/tutorial/stats.html</a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scipy_distribution</strong> – A continuous or discrete distribution parametric distribution implemented in Scipy.</p></li>
<li><p><strong>parameters</strong> – Set of parameters of the parametric distribution.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.find_suitable_continuous_distribution">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_suitable_continuous_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergence_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.find_suitable_continuous_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.find_suitable_continuous_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Tries to find the best fitting continuous parametric distribution of given samples. This is done by fitting
different parametric models and selecting the one with the smallest KL divergence between observed and generated
samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.map_scipy_distribution_parameters_to_names">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">map_scipy_distribution_parameters_to_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scipy_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.map_scipy_distribution_parameters_to_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.map_scipy_distribution_parameters_to_names" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to obtain a mapping from parameter name to parameter value. Depending whether the
distribution is discrete or continuous, there are slightly different parameter names. The given parameters are
assumed to follow the order as provided by the scipy fit function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scipy_distribution</strong> – The scipy distribution.</p></li>
<li><p><strong>parameters</strong> – The values of the corresponding parameters of the distribution. Here, it is expected to
follow the same order as defined by the scipy fit function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that maps a parameter name to its value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.scipy_distribution">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scipy_distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.scipy_distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.uncertainty">
<span id="dowhy-gcm-uncertainty-module"></span><h2>dowhy.gcm.uncertainty module<a class="headerlink" href="#module-dowhy.gcm.uncertainty" title="Permalink to this heading"></a></h2>
<p>Functions to estimate uncertainties such as entropy, KL divergence etc.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_discrete">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_discrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_discrete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_discrete" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the entropy assuming the data in X is discrete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Discrete samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entropy of X.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_kmeans">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_kmeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_kmeans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_kmeans" title="Permalink to this definition"></a></dt>
<dd><p>Related paper:
Kozachenko, L., &amp; Leonenko, N. (1987). Sample estimate of the entropy of a random vector. Problemy Peredachi
Informatsii, 23(2), 9–16.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_of_probabilities">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_of_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_of_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_of_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the entropy of each probability vector (row wise) in X separately and returns the mean over all
results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_entropy_using_discretization">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_entropy_using_discretization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_entropy_using_discretization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_entropy_using_discretization" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_gaussian_entropy">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_gaussian_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_gaussian_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_gaussian_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Entropy with respect to standardized variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.uncertainty.estimate_variance">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.uncertainty.</span></span><span class="sig-name descname"><span class="pre">estimate_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/uncertainty.html#estimate_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.uncertainty.estimate_variance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.validation">
<span id="dowhy-gcm-validation-module"></span><h2>dowhy.gcm.validation module<a class="headerlink" href="#module-dowhy.gcm.validation" title="Permalink to this heading"></a></h2>
<p>Contains a method to reject the causal graph and validate causal mechanisms such as post non-linear models.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.validation.RejectionResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.validation.</span></span><span class="sig-name descname"><span class="pre">RejectionResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/validation.html#RejectionResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.validation.RejectionResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.validation.RejectionResult.NOT_REJECTED">
<span class="sig-name descname"><span class="pre">NOT_REJECTED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(&lt;enum.auto</span> <span class="pre">object&gt;,)</span></em><a class="headerlink" href="#dowhy.gcm.validation.RejectionResult.NOT_REJECTED" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.validation.RejectionResult.REJECTED">
<span class="sig-name descname"><span class="pre">REJECTED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#dowhy.gcm.validation.RejectionResult.REJECTED" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.validation.refute_causal_structure">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.validation.</span></span><span class="sig-name descname"><span class="pre">refute_causal_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_graph:</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">conditional_independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh'</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.validation.RejectionResult" title="dowhy.gcm.validation.RejectionResult"><span class="pre">RejectionResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/validation.html#refute_causal_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.validation.refute_causal_structure" title="Permalink to this definition"></a></dt>
<dd><p>Validates the assumptions in a causal graph against data. To this end, at each node, we test if the node is dependent on each of its parents, and test the local Markov condition.
Note that valid local Markov conditions also imply a valid global Markov condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_graph</strong> – A directed acyclic graph (DAG).</p></li>
<li><p><strong>data</strong> – Observations of variables in the DAG.</p></li>
<li><p><strong>independence_test</strong> – Independence test to use for checking edge dependencies.</p></li>
<li><p><strong>conditional_independence_test</strong> – Conditional independence test to use for checking local Markov condition.</p></li>
<li><p><strong>significance_level</strong> – Significance level for (conditional) independence tests.</p></li>
<li><p><strong>fdr_control_method</strong> – Method for false discovery rate (FDR) control. For various options, please refer to <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">this page</a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Outcome of the validation process. The first element of the tuple indicates whether the graph is valid w.r.t. given data, and the second element gives the summary of tests at each node. An example for X-&gt;Y-&gt;Z:</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;local_markov_test&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;edge_dependence_test&#39;</span><span class="p">:</span> <span class="p">{}},</span>
        <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;local_markov_test&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;edge_dependence_test&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;fdr_adjusted_p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}},</span>
        <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;local_markov_test&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;fdr_adjusted_p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
              <span class="s1">&#39;edge_dependence_test&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;fdr_adjusted_p_value&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}}}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.validation.refute_invertible_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.validation.</span></span><span class="sig-name descname"><span class="pre">refute_invertible_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.cms.InvertibleStructuralCausalModel,</span> <span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;,</span> <span class="pre">significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dowhy.gcm.validation.RejectionResult" title="dowhy.gcm.validation.RejectionResult"><span class="pre">RejectionResult</span></a></span></span><a class="reference internal" href="_modules/dowhy/gcm/validation.html#refute_invertible_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.validation.refute_invertible_model" title="Permalink to this definition"></a></dt>
<dd><p>Validate the assumption that the structural causal models can be represented by a
<a class="reference internal" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="dowhy.gcm.graph.InvertibleFunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvertibleFunctionalCausalModel</span></code></a> (e.g. the causal mechanisms are
<code class="xref py py-class docutils literal notranslate"><span class="pre">AdditiveNoiseModels</span></code> and/or <code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModels</span></code>).
For this, it is checked if the residual of a causal mechanism is independent of the mechanism’s input
(i.e. we assume causal sufficiency here). For instance, <code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModels</span></code> represent</p>
<blockquote>
<div><p>Y = f(g(X) + N),</p>
</div></blockquote>
<p>where f is invertible (g does not need to be), X are the parents of Y and N is (assumed to be) independent noise.
The latter point is important here. For given data, we can then reconstruct N and perform an independence test between X and N.</p>
<p>Note that this method only validates the causal mechanisms and not the graph structure.</p>
<dl class="simple">
<dt>For the case of post non-linear models, see the following paper for more details:</dt><dd><p>Zhang, K., and A. Hyvärinen.
On the Identifiability of the Post-Nonlinear Causal Model.
25th Conference on Uncertainty in Artificial Intelligence (UAI 2009). AUAI Press, 2009.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – A fitted invertible structural causal model.</p></li>
<li><p><strong>data</strong> – Observations of variables in the DAG.</p></li>
<li><p><strong>independence_test</strong> – Independence test to use for checking if residual and input are dependent.</p></li>
<li><p><strong>significance_level</strong> – Significance level for deciding whether input and residual is dependent.</p></li>
<li><p><strong>fdr_control_method</strong> – <p>Method for false discovery rate (FDR) control. For various options, please refer to <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">this page</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outcome of the validation. The causal model can not be rejected if all causal mechanisms are consistent with
the invertible model assumption.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.whatif">
<span id="dowhy-gcm-whatif-module"></span><h2>dowhy.gcm.whatif module<a class="headerlink" href="#module-dowhy.gcm.whatif" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to answer what-if questions.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.average_causal_effect">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">average_causal_effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions_alternative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions_reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_to_draw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#average_causal_effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.average_causal_effect" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the average causal effect (ACE) on the target of two different sets of interventions.
The interventions can be specified through the parameters <cite>interventions_alternative</cite> and <cite>interventions_reference</cite>.
For example, if the alternative intervention is do(T := 1) and the reference intervention
is do(T := 0), then the average causal effect is given by ACE = E[Y | do(T := 1)] - E[Y | do(T := 0)]:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">average_causal_effect</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
<dl>
<dt>We can also specify more complex interventions on multiple nodes:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">average_causal_effect</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                      <span class="s1">&#39;Y&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                      <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;X0&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>                      <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;X0&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
<p>In the above, we would estimate ACE = E[Y | do(T := 1), do(X0 := X0 + 1)] - E[Y | do(T := 0), do(X0 := X0 * 2)].</p>
<p>Note: The target node can be a continuous real-valued variable or a categorical variable with at most two classes
(i.e. binary).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The probabilistic causal model we perform this intervention on .</p></li>
<li><p><strong>target_node</strong> – Target node for which the ACE is estimated.</p></li>
<li><p><strong>interventions_alternative</strong> – Dictionary defining the interventions for the alternative values.</p></li>
<li><p><strong>interventions_reference</strong> – Dictionary defining the interventions for the reference values.</p></li>
<li><p><strong>observed_data</strong> – Factual data that we observe for the nodes in the causal graph. By default, new data
is sampled using the causal model. If observational data is available, providing them
might improve the accuracy by mitigating issues due to a misspecified graph and/or causal
models.</p></li>
<li><p><strong>num_samples_to_draw</strong> – Number of samples drawn from the causal model for estimating ACE if no observed data is
given.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The estimated average causal effect (ACE).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.counterfactual_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">counterfactual_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel" title="dowhy.gcm.cms.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#counterfactual_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.counterfactual_samples" title="Permalink to this definition"></a></dt>
<dd><p>Estimates counterfactual data for observed data if we were to perform specified interventions. This function
implements the 3-step process for computing counterfactuals by Pearl (see <a class="reference external" href="https://ftp.cs.ucla.edu/pub/stat_ser/r485.pdf">https://ftp.cs.ucla.edu/pub/stat_ser/r485.pdf</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The (invertible) structural causal model we perform this intervention on. If noise_data is
None and observed_data is provided, this must be an invertible structural model, otherwise,
this can be either a structural causal model or an invertible one.</p></li>
<li><p><strong>interventions</strong> – Dictionary containing the interventions we want to perform keyed by node name. An
intervention is a function that takes a value as input and returns another value.
For example, <cite>{‘X’: lambda x: 2}</cite> mimics the atomic intervention <em>do(X:=2)</em>.</p></li>
<li><p><strong>observed_data</strong> – Factual data that we observe for the nodes in the causal graph.</p></li>
<li><p><strong>noise_data</strong> – Data of noise terms corresponding to nodes in the causal graph. If not provided,
these have to be estimated from observed data. Then we require causal models of nodes to be
invertible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Estimated counterfactual data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.interventional_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">interventional_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_to_draw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#interventional_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.interventional_samples" title="Permalink to this definition"></a></dt>
<dd><p>Performs intervention on nodes in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The probabilistic causal model we perform this intervention on .</p></li>
<li><p><strong>interventions</strong> – Dictionary containing the interventions we want to perform, keyed by node name. An
intervention is a function that takes a value as input and returns another value.
For example, <cite>{‘X’: lambda x: 2}</cite> mimics the atomic intervention <em>do(X:=2)</em>.
A soft intervention can be formulated as <cite>{‘X’: lambda x: 0.2 * x}</cite>.</p></li>
<li><p><strong>observed_data</strong> – Optionally, data on which to perform interventions. If None are given, data is generated based
on the generative models.</p></li>
<li><p><strong>num_samples_to_draw</strong> – Sample size to draw from the interventional distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Samples from the interventional distribution.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dowhy.gcm" title="Permalink to this heading"></a></h2>
<p>The gcm sub-package provides features built on top of graphical causal model (GCM) based inference. The status of
this addition and its API is considered experimental, meaning there might be breaking changes to its API in the
future.</p>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="dowhy.do_samplers.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">dowhy.do_samplers package</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="dowhy.gcm.independence_test.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">dowhy.gcm.independence_test package</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PyWhy contributors.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>
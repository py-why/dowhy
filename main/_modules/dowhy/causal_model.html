
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B139P18WHM');
</script>
    <title>dowhy.causal_model &#8212; DoWhy  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">DoWhy  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../example_notebooks/nb_index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../dowhy.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../code_repo.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
      <div class="navbar-end-item">
        
<div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main-branch
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <!-- hard-coding the old versions, as no further old version will be added -->
            <!-- It would be nice if this opened the same page in an older version, but that seems to be overkill
                 right now. Therefore defaulting to the starting page (index). -->
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
            <dd><a href="/dowhy/v0.1-alpha/index.html">v0.1-alpha</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="causal_model.html">main</a></dd>
        </dl>
    </div>
</div>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <h1>Source code for dowhy.causal_model</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; Module containing the main model class for the dowhy package.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">init_printing</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">import</span> <span class="nn">dowhy.graph_learners</span> <span class="k">as</span> <span class="nn">graph_learners</span>
<span class="kn">import</span> <span class="nn">dowhy.causal_estimators</span> <span class="k">as</span> <span class="nn">causal_estimators</span>
<span class="kn">import</span> <span class="nn">dowhy.causal_refuters</span> <span class="k">as</span> <span class="nn">causal_refuters</span>
<span class="kn">import</span> <span class="nn">dowhy.utils.cli_helpers</span> <span class="k">as</span> <span class="nn">cli</span>
<span class="kn">from</span> <span class="nn">dowhy.causal_estimator</span> <span class="kn">import</span> <span class="n">CausalEstimate</span>
<span class="kn">from</span> <span class="nn">dowhy.causal_graph</span> <span class="kn">import</span> <span class="n">CausalGraph</span>
<span class="kn">from</span> <span class="nn">dowhy.causal_identifier</span> <span class="kn">import</span> <span class="n">CausalIdentifier</span>
<span class="kn">from</span> <span class="nn">dowhy.causal_identifiers.id_identifier</span> <span class="kn">import</span> <span class="n">IDIdentifier</span>
<span class="kn">from</span> <span class="nn">dowhy.utils.api</span> <span class="kn">import</span> <span class="n">parse_state</span>
<span class="kn">from</span> <span class="nn">dowhy.causal_refuters.graph_refuter</span> <span class="kn">import</span> <span class="n">GraphRefuter</span>

<span class="n">init_printing</span><span class="p">()</span>  <span class="c1"># To display symbolic math symbols</span>


<div class="viewcode-block" id="CausalModel"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel">[docs]</a><span class="k">class</span> <span class="nc">CausalModel</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;Main class for storing the causal model state.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">treatment</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">common_causes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">instruments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">effect_modifiers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">estimand_type</span><span class="o">=</span><span class="s2">&quot;nonparametric-ate&quot;</span><span class="p">,</span>
                 <span class="n">proceed_when_unidentifiable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">missing_nodes_as_confounders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">identify_vars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize data and create a causal graph instance.</span>

<span class="sd">        Assigns treatment and outcome variables.</span>
<span class="sd">        Also checks and finds the common causes and instruments for treatment</span>
<span class="sd">        and outcome.</span>

<span class="sd">        At least one of graph, common_causes or instruments must be provided. If</span>
<span class="sd">        none of these variables are provided, then learn_graph() can be used later.</span>

<span class="sd">        :param data: a pandas dataframe containing treatment, outcome and other</span>
<span class="sd">        variables.</span>
<span class="sd">        :param treatment: name of the treatment variable</span>
<span class="sd">        :param outcome: name of the outcome variable</span>
<span class="sd">        :param graph: path to DOT file containing a DAG or a string containing</span>
<span class="sd">        a DAG specification in DOT format</span>
<span class="sd">        :param common_causes: names of common causes of treatment and _outcome. Only used when graph is None.</span>
<span class="sd">        :param instruments: names of instrumental variables for the effect of</span>
<span class="sd">        treatment on outcome. Only used when graph is None.</span>
<span class="sd">        :param effect_modifiers: names of variables that can modify the treatment effect. If not provided, then the causal graph is used to find the effect modifiers. Estimators will return multiple different estimates based on each value of effect_modifiers.</span>
<span class="sd">        :param estimand_type: the type of estimand requested (currently only &quot;nonparametric-ate&quot; is supported). In the future, may support other specific parametric forms of identification.</span>
<span class="sd">        :param proceed_when_unidentifiable: does the identification proceed by ignoring potential unobserved confounders. Binary flag.</span>
<span class="sd">        :param missing_nodes_as_confounders: Binary flag indicating whether variables in the dataframe that are not included in the causal graph, should be  automatically included as confounder nodes.</span>
<span class="sd">        :param identify_vars: Variable deciding whether to compute common causes, instruments and effect modifiers while initializing the class. identify_vars should be set to False when user is providing common_causes, instruments or effect modifiers on their own(otherwise the identify_vars code can override the user provided values). Also it does not make sense if no graph is given.</span>
<span class="sd">        :returns: an instance of CausalModel class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span> <span class="o">=</span> <span class="n">parse_state</span><span class="p">(</span><span class="n">treatment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span> <span class="o">=</span> <span class="n">parse_state</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span> <span class="o">=</span> <span class="n">parse_state</span><span class="p">(</span><span class="n">effect_modifiers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_estimand_type</span> <span class="o">=</span> <span class="n">estimand_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proceed_when_unidentifiable</span> <span class="o">=</span> <span class="n">proceed_when_unidentifiable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_missing_nodes_as_confounders</span> <span class="o">=</span> <span class="n">missing_nodes_as_confounders</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Causal Graph not provided. DoWhy will construct a graph based on data inputs.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_common_causes</span> <span class="o">=</span> <span class="n">parse_state</span><span class="p">(</span><span class="n">common_causes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instruments</span> <span class="o">=</span> <span class="n">parse_state</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">common_causes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">instruments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="n">CausalGraph</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">,</span>
                    <span class="n">common_cause_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_common_causes</span><span class="p">,</span>
                    <span class="n">instrument_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_instruments</span><span class="p">,</span>
                    <span class="n">effect_modifier_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span><span class="p">,</span>
                    <span class="n">observed_node_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">common_causes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="n">CausalGraph</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">,</span>
                    <span class="n">common_cause_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_common_causes</span><span class="p">,</span>
                    <span class="n">effect_modifier_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span><span class="p">,</span>
                    <span class="n">observed_node_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">instruments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="n">CausalGraph</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">,</span>
                    <span class="n">instrument_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_instruments</span><span class="p">,</span>
                    <span class="n">effect_modifier_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span><span class="p">,</span>
                    <span class="n">observed_node_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Relevant variables to build causal graph not provided. You may want to use the learn_graph() function to construct the causal graph.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="n">CausalGraph</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">,</span>
                    <span class="n">effect_modifier_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span><span class="p">,</span>
                    <span class="n">observed_node_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_graph</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">identify_vars</span><span class="o">=</span><span class="n">identify_vars</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_other_variables</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<div class="viewcode-block" id="CausalModel.init_graph"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.init_graph">[docs]</a>    <span class="k">def</span> <span class="nf">init_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">identify_vars</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialize self._graph using graph provided by the user.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Create causal graph object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="n">CausalGraph</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">,</span>
            <span class="n">graph</span><span class="p">,</span>
            <span class="n">effect_modifier_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span><span class="p">,</span>
            <span class="n">observed_node_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">missing_nodes_as_confounders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_missing_nodes_as_confounders</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">identify_vars</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_common_causes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">get_common_causes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instruments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">get_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span>
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">)</span>
            <span class="c1"># Sometimes, effect modifiers from the graph may not match those provided by the user.</span>
            <span class="c1"># (Because some effect modifiers may also be common causes)</span>
            <span class="c1"># In such cases, the user-provided modifiers are used.</span>
            <span class="c1"># If no effect modifiers are provided,  then the ones from the graph are used.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">get_effect_modifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">)</span></div>

<div class="viewcode-block" id="CausalModel.get_common_causes"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.get_common_causes">[docs]</a>    <span class="k">def</span> <span class="nf">get_common_causes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_common_causes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">get_common_causes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_causes</span></div>

<div class="viewcode-block" id="CausalModel.get_instruments"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.get_instruments">[docs]</a>    <span class="k">def</span> <span class="nf">get_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_instruments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">get_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instruments</span></div>

<div class="viewcode-block" id="CausalModel.get_effect_modifiers"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.get_effect_modifiers">[docs]</a>    <span class="k">def</span> <span class="nf">get_effect_modifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">get_effect_modifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span></div>

<div class="viewcode-block" id="CausalModel.learn_graph"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.learn_graph">[docs]</a>    <span class="k">def</span> <span class="nf">learn_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="o">=</span><span class="s2">&quot;cdt.causality.graph.LiNGAM&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Learn causal graph from the data. This function takes the method name as input and initializes the</span>
<span class="sd">        causal graph object using the learnt graph.</span>

<span class="sd">        :param self: instance of the CausalModel class (or its subclass)</span>
<span class="sd">        :param method_name: Exact method name of the object to be imported from the concerned library.</span>
<span class="sd">        :returns: an instance of the CausalGraph class initialized with the learned graph.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Import causal discovery class</span>
        <span class="n">str_arr</span> <span class="o">=</span> <span class="n">method_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">library_name</span> <span class="o">=</span> <span class="n">str_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">causal_discovery_class</span> <span class="o">=</span> <span class="n">graph_learners</span><span class="o">.</span><span class="n">get_discovery_class_object</span><span class="p">(</span><span class="n">library_name</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">causal_discovery_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">learn_graph</span><span class="p">()</span>

        <span class="c1"># Initialize causal graph object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_graph</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span></div>

<div class="viewcode-block" id="CausalModel.identify_effect"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.identify_effect">[docs]</a>    <span class="k">def</span> <span class="nf">identify_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimand_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">method_name</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">proceed_when_unidentifiable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimize_backdoor</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Identify the causal effect to be estimated, using properties of the causal graph.</span>

<span class="sd">        :param method_name: Method name for identification algorithm. (&quot;id-algorithm&quot; or &quot;default&quot;)</span>
<span class="sd">        :param proceed_when_unidentifiable: Binary flag indicating whether identification should proceed in the presence of (potential) unobserved confounders.</span>
<span class="sd">        :returns: a probability expression (estimand) for the causal effect if identified, else NULL</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proceed_when_unidentifiable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proceed_when_unidentifiable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_proceed_when_unidentifiable</span>
        <span class="k">if</span> <span class="n">estimand_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">estimand_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimand_type</span>

        <span class="k">if</span> <span class="n">method_name</span> <span class="o">==</span> <span class="s2">&quot;id-algorithm&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">IDIdentifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="p">,</span>
                                           <span class="n">estimand_type</span><span class="p">,</span>
                                           <span class="n">method_name</span><span class="p">,</span>
                                           <span class="n">proceed_when_unidentifiable</span><span class="o">=</span><span class="n">proceed_when_unidentifiable</span><span class="p">)</span>
            <span class="n">identified_estimand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="o">.</span><span class="n">identify_effect</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">CausalIdentifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="p">,</span>
                                               <span class="n">estimand_type</span><span class="p">,</span>
                                               <span class="n">method_name</span><span class="p">,</span>
                                               <span class="n">proceed_when_unidentifiable</span><span class="o">=</span><span class="n">proceed_when_unidentifiable</span><span class="p">)</span>
            <span class="n">identified_estimand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="o">.</span><span class="n">identify_effect</span><span class="p">(</span><span class="n">optimize_backdoor</span><span class="o">=</span><span class="n">optimize_backdoor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">identified_estimand</span></div>

<div class="viewcode-block" id="CausalModel.estimate_effect"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.estimate_effect">[docs]</a>    <span class="k">def</span> <span class="nf">estimate_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identified_estimand</span><span class="p">,</span> <span class="n">method_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">control_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">treatment_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">test_significance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evaluate_effect_strength</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">confidence_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">target_units</span><span class="o">=</span><span class="s2">&quot;ate&quot;</span><span class="p">,</span> <span class="n">effect_modifiers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">fit_estimator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">method_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Estimate the identified causal effect.</span>

<span class="sd">        Currently requires an explicit method name to be specified. Method names follow the convention of identification method followed by the specific estimation method: &quot;[backdoor/iv].estimation_method_name&quot;. Following methods are supported.</span>
<span class="sd">            * Propensity Score Matching: &quot;backdoor.propensity_score_matching&quot;</span>
<span class="sd">            * Propensity Score Stratification: &quot;backdoor.propensity_score_stratification&quot;</span>
<span class="sd">            * Propensity Score-based Inverse Weighting: &quot;backdoor.propensity_score_weighting&quot;</span>
<span class="sd">            * Linear Regression: &quot;backdoor.linear_regression&quot;</span>
<span class="sd">            * Generalized Linear Models (e.g., logistic regression): &quot;backdoor.generalized_linear_model&quot;</span>
<span class="sd">            * Instrumental Variables: &quot;iv.instrumental_variable&quot;</span>
<span class="sd">            * Regression Discontinuity: &quot;iv.regression_discontinuity&quot;</span>

<span class="sd">        In addition, you can directly call any of the EconML estimation methods. The convention is &quot;backdoor.econml.path-to-estimator-class&quot;. For example, for the double machine learning estimator (&quot;DML&quot; class) that is located inside &quot;dml&quot; module of EconML, you can use the method name, &quot;backdoor.econml.dml.DML&quot;. CausalML estimators can also be called. See `this demo notebook &lt;https://py-why.github.io/dowhy/example_notebooks/dowhy-conditional-treatment-effects.html&gt;`_.</span>


<span class="sd">        :param identified_estimand: a probability expression</span>
<span class="sd">            that represents the effect to be estimated. Output of</span>
<span class="sd">            CausalModel.identify_effect method</span>
<span class="sd">        :param method_name: name of the estimation method to be used.</span>
<span class="sd">        :param control_value: Value of the treatment in the control group, for effect estimation.  If treatment is multi-variate, this can be a list.</span>
<span class="sd">        :param treatment_value: Value of the treatment in the treated group, for effect estimation. If treatment is multi-variate, this can be a list.</span>
<span class="sd">        :param test_significance: Binary flag on whether to additionally do a statistical signficance test for the estimate.</span>
<span class="sd">        :param evaluate_effect_strength: (Experimental) Binary flag on whether to estimate the relative strength of the treatment&#39;s effect. This measure can be used to compare different treatments for the same outcome (by running this method with different treatments sequentially).</span>
<span class="sd">        :param confidence_intervals: (Experimental) Binary flag indicating whether confidence intervals should be computed.</span>
<span class="sd">        :param target_units: (Experimental) The units for which the treatment effect should be estimated. This can be of three types. (1) a string for common specifications of target units (namely, &quot;ate&quot;, &quot;att&quot; and &quot;atc&quot;), (2) a lambda function that can be used as an index for the data (pandas DataFrame), or (3) a new DataFrame that contains values of the effect_modifiers and effect will be estimated only for this new data.</span>
<span class="sd">        :param effect_modifiers: Names of effect modifier variables can be (optionally) specified here too, since they do not affect identification. If None, the effect_modifiers from the CausalModel are used.</span>
<span class="sd">        :param fit_estimator: Boolean flag on whether to fit the estimator.</span>
<span class="sd">            Setting it to False is useful to estimate the effect on new data using a previously fitted estimator.</span>
<span class="sd">        :param method_params: Dictionary containing any method-specific parameters. These are passed directly to the estimating method. See the docs for each estimation method for allowed method-specific params.</span>
<span class="sd">        :returns: An instance of the CausalEstimate class, containing the causal effect estimate</span>
<span class="sd">            and other method-dependent information</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">effect_modifiers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">effect_modifiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_effect_modifiers</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">effect_modifiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_modifiers</span>
        <span class="k">if</span> <span class="n">fit_estimator</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">method_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1">#TODO add propensity score as default backdoor method, iv as default iv method, add an informational message to show which method has been selected.</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># TODO add dowhy as a prefix to all dowhy estimators</span>
                <span class="n">num_components</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">method_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span>
                <span class="n">str_arr</span> <span class="o">=</span> <span class="n">method_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">identifier_name</span> <span class="o">=</span> <span class="n">str_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">estimator_name</span> <span class="o">=</span> <span class="n">str_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">identified_estimand</span><span class="o">.</span><span class="n">set_identifier_method</span><span class="p">(</span><span class="n">identifier_name</span><span class="p">)</span>
                <span class="c1"># This is done as all dowhy estimators have two parts and external ones have two or more parts</span>
                <span class="k">if</span> <span class="n">num_components</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">estimator_package</span> <span class="o">=</span>  <span class="n">estimator_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">estimator_package</span> <span class="o">==</span> <span class="s1">&#39;dowhy&#39;</span><span class="p">:</span> <span class="c1"># For updated dowhy methods</span>
                        <span class="n">estimator_method</span> <span class="o">=</span> <span class="n">estimator_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># discard dowhy from the full package name</span>
                        <span class="n">causal_estimator_class</span> <span class="o">=</span> <span class="n">causal_estimators</span><span class="o">.</span><span class="n">get_class_object</span><span class="p">(</span><span class="n">estimator_method</span> <span class="o">+</span> <span class="s2">&quot;_estimator&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">third_party_estimator_package</span> <span class="o">=</span> <span class="n">estimator_package</span>
                        <span class="n">causal_estimator_class</span> <span class="o">=</span> <span class="n">causal_estimators</span><span class="o">.</span><span class="n">get_class_object</span><span class="p">(</span><span class="n">third_party_estimator_package</span><span class="p">,</span> <span class="n">estimator_name</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">method_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">method_params</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="c1"># Define the third-party estimation method to be used</span>
                        <span class="n">method_params</span><span class="p">[</span><span class="n">third_party_estimator_package</span> <span class="o">+</span> <span class="s2">&quot;_methodname&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimator_name</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># For older dowhy methods</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">estimator_name</span><span class="p">)</span>
                    <span class="c1"># Process the dowhy estimators</span>
                    <span class="n">causal_estimator_class</span> <span class="o">=</span> <span class="n">causal_estimators</span><span class="o">.</span><span class="n">get_class_object</span><span class="p">(</span><span class="n">estimator_name</span> <span class="o">+</span> <span class="s2">&quot;_estimator&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">identified_estimand</span><span class="o">.</span><span class="n">no_directed_path</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No directed path from </span><span class="si">{0}</span><span class="s2"> to </span><span class="si">{1}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">CausalEstimate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">identified_estimand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">control_value</span><span class="o">=</span><span class="n">control_value</span><span class="p">,</span>
                    <span class="n">treatment_value</span><span class="o">=</span><span class="n">treatment_value</span><span class="p">)</span>
            <span class="c1"># Check if estimator&#39;s target estimand is identified</span>
            <span class="k">elif</span> <span class="n">identified_estimand</span><span class="o">.</span><span class="n">estimands</span><span class="p">[</span><span class="n">identifier_name</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No valid identified estimand available.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">CausalEstimate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                                      <span class="n">control_value</span><span class="o">=</span><span class="n">control_value</span><span class="p">,</span>
                                      <span class="n">treatment_value</span><span class="o">=</span><span class="n">treatment_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">method_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">num_components</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">estimator_package</span> <span class="o">==</span> <span class="s1">&#39;dowhy&#39;</span><span class="p">):</span>
                    <span class="n">extra_args</span> <span class="o">=</span> <span class="n">method_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;init_params&quot;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">extra_args</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">method_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">method_params</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span> <span class="o">=</span> <span class="n">causal_estimator_class</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
                    <span class="n">identified_estimand</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">,</span> <span class="c1">#names of treatment and outcome</span>
                    <span class="n">control_value</span> <span class="o">=</span> <span class="n">control_value</span><span class="p">,</span>
                    <span class="n">treatment_value</span> <span class="o">=</span> <span class="n">treatment_value</span><span class="p">,</span>
                    <span class="n">test_significance</span><span class="o">=</span><span class="n">test_significance</span><span class="p">,</span>
                    <span class="n">evaluate_effect_strength</span><span class="o">=</span><span class="n">evaluate_effect_strength</span><span class="p">,</span>
                    <span class="n">confidence_intervals</span> <span class="o">=</span> <span class="n">confidence_intervals</span><span class="p">,</span>
                    <span class="n">target_units</span> <span class="o">=</span> <span class="n">target_units</span><span class="p">,</span>
                    <span class="n">effect_modifiers</span> <span class="o">=</span> <span class="n">effect_modifiers</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">method_params</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">extra_args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Estimator had been computed in a previous call</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">causal_estimator_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span><span class="o">.</span><span class="vm">__class__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span><span class="o">.</span><span class="n">update_input</span><span class="p">(</span><span class="n">treatment_value</span><span class="p">,</span> <span class="n">control_value</span><span class="p">,</span>
                    <span class="n">target_units</span><span class="p">)</span>

        <span class="n">estimate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span><span class="o">.</span><span class="n">estimate_effect</span><span class="p">()</span>
        <span class="c1"># Store parameters inside estimate object for refutation methods</span>
        <span class="c1"># TODO: This add_params needs to move to the estimator class</span>
        <span class="c1"># inside estimate_effect and estimate_conditional_effect</span>
        <span class="n">estimate</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
            <span class="n">estimand_type</span><span class="o">=</span><span class="n">identified_estimand</span><span class="o">.</span><span class="n">estimand_type</span><span class="p">,</span>
            <span class="n">estimator_class</span><span class="o">=</span><span class="n">causal_estimator_class</span><span class="p">,</span>
            <span class="n">test_significance</span><span class="o">=</span><span class="n">test_significance</span><span class="p">,</span>
            <span class="n">evaluate_effect_strength</span><span class="o">=</span><span class="n">evaluate_effect_strength</span><span class="p">,</span>
            <span class="n">confidence_intervals</span><span class="o">=</span><span class="n">confidence_intervals</span><span class="p">,</span>
            <span class="n">target_units</span><span class="o">=</span><span class="n">target_units</span><span class="p">,</span>
            <span class="n">effect_modifiers</span><span class="o">=</span><span class="n">effect_modifiers</span><span class="p">,</span>
            <span class="n">method_params</span><span class="o">=</span><span class="n">method_params</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">estimate</span></div>

<div class="viewcode-block" id="CausalModel.do"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.do">[docs]</a>    <span class="k">def</span> <span class="nf">do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">identified_estimand</span><span class="p">,</span> <span class="n">method_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">fit_estimator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Do operator for estimating values of the outcome after intervening on treatment.</span>

<span class="sd">        :param x: interventional value of the treatment variable</span>
<span class="sd">        :param identified_estimand: a probability expression</span>
<span class="sd">            that represents the effect to be estimated. Output of</span>
<span class="sd">            CausalModel.identify_effect method</span>
<span class="sd">        :param method_name: any of the estimation method to be used. See docs</span>
<span class="sd">            for estimate_effect method for a list of supported estimation methods.</span>
<span class="sd">        :param fit_estimator: Boolean flag on whether to fit the estimator.</span>
<span class="sd">            Setting it to False is useful to compute the do-operation on new</span>
<span class="sd">            data using a previously fitted estimator.</span>
<span class="sd">        :param method_params: Dictionary containing any method-specific parameters. These are passed directly to the estimating method.</span>

<span class="sd">        :returns: an instance of the CausalEstimate class, containing the causal effect estimate</span>
<span class="sd">            and other method-dependent information</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">str_arr</span> <span class="o">=</span> <span class="n">method_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">identifier_name</span> <span class="o">=</span> <span class="n">str_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">estimator_name</span> <span class="o">=</span> <span class="n">str_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">identified_estimand</span><span class="o">.</span><span class="n">set_identifier_method</span><span class="p">(</span><span class="n">identifier_name</span><span class="p">)</span>
            <span class="n">causal_estimator_class</span> <span class="o">=</span> <span class="n">causal_estimators</span><span class="o">.</span><span class="n">get_class_object</span><span class="p">(</span><span class="n">estimator_name</span> <span class="o">+</span> <span class="s2">&quot;_estimator&quot;</span><span class="p">)</span>

        <span class="c1"># Check if estimator&#39;s target estimand is identified</span>
        <span class="k">if</span> <span class="n">identified_estimand</span><span class="o">.</span><span class="n">estimands</span><span class="p">[</span><span class="n">identifier_name</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No valid identified estimand for using instrumental variables method&quot;</span><span class="p">)</span>
            <span class="n">estimate</span> <span class="o">=</span> <span class="n">CausalEstimate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fit_estimator</span><span class="p">:</span>
                <span class="c1"># Note that while the name of the variable is the same,</span>
                <span class="c1"># &quot;self.causal_estimator&quot;, this estimator takes in less</span>
                <span class="c1"># parameters than the same from the</span>
                <span class="c1"># estimate_effect code. It is not advisable to use the</span>
                <span class="c1"># estimator from this function to call estimate_effect</span>
                <span class="c1"># with fit_estimator=False.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span> <span class="o">=</span> <span class="n">causal_estimator_class</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
                    <span class="n">identified_estimand</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">,</span>
                    <span class="n">test_significance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">method_params</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Estimator had been computed in a previous call</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">estimate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimator</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Do Operation not implemented or not supported for this estimator.&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">return</span> <span class="n">estimate</span></div>

<div class="viewcode-block" id="CausalModel.refute_estimate"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.refute_estimate">[docs]</a>    <span class="k">def</span> <span class="nf">refute_estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimand</span><span class="p">,</span> <span class="n">estimate</span><span class="p">,</span> <span class="n">method_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Refute an estimated causal effect.</span>

<span class="sd">        If method_name is provided, uses the provided method. In the future, we may support automatic selection of suitable refutation tests. Following refutation methods are supported.</span>
<span class="sd">            * Adding a randomly-generated confounder: &quot;random_common_cause&quot;</span>
<span class="sd">            * Adding a confounder that is associated with both treatment and outcome: &quot;add_unobserved_common_cause&quot;</span>
<span class="sd">            * Replacing the treatment with a placebo (random) variable): &quot;placebo_treatment_refuter&quot;</span>
<span class="sd">            * Removing a random subset of the data: &quot;data_subset_refuter&quot;</span>

<span class="sd">        :param estimand: target estimand, an instance of the IdentifiedEstimand class (typically, the output of identify_effect)</span>
<span class="sd">        :param estimate: estimate to be refuted, an instance of the CausalEstimate class (typically, the output of estimate_effect)</span>
<span class="sd">        :param method_name: name of the refutation method</span>
<span class="sd">        :param kwargs:  (optional) additional arguments that are passed directly to the refutation method. Can specify a random seed here to ensure reproducible results (&#39;random_seed&#39; parameter). For method-specific parameters, consult the documentation for the specific method. All refutation methods are in the causal_refuters subpackage.</span>

<span class="sd">        :returns: an instance of the RefuteResult class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">estimate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">estimate</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Aborting refutation! No estimate is provided.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Aborting refutation! No valid estimate is provided.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">refuter_class</span> <span class="o">=</span> <span class="n">causal_refuters</span><span class="o">.</span><span class="n">get_class_object</span><span class="p">(</span><span class="n">method_name</span><span class="p">)</span>

        <span class="n">refuter</span> <span class="o">=</span> <span class="n">refuter_class</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
            <span class="n">identified_estimand</span><span class="o">=</span><span class="n">estimand</span><span class="p">,</span>
            <span class="n">estimate</span><span class="o">=</span><span class="n">estimate</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">refuter</span><span class="o">.</span><span class="n">refute_estimate</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="CausalModel.view_model"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.view_model">[docs]</a>    <span class="k">def</span> <span class="nf">view_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;dot&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;causal_model&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;View the causal DAG.</span>

<span class="sd">        :param layout: string specifying the layout of the graph.</span>
<span class="sd">        :param size: tuple (x, y) specifying the width and height of the figure in inches.</span>
<span class="sd">        :param file_name: string specifying the file name for the saved causal graph png.</span>

<span class="sd">        :returns: a visualization of the graph</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">view_graph</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CausalModel.interpret"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.interpret">[docs]</a>    <span class="k">def</span> <span class="nf">interpret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Interpret the causal model.</span>

<span class="sd">        :param method_name: method used for interpreting the model. If None,</span>
<span class="sd">                            then default interpreter is chosen that describes the model summary and shows the associated causal graph.</span>
<span class="sd">        :param kwargs:: Optional parameters that are directly passed to the interpreter method.</span>

<span class="sd">        :returns: None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">print_to_stdout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">view_model</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">method_name_arr</span> <span class="o">=</span> <span class="n">parse_state</span><span class="p">(</span><span class="n">method_name</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">dowhy.interpreters</span> <span class="k">as</span> <span class="nn">interpreters</span>
        <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">method_name_arr</span><span class="p">:</span>
            <span class="n">interpreter</span> <span class="o">=</span> <span class="n">interpreters</span><span class="o">.</span><span class="n">get_class_object</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
            <span class="n">interpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">interpret</span><span class="p">()</span></div>

<div class="viewcode-block" id="CausalModel.summary"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.summary">[docs]</a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_to_stdout</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print a text summary of the model.</span>

<span class="sd">        :returns: a string containining the summary</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summary_text</span> <span class="o">=</span> <span class="s2">&quot;Model to find the causal effect of treatment </span><span class="si">{0}</span><span class="s2"> on outcome </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_treatment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">summary_text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">print_to_stdout</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">summary_text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">summary_text</span></div>

<div class="viewcode-block" id="CausalModel.refute_graph"><a class="viewcode-back" href="../../dowhy.html#dowhy.causal_model.CausalModel.refute_graph">[docs]</a>    <span class="k">def</span> <span class="nf">refute_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">independence_test</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">,</span>  <span class="n">independence_constraints</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the dependencies in input graph matches with the dataset -</span>
<span class="sd">        ( X  Y ) | Z</span>
<span class="sd">        where X and Y are considered as singleton sets currently</span>
<span class="sd">        Z can have multiple variables</span>
<span class="sd">        :param k: number of covariates in set Z</span>
<span class="sd">        :param independence_test: dictionary containing methods to test conditional independece in data</span>
<span class="sd">        :param independence_constraints: list of implications to be test input by the user in the format</span>
<span class="sd">            [(x,y,(z1,z2)),</span>
<span class="sd">            (x,y, (z3,))</span>
<span class="sd">            ]</span>
<span class="sd">        : returns: an instance of GraphRefuter class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">independence_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">test_for_continuous</span> <span class="o">=</span> <span class="n">independence_test</span><span class="p">[</span><span class="s1">&#39;test_for_continuous&#39;</span><span class="p">]</span>
            <span class="n">test_for_discrete</span> <span class="o">=</span> <span class="n">independence_test</span><span class="p">[</span><span class="s1">&#39;test_for_discrete&#39;</span><span class="p">]</span>
            <span class="n">refuter</span> <span class="o">=</span> <span class="n">GraphRefuter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">method_name_continuous</span><span class="o">=</span> <span class="n">test_for_continuous</span><span class="p">,</span> <span class="n">method_name_discrete</span> <span class="o">=</span> <span class="n">test_for_discrete</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">refuter</span> <span class="o">=</span> <span class="n">GraphRefuter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">independence_constraints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">all_nodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">get_all_nodes</span><span class="p">(</span><span class="n">include_unobserved</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
            <span class="n">num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_nodes</span><span class="p">)</span>
            <span class="n">array_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">num_nodes</span><span class="p">))</span>
            <span class="n">all_possible_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">array_indices</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1">#Generating sets of indices of size 2 for different x and y</span>
            <span class="n">conditional_independences</span><span class="o">=</span><span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;The followed conditional independences are true for the input graph&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">all_possible_combinations</span><span class="p">:</span>  <span class="c1">#Iterate over the unique 2-sized sets [x,y]</span>
                <span class="n">i</span><span class="o">=</span><span class="n">combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">j</span><span class="o">=</span><span class="n">combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">a</span><span class="o">=</span><span class="n">all_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">b</span><span class="o">=</span><span class="n">all_nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="p">):</span>
                    <span class="n">temp_arr</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">all_nodes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">]</span><span class="o">+</span> <span class="n">all_nodes</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp_arr</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">[:</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">all_nodes</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">]</span><span class="o">+</span> <span class="n">all_nodes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">k_sized_lists</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">temp_arr</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">k_list</span> <span class="ow">in</span> <span class="n">k_sized_lists</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">check_dseparation</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)],</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)],</span> <span class="n">k_list</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2"> are CI given </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">k_list</span><span class="p">)</span>
                        <span class="n">conditional_independences</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">k_list</span><span class="p">])</span>

            <span class="n">independence_constraints</span> <span class="o">=</span> <span class="n">conditional_independences</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">refuter</span><span class="o">.</span><span class="n">refute_model</span><span class="p">(</span><span class="n">independence_constraints</span> <span class="o">=</span> <span class="n">independence_constraints</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">refuter</span><span class="o">.</span><span class="n">_refutation_passed</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span></div></div>





</pre></div>

              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PyWhy contributors.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>